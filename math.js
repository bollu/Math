!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).math=t()}(this,(function(){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function t(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var r=[],e=!0,i=!1,o=void 0;try{for(var u,c=n[Symbol.iterator]();!(e=(u=c.next()).done)&&(r.push(u.value),!t||r.length!==t);e=!0);}catch(n){i=!0,o=n}finally{try{e||null==c.return||c.return()}finally{if(i)throw o}}return r}(n,t)||e(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||e(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n,t){if(n){if("string"==typeof n)return i(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(n,t):void 0}}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}var o=function(n,t){return t.length===n?t:Array(n).fill(0).map((function(n,r){return t[r]?t[r]:n}))},u=function(n,t){var r=n.length>t.length?n.length:t.length;return[n,t].map((function(n){return o(r,n)}))},c=function(n){var t="".concat(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},a=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof n)return n;var r=parseFloat(n.toFixed(t));return c(r)===Math.min(t,c(n))?n:r},s=function(n){return null!=n&&"function"==typeof n[Symbol.iterator]},f=function n(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?n.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return s(t)?r(n(t)):t}))}},l=function n(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return s(arguments[0])&&"string"!=typeof arguments[0]?n.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(t){return s(t)?r(n(t)):t})).reduce((function(n,t){return n.concat(t)}),[])}},h=Object.freeze({__proto__:null,resize:o,resize_up:u,resize_down:function(n,t){var r=n.length>t.length?t.length:n.length;return[n,t].map((function(n){return o(r,n)}))},clean_number:a,semi_flatten_arrays:f,flatten_arrays:l}),v=1e-6,p=function(n,t){return n===t},g=function(n,t){return Math.abs(n-t)<v},d=function(n,t){return Array.from(Array(n.length-1)).map((function(r,e){return t(n[0],n[e+1])})).reduce((function(n,t){return n&&t}),!0)},_=function(n,t){var r=u(n,t);return r[0].map((function(n,t){return Math.abs(r[0][t]-r[1][t])<v})).reduce((function(n,t){return n&&t}),!0)},m=Object.freeze({__proto__:null,EPSILON:v,equivalent_arrays_of_numbers:function(){},equivalent_numbers:function n(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?n.apply(void 0,r(arguments[0])):d(arguments,g))},equivalent_vectors:_,equivalent:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=f(e);if(o.length<1)return!1;var u=n(o[0]);if("undefined"===u)return!1;switch(u){case"number":return d(o,g);case"boolean":case"string":return d(o,p);case"object":return o[0].constructor===Array?_.apply(void 0,r(o)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),d(o,(function(n,t){return JSON.stringify(n)===JSON.stringify(t)})));default:console.warn("incapable of determining comparison method")}return!1}}),y=function(n){return n*n},M=function(n,t){return n+t},x=function(n){return Math.sqrt(n.map(y).reduce(M,0))},b=function(n){return n.map(y).reduce(M,0)},w=function(n){var t=x(n);return 0===t?n:n.map((function(n){return n/t}))},A=function(n,t){return n.map((function(n){return n*t}))},j=function(n,t){return n.map((function(n,r){return n+t[r]}))},P=function(n,t){return n.map((function(n,r){return n-t[r]}))},O=function(n,t){return n.map((function(r,e){return n[e]*t[e]})).reduce(M,0)},S=function(n,t){return n.map((function(n,r){return(n+t[r])/2}))},k=function(){var n=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,r=Array(t).fill(0);return Array.from(arguments).forEach((function(n){return r.forEach((function(t,e){r[e]+=n[e]||0}))})),r.map((function(t){return t/n.length}))},I=function(n,t,r){var e=1-r;return n.map((function(n,i){return n*e+t[i]*r}))},z=function(n,t){return n[0]*t[1]-n[1]*t[0]},E=function(n,t){return[n[1]*t[2]-n[2]*t[1],n[0]*t[2]-n[2]*t[0],n[0]*t[1]-n[1]*t[0]]},q=function(n,t){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)},N=function(n,t){return Math.sqrt(n.map((function(r,e){return Math.pow(n[e]-t[e],2)})).reduce((function(n,t){return n+t}),0))},G=function(n){return n.map((function(n){return-n}))},F=function(n){return[-n[1],n[0]]},T=function(n){return[n[1],-n[0]]},L=function(n){return Math.abs(n.reduce((function(n,t){return n+t}),0))<v},Z=function(n,t){return 1-Math.abs(O(w(n),w(t)))<v},D=Object.freeze({__proto__:null,magnitude:x,mag_squared:b,normalize:w,scale:A,add:j,subtract:P,dot:O,midpoint:S,average:k,lerp:I,cross2:z,cross3:E,distance2:q,distance3:function(n,t){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(r*r+e*e+i*i)},distance:N,flip:G,rotate90:F,rotate270:T,degenerate:L,parallel:Z}),R=Object.create(null),J=[1,0,0,1],C=J.concat(0,0),X=function(n){return n[0]*n[3]-n[1]*n[2]},Y=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(n),e=Math.sin(n);return[r,e,-e,r,t[0],t[1]]},$=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=e*o+i*u,a=e*-u+i*o,s=i*o+-e*u,f=i*-u+-e*o,l=t[0]+c*-t[0]+-t[1]*s,h=t[1]+a*-t[0]+-t[1]*f;return[c,a,s,f,l,h]},B=Object.freeze({__proto__:null,identity2x2:J,identity2x3:C,multiply_matrix2_vector2:function(n,t){return[n[0]*t[0]+n[2]*t[1]+n[4],n[1]*t[0]+n[3]*t[1]+n[5]]},multiply_matrix2_line2:function(n,t,r){return{vector:[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1]],origin:[n[0]*r[0]+n[2]*r[1]+n[4],n[1]*r[0]+n[3]*r[1]+n[5]]}},multiply_matrices2:function(n,t){return[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1],n[0]*t[2]+n[2]*t[3],n[1]*t[2]+n[3]*t[3],n[0]*t[4]+n[2]*t[5]+n[4],n[1]*t[4]+n[3]*t[5]+n[5]]},determinant2:X,invert_matrix2:function(n){var t=X(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[4])&&isFinite(n[5]))return[n[3]/t,-n[1]/t,-n[2]/t,n[0]/t,(n[2]*n[5]-n[3]*n[4])/t,(n[1]*n[4]-n[0]*n[5])/t]},make_matrix2_translate:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return J.concat(n,t)},make_matrix2_scale:function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[n,0,0,t,n*-r[0]+r[0],t*-r[1]+r[1]]},make_matrix2_rotate:Y,make_matrix2_reflection:$}),H=[1,0,0,0,1,0,0,0,1],U=H.concat(0,0,0),V=function(n){return U.map((function(t,r){return Math.abs(t-n[r])<v})).reduce((function(n,t){return n&&t}),!0)},W=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2]+n[9],n[1]*t[0]+n[4]*t[1]+n[7]*t[2]+n[10],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]+n[11]]},K=function(n,t,r){return{vector:[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]],origin:[n[0]*r[0]+n[3]*r[1]+n[6]*r[2]+n[9],n[1]*r[0]+n[4]*r[1]+n[7]*r[2]+n[10],n[2]*r[0]+n[5]*r[1]+n[8]*r[2]+n[11]]}},Q=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2],n[0]*t[3]+n[3]*t[4]+n[6]*t[5],n[1]*t[3]+n[4]*t[4]+n[7]*t[5],n[2]*t[3]+n[5]*t[4]+n[8]*t[5],n[0]*t[6]+n[3]*t[7]+n[6]*t[8],n[1]*t[6]+n[4]*t[7]+n[7]*t[8],n[2]*t[6]+n[5]*t[7]+n[8]*t[8],n[0]*t[9]+n[3]*t[10]+n[6]*t[11]+n[9],n[1]*t[9]+n[4]*t[10]+n[7]*t[11]+n[10],n[2]*t[9]+n[5]*t[10]+n[8]*t[11]+n[11]]},nn=function(n){return n[0]*n[4]*n[8]-n[0]*n[7]*n[5]-n[3]*n[1]*n[8]+n[3]*n[7]*n[2]+n[6]*n[1]*n[5]-n[6]*n[4]*n[2]},tn=function(n){var t=nn(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[9])&&isFinite(n[10])&&isFinite(n[11])){var r=[n[4]*n[8]-n[7]*n[5],-n[1]*n[8]+n[7]*n[2],n[1]*n[5]-n[4]*n[2],-n[3]*n[8]+n[6]*n[5],n[0]*n[8]-n[6]*n[2],-n[0]*n[5]+n[3]*n[2],n[3]*n[7]-n[6]*n[4],-n[0]*n[7]+n[6]*n[1],n[0]*n[4]-n[3]*n[1],-n[3]*n[7]*n[11]+n[3]*n[8]*n[10]+n[6]*n[4]*n[11]-n[6]*n[5]*n[10]-n[9]*n[4]*n[8]+n[9]*n[5]*n[7],n[0]*n[7]*n[11]-n[0]*n[8]*n[10]-n[6]*n[1]*n[11]+n[6]*n[2]*n[10]+n[9]*n[1]*n[8]-n[9]*n[2]*n[7],-n[0]*n[4]*n[11]+n[0]*n[5]*n[10]+n[3]*n[1]*n[11]-n[3]*n[2]*n[10]-n[9]*n[1]*n[5]+n[9]*n[2]*n[4]],e=1/t;return r.map((function(n){return n*e}))}},rn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return H.concat(n,t,r)},en=function(n,t,r,e,i){var o=H.concat([0,1,2].map((function(n){return t[n]||0}))),u=Math.cos(n),c=Math.sin(n);return o[3*r+r]=u,o[3*r+e]=(i?1:-1)*c,o[3*e+r]=(i?-1:1)*c,o[3*e+e]=u,o},on=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return en(n,t,1,2,!0)},un=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return en(n,t,0,2,!1)},cn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return en(n,t,0,1,!0)},an=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=w(r),o=[0,1,2].map((function(n){return e[n]||0})),u=t(i,3),c=u[0],a=u[1],s=u[2],f=Math.cos(n),l=Math.sin(n),h=Math.sqrt(i[1]*i[1]+i[2]*i[2]),v=Math.abs(h)<1e-6?0:a/h,p=Math.abs(h)<1e-6?1:s/h,g=H.concat(o[0],o[1],o[2]),d=H.concat(-o[0],-o[1],-o[2]),_=[1,0,0,0,p,v,0,-v,p,0,0,0],m=[1,0,0,0,p,-v,0,v,p,0,0,0],y=[h,0,c,0,1,0,-c,0,h,0,0,0],M=[h,0,-c,0,1,0,c,0,h,0,0,0],x=[f,l,0,-l,f,0,0,0,1,0,0,0];return Q(d,Q(m,Q(M,Q(x,Q(y,Q(_,g))))))},sn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[n,0,0,0,n,0,0,0,n,n*-t[0]+t[0],n*-t[1]+t[1],n*-t[2]+t[2]]},fn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),c=e*o+i*u,a=e*-u+i*o,s=i*o+-e*u,f=i*-u+-e*o,l=t[0]+c*-t[0]+-t[1]*s,h=t[1]+a*-t[0]+-t[1]*f;return[c,a,0,s,f,0,0,0,0,l,h,0]},ln=Object.freeze({__proto__:null,identity3x3:H,identity3x4:U,is_identity3x4:V,multiply_matrix3_vector3:W,multiply_matrix3_line3:K,multiply_matrices3:Q,determinant3:nn,invert_matrix3:tn,make_matrix3_translate:rn,make_matrix3_rotateX:on,make_matrix3_rotateY:un,make_matrix3_rotateZ:cn,make_matrix3_rotate:an,make_matrix3_scale:sn,make_matrix3_reflectionZ:fn,make_matrix3_reflection:function(n){return[]}}),hn=function(n,t){return{vector:n||[],origin:t||[]}},vn=function(){if(arguments[0]instanceof R.vector)return arguments[0];var t=l(arguments);return t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(n){return t[0][n]})).filter((function(n){return void 0!==n}))),t.filter((function(n){return"number"==typeof n}))},pn=function(){return f(arguments).map((function(n){return vn(n)}))},gn=function(){if(arguments[0]instanceof R.segment)return arguments[0];var n=f(arguments);return 4===n.length?[[n[0],n[1]],[n[2],n[3]]]:pn(n)},dn=function(){var n=f(arguments);return 0===n.length?hn([],[]):n[0]instanceof R.line||n[0]instanceof R.ray||n[0]instanceof R.segment?n[0]:n[0].constructor===Object?hn(n[0].vector||[],n[0].origin||[]):"number"==typeof n[0]?hn(vn(n)):hn.apply(void 0,r(n.map((function(n){return vn(n)}))))},_n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{width:n,height:t,x:r,y:e}},mn=function(){if(arguments[0]instanceof R.rect)return arguments[0];var t=l(arguments);return t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].width)?_n.apply(void 0,r(["width","height","x","y"].map((function(n){return t[0][n]})).filter((function(n){return void 0!==n})))):_n.apply(void 0,r(t.filter((function(n){return"number"==typeof n}))))},yn=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(n){return delete yn[2][n]}));var Mn=function(n){return yn[n<8?0:n<13?1:2]},xn=function(){var n=l(arguments),t=r(U);return Mn(n.length).filter((function(t,r){return null!=n[r]})).forEach((function(r,e){t[r]=n[e]})),t},bn=Object.freeze({__proto__:null,get_vector:vn,get_vector_of_vectors:pn,get_segment:gn,get_line:dn,rect_form:_n,get_rect:mn,get_matrix_3x4:xn,get_matrix2:function(){var n=vn(arguments);if(void 0!==n)return 6===n.length?n:n.length>6?[n[0],n[1],n[2],n[3],n[4],n[5]]:n.length<6?C.map((function(t,r){return n[r]||t})):void 0}}),wn=function(){return!0},An=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>-t},jn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>-t&&n<1+t},Pn=function(){return!0},On=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>t},Sn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;return n>t&&n<1-t},kn=function(){return!0},In=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t>-r},zn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t>-r&&t<1+r},En=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>-r&&t>-r},qn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>-r&&t>-r&&t<1+r},Nn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>-r&&n<1+r&&t>-r&&t<1+r},Gn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t>r},Fn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t>r&&t<1-r},Tn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>r&&t>r},Ln=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>r&&t>r&&t<1-r},Zn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return n>r&&n<1-r&&t>r&&t<1-r},Dn=function(n,t,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=z(n,r);if(!(Math.abs(u)<o)){var c=-u,a=t[0],s=t[1],f=e[0],l=e[1],h=z([f-a,l-s],r),p=z([a-f,s-l],n),g=h/u,d=p/c;return i(g,d,o)?[a+n[0]*g,s+n[1]*g]:void 0}},Rn=Object.freeze({__proto__:null,include_l:wn,include_r:An,include_s:jn,exclude_l:Pn,exclude_r:On,exclude_s:Sn,include_l_l:kn,include_l_r:In,include_l_s:zn,include_r_r:En,include_r_s:qn,include_s_s:Nn,exclude_l_r:Gn,exclude_l_s:Fn,exclude_r_r:Tn,exclude_r_s:Ln,exclude_s_s:Zn,intersect_lines:Dn}),Jn=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v,o=P(n,r),u=b(t),c=b(o);if(c<i)return e(c,i);if(u<i)return!1;var a=z(o,t),s=O(o,t)/u;return Math.abs(a)<i&&e(s,i)},Cn=function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v,i=P(n,r);return Math.abs(z(i,t))<e},Xn=Object.freeze({__proto__:null,collinear:Jn,point_on_line:Cn,point_on_ray_inclusive:function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v;return Jn(n,t,r,An,e)},point_on_ray_exclusive:function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v;return Jn(n,t,r,On,e)},point_on_segment_inclusive:function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v;return Jn(n,P(r,t),t,jn,e)},point_on_segment_exclusive:function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v;return Jn(n,P(r,t),t,Sn,e)}}),Yn=180/Math.PI,$n=Math.PI/180,Bn=2*Math.PI,Hn=function(n,t){for(;n<0;)n+=Bn;for(;t<0;)t+=Bn;for(;n>Bn;)n-=Bn;for(;t>Bn;)t-=Bn;var r=t-n;return r>=0?r:Bn-(n-t)},Un=function(n,t){var r=n[0]*t[0]+n[1]*t[1],e=n[0]*t[1]-n[1]*t[0],i=Math.atan2(e,r);return i<0&&(i+=Bn),i},Vn=function(n,t){var r=w(n),e=w(t);return O(r,e)<-1+v?[-r[1],r[0]]:w(j(r,e))},Wn=function(n,t,r,e){var i=n[0]*r[1]-r[0]*n[1];if(Math.abs(i)<v){var o=[[n[0],n[1]],S(t,e)],u=[o,o];return delete u[n[0]*r[0]+n[1]*r[1]>0?1:0],u}var c=((e[0]-t[0])*r[1]-r[0]*(e[1]-t[1]))/i,a=[t[0]+n[0]*c,t[1]+n[1]*c],s=[Vn(n,r)];return s[1]=F(s[0]),s.map((function(n){return{vector:n,origin:a}}))},Kn=function(n,t,r){var e=Hn(t,r)/n;return Array.from(Array(n-1)).map((function(n,r){return t+e*r}))},Qn=function(n,t,r){var e=t[0]-n[0],i=t[1]-n[1],o=r[0]-n[0],u=r[1]-n[1],c=e*(n[0]+t[0])+i*(n[1]+t[1]),a=o*(n[0]+r[0])+u*(n[1]+r[1]),s=2*(e*(r[1]-t[1])-i*(r[0]-t[0]));if(Math.abs(s)<v){var f=Math.min(n[0],t[0],r[0]),l=Math.min(n[1],t[1],r[1]),h=.5*(Math.max(n[0],t[0],r[0])-f),p=.5*(Math.max(n[1],t[1],r[1])-l);return{origin:[f+h,l+p],radius:Math.sqrt(h*h+p*p)}}var g=[(u*c-i*a)/s,(e*a-o*c)/s],d=g[0]-n[0],_=g[1]-n[1];return{origin:g,radius:Math.sqrt(d*d+_*_)}},nt=function(n){return.5*n.map((function(n,t,r){var e=r[(t+1)%r.length];return n[0]*e[1]-e[0]*n[1]})).reduce((function(n,t){return n+t}),0)},tt=function(n){var t=1/(6*nt(n));return n.map((function(n,t,r){var e=r[(t+1)%r.length],i=n[0]*e[1]-e[0]*n[1];return[(n[0]+e[0])*i,(n[1]+e[1])*i]})).reduce((function(n,t){return[n[0]+t[0],n[1]+t[1]]}),[0,0]).map((function(n){return n*t}))},rt=function(n){var t=Array(n[0].length).fill(1/0),e=Array(n[0].length).fill(-1/0);n.forEach((function(n){return n.forEach((function(n,r){n<t[r]&&(t[r]=n),n>e[r]&&(e[r]=n)}))}));var i=e.map((function(n,r){return n-t[r]}));return _n.apply(void 0,r(i).concat(r(t)))},et=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=Bn/n/2,o=t/2/Math.cos(i);return Array.from(Array(Math.floor(n))).map((function(t,r){return Bn*(r/n)})).map((function(n){return[r+o*Math.cos(n),e+o*Math.sin(n)]})).map((function(n){return n.map((function(n){return a(n,14)}))}))},it=function(){return console.warn("split polygon not done")},ot=function(n,t,r){var e=n.map((function(n,e){return{point:Cn(n,t,r)?n:null,at_index:e}})).filter((function(n){return null!=n.point})),i=n.map((function(n,e,i){return{point:function(n,t,r,e){var i=r,o=[e[0]-r[0],e[1]-r[1]];return Dn(n,t,o,i,Fn)}(t,r,n,i[(e+1)%i.length]),at_index:e}})).filter((function(n){return null!=n.point}));if(2==i.length){var o=i.slice().sort((function(n,t){return n.at_index-t.at_index})),u=n.slice(o[1].at_index+1).concat(n.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var c=n.slice(o[0].at_index+1,o[1].at_index+1);return c.push(o[1].point),c.push(o[0].point),[u,c]}if(1==i.length&&1==e.length){e[0].type="v",i[0].type="e";var a=e.concat(i).sort((function(n,t){return n.at_index-t.at_index})),s=n.slice(a[1].at_index+1).concat(n.slice(0,a[0].at_index+1));"e"===a[0].type&&s.push(a[0].point),s.push(a[1].point);var f=n.slice(a[0].at_index+1,a[1].at_index+1);return"e"===a[1].type&&f.push(a[1].point),f.push(a[0].point),[s,f]}if(2==e.length){var l=e.slice().sort((function(n,t){return n.at_index-t.at_index}));return[n.slice(l[1].at_index).concat(n.slice(0,l[0].at_index+1)),n.slice(l[0].at_index,l[1].at_index+1)]}return[n.slice()]},ut=function(t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,e=1e4,i=t.slice().sort((function(n,t){return Math.abs(n[1]-t[1])<r?n[0]-t[0]:n[1]-t[1]})),o=[];o.push(i[0]);var u=0,c=0,a=function(){c+=1;var n=o.length-1,t=i.filter((function(t){return!(Math.abs(t[0]-o[n][0])<r&&Math.abs(t[1]-o[n][1])<r)})).map((function(t){for(var r=Math.atan2(o[n][1]-t[1],o[n][0]-t[0]);r<u;)r+=2*Math.PI;return{node:t,angle:r,distance:void 0}})).sort((function(n,t){return n.angle<t.angle?-1:n.angle>t.angle?1:0}));if(0===t.length)return{v:void 0};var e=t[0];if(t=t.filter((function(n){return Math.abs(e.angle-n.angle)<r})).map((function(t){var r=Math.sqrt(Math.pow(o[n][0]-t.node[0],2)+Math.pow(o[n][1]-t.node[1],2));return t.distance=r,t})).sort((function(n,t){return n.distance<t.distance?1:n.distance>t.distance?-1:0})),o.filter((function(n){return n===t[0].node})).length>0)return{v:o};o.push(t[0].node),u=Math.atan2(o[n][1]-t[0].node[1],o[n][0]-t[0].node[0])};do{var s=a();if("object"===n(s))return s.v}while(c<e)},ct=Object.freeze({__proto__:null,R2D:Yn,D2R:$n,TWO_PI:Bn,is_counter_clockwise_between:function(n,t,r){for(;r<t;)r+=Bn;for(;n>t;)n-=Bn;for(;n<t;)n+=Bn;return n<r},clockwise_angle2_radians:function(n,t){for(;n<0;)n+=Bn;for(;t<0;)t+=Bn;for(;n>Bn;)n-=Bn;for(;t>Bn;)t-=Bn;var r=n-t;return r>=0?r:Bn-(t-n)},counter_clockwise_angle2_radians:Hn,clockwise_angle2:function(n,t){var r=t[0]*n[0]+t[1]*n[1],e=t[0]*n[1]-t[1]*n[0],i=Math.atan2(e,r);return i<0&&(i+=Bn),i},counter_clockwise_angle2:Un,counter_clockwise_vector_order:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=t.map((function(n){return Math.atan2(n[1],n[0])})),i=Array.from(Array(e.length)).map((function(n,t){return t})).sort((function(n,t){return e[n]-e[t]}));return i.slice(i.indexOf(0),i.length).concat(i.slice(0,i.indexOf(0)))},interior_angles:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.map((function(n,t,r){return Un(n,r[(t+1)%r.length])}))},bisect_vectors:Vn,bisect_lines2:Wn,subsect_radians:Kn,subsect:function(n,t,r){var e=Math.atan2(t[1],t[0]),i=Math.atan2(r[1],r[0]);return Kn(n,e,i).map((function(n){return[Math.cos(n),Math.sin(n)]}))},circumcircle:Qn,signed_area:nt,centroid:tt,enclosing_rectangle:rt,make_regular_polygon:et,split_polygon:it,split_convex_polygon:ot,convex_hull:ut}),at=function(n,t,r){for(var e,i=t.map((function(t,e){return{o:t,i:e,d:r(n,t)}})),o=1/0,u=0;u<i.length;u+=1)i[u].d<o&&(e=u,o=i[u].d);return e},st=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v,o=Math.pow(n[0],2)+Math.pow(n[1],2),u=[0,1].map((function(n,e){return r[e]-t[e]})),c=[0,1].map((function(t,r){return n[r]*u[r]})).reduce((function(n,t){return n+t}),0),a=c/o,s=e(a,i);return[0,1].map((function(r,e){return t[e]+n[e]*s}))},ft=function(n){return n<-v?0:n>1+v?1:n},lt=function(n,t){var r=n.map((function(n,t,r){return P(r[(t+1)%r.length],n)}));return n.map((function(n,e){return st(r[e],n,t,ft)})).map((function(n,r){return{point:n,i:r,distance:N(n,t)}})).sort((function(n,t){return n.distance-t.distance})).shift()},ht=function(n,t,r){return j(t,A(w(P(r,t)),n))},vt=function(){return!1},pt=Object.freeze({__proto__:null,nearest_point2:function(n,t){var r=at(n,t,q);return void 0===r?void 0:t[r]},nearest_point:function(n,t){var r=at(n,t,N);return void 0===r?void 0:t[r]},nearest_point_on_line:st,segment_limiter:ft,nearest_point_on_polygon:lt,nearest_point_on_circle:ht,nearest_point_on_ellipse:vt}),gt=function(n,t,r,e,i,o){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:v,c=z(n,r),a=-c,s=z(P(e,t),r),f=z(P(t,e),n);if(Math.abs(c)<u)return!1;var l=s/c,h=f/a;return i(l,u)&&o(h,u)},dt=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(P(t,n),n,P(e,r),r,jn,jn,i)},_t=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(P(t,n),n,P(e,r),r,Sn,Sn,i)},mt=Object.freeze({__proto__:null,overlap_lines:gt,overlap_line_line_inclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,wn,wn,i)},overlap_line_ray_inclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,wn,An,i)},overlap_line_segment_inclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,P(e,r),r,wn,jn,i)},overlap_ray_ray_inclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,An,An,i)},overlap_ray_segment_inclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,P(e,r),r,An,jn,i)},overlap_segment_segment_inclusive:dt,overlap_line_line_exclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,Pn,Pn,i)},overlap_line_ray_exclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,Pn,On,i)},overlap_line_segment_exclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,P(e,r),r,Pn,Sn,i)},overlap_ray_ray_exclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,r,e,On,On,i)},overlap_ray_segment_exclusive:function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v;return gt(n,t,P(e,r),r,On,Sn,i)},overlap_segment_segment_exclusive:_t}),yt=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(t){return z(P(t[1],t[0]),P(n,t[0]))>-r})).map((function(n,t,r){return n===r[0]})).reduce((function(n,t){return n&&t}),!0)},Mt=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return t.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(t){return z(P(t[1],t[0]),P(n,t[0]))>r})).map((function(n,t,r){return n===r[0]})).reduce((function(n,t){return n&&t}),!0)},xt=function(n,t){for(var r=!1,e=0,i=t.length-1;e<t.length;i=e++)t[e][1]>n[1]!=t[i][1]>n[1]&&n[0]<(t[i][0]-t[e][0])*(n[1]-t[e][1])/(t[i][1]-t[e][1])+t[e][0]&&(r=!r);return r},bt=function(n,t,r,e){for(var i=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),o=t.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),u=0;u<i.length;u+=1)for(var c=0;c<o.length;c+=1)if(r(i[u][0],i[u][1],o[c][0],o[c][1]))return!0;return!!e(t[0],n)||!!e(n[0],t)},wt=function(n,t){return bt(n,t,dt,yt)},At=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:yt,point_in_convex_poly_exclusive:Mt,point_in_poly:xt,overlap_convex_polygons_inclusive:wt,overlap_convex_polygons_exclusive:function(n,t){return bt(n,t,_t,Mt)},enclose_convex_polygons_inclusive:function(n,t){var r=n.map((function(n){return yt(n,t)})).reduce((function(n,t){return n||t}),!1),e=t.map((function(n){return yt(n,t)})).reduce((function(n,t){return n&&t}),!0);return!r&&e}}),jt=Object.assign(Object.create(null),mt,Xn,At),Pt=function(t){switch(t.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":return t.constructor.name}if("object"===n(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rect";if(null!=t.x||"number"==typeof t[0])return"vector";if(null!=t[0]&&t[0].length&&("number"==typeof t[0].x||"number"==typeof t[0][0]))return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},Ot=function(n){return n>=1?0:n<=-1?Math.PI:Math.acos(n)},St=function(n,t,r){var e=t[0]-n[0],i=t[1]-n[1],o=e*Math.cos(r)+i*Math.sin(r),u=i*Math.cos(r)-e*Math.sin(r);return[n[0]+o,n[1]+u]},kt=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,e=n.radius<t.radius?n.radius:t.radius,i=n.radius<t.radius?t.radius:n.radius,o=n.radius<t.radius?n.origin:t.origin,u=n.radius<t.radius?t.origin:n.origin,c=[o[0]-u[0],o[1]-u[1]],a=Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2));if(!(a<r)){var s=c.map((function(n,t){return n/a*i+u[t]}));if(Math.abs(i+e-a)<r||Math.abs(i-(e+a))<r)return[s];if(!(a+e<i||i+e<a)){var f=Ot((e*e-a*a-i*i)/(-2*a*i)),l=St(u,s,+f),h=St(u,s,-f);return[l,h]}}},It=function(n,t,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:v,u=Math.pow(r[0],2)+Math.pow(r[1],2),c=Math.sqrt(u),a=0===c?r:r.map((function(n){return n/c})),s=[-a[1],a[0]],f=[e[0]-t[0],e[1]-t[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>n+o)){var h=Math.sqrt(Math.pow(n,2)-Math.pow(l,2)),p=function(n,r){return t[r]-s[r]*l+a[r]*n},g=Math.abs(n-Math.abs(l))<o?[h].map((function(n){return[n,n].map(p)})):[-h,h].map((function(n){return[n,n].map(p)})),d=g.map((function(n){return n.map((function(n,t){return n-e[t]}))})).map((function(n){return n[0]*r[0]+r[1]*n[1]})).map((function(n){return n/u}));return g.filter((function(n,t){return i(d[t],o)}))}},zt=function(){return!0},Et=function(n,t){return n>-t},qt=function(n,t){return n>-t&&n<1+t},Nt=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return It(n.radius,n.origin,t.vector,t.origin,zt,r)},Gt=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return It(n.radius,n.origin,t.vector,t.origin,Et,r)},Ft=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return It(n.radius,n.origin,t.vector,t.origin,qt,r)},Tt=Object.freeze({__proto__:null,circle_circle:kt,circle_line:Nt,circle_ray:Gt,circle_segment:Ft}),Lt=function(n,t){return Math.abs(n[0]-t[0])<v&&Math.abs(n[1]-t[1])<v},Zt=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return function(n,t,r,e){return Dn(n,t,P(e,r),r,zn)}(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Lt(e[0],e[i]))return[e[0],e[i]];return}},Dt=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return function(n,t,r,e){return Dn(n,t,P(e,r),r,qn)}(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return e;case 2:return Lt(e[0],e[1])?[e[0]]:e;default:for(var i=1;i<e.length;i+=1)if(!Lt(e[0],e[i]))return[e[0],e[i]];return}},Rt=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return function(n,t,r,e){return Dn(n,t,P(e,r),r,Ln)}(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return e;case 2:return Lt(e[0],e[1])?[e[0]]:e;default:for(var i=1;i<e.length;i+=1)if(!Lt(e[0],e[i]))return[e[0],e[i]];return}},Jt=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return e=t,i=r,o=n[0],u=n[1],Dn(P(i,e),e,P(u,o),o,Zn);var e,i,o,u})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return e;case 2:return Lt(e[0],e[1])?[e[0]]:e;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},Ct=Object.freeze({__proto__:null,convex_poly_circle:function(n,t,r){return[]},convex_poly_line:Zt,convex_poly_ray_inclusive:Dt,convex_poly_ray_exclusive:Rt,convex_poly_segment_inclusive:function(n,t,r){console.log("todo")},convex_poly_segment_exclusive:Jt}),Xt=function(n,t,r,e){return Dn(n.vector,n.origin,t.vector,t.origin,r,e)},Yt=function(n,t){return Zt(n.constructor===Array?n:n.points,t.vector,t.origin)},$t=function(n,t,r){return r(n.constructor===Array?n:n.points,t.vector,t.origin)},Bt=function(n,t,r){return r(n.constructor===Array?n:n.points,t[0],t[1])},Ht={polygon:{line:Yt,ray:function(n,t,r){return $t(n,t,!1===r?Dt:Rt)},segment:function(n,t,r){return Bt(n,t,!1===r?convex_poly_segment_inclusive:Jt)}},circle:{circle:kt,line:Nt,ray:Gt,segment:Ft},line:{polygon:function(n,t){return Yt(t,n)},circle:function(n,t){return Nt(t,n)},line:function(n,t){return Xt(n,t,kn)},ray:function(n,t,r){return Xt(n,t,!1===r?Gn:In)},segment:function(n,t,r){return Xt(n,t,!1===r?Fn:zn)}},ray:{polygon:function(n,t,r){return $t(t,n,!1===r?Dt:Rt)},circle:function(n,t){return Gt(t,n)},line:function(n,t,r){return Xt(t,n,!1===r?Gn:In)},ray:function(n,t,r){return Xt(n,t,!1===r?Tn:En)},segment:function(n,t,r){return Xt(n,t,!1===r?Ln:qn)}},segment:{polygon:function(n,t,r){return Bt(t,n,!1===r?convex_poly_segment_inclusive:Jt)},circle:function(n,t){return Ft(t,n)},line:function(n,t,r){return Xt(t,n,!1===r?Fn:zn)},ray:function(n,t,r){return Xt(t,n,!1===r?Ln:qn)},segment:function(n,t,r){return Xt(n,t,!1===r?Zn:Nn)}}},Ut=function(n,t){var r,e=Pt(n),i=Pt(t);return(r=Ht[e])[i].apply(r,arguments)},Vt={preserve:{magnitude:function(){return x(this)},isEquivalent:function(){return _(this,vn(arguments))},isParallel:function(){return Z.apply(void 0,r(u(this,vn(arguments))))},dot:function(){return O.apply(void 0,r(u(this,vn(arguments))))},distanceTo:function(){return N.apply(void 0,r(u(this,vn(arguments))))}},vector:{copy:function(){return r(this)},normalize:function(){return w(this)},scale:function(){return A(this,arguments[0])},flip:function(){return G(this)},rotate90:function(){return F(this)},rotate270:function(){return T(this)},cross:function(){return E(o(3,this),o(3,vn(arguments)))},transform:function(){return W(xn(arguments),o(3,this))},add:function(){return j(this,o(this.length,vn(arguments)))},subtract:function(){return P(this,o(this.length,vn(arguments)))},rotateZ:function(n,t){return W(xn(Y(n,t)),o(3,this))},lerp:function(n,t){return I(this,o(this.length,vn(n)),t)},midpoint:function(){return S.apply(void 0,r(u(this,vn(arguments))))},bisect:function(){return Vn(this,vn(arguments))}}},Wt={};Object.keys(Vt.preserve).forEach((function(n){Wt[n]=Vt.preserve[n]})),Object.keys(Vt.vector).forEach((function(n){Wt[n]=function(){return R.vector.apply(R,r(Vt.vector[n].apply(this,arguments)))}}));var Kt={fromAngle:function(n){return R.vector(Math.cos(n),Math.sin(n))},fromAngleDegrees:function(n){return R.vector.fromAngle(n*$n)}},Qt={vector:{P:Array.prototype,A:function(){var n=this;vn(arguments).forEach((function(t){return n.push(t)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:Wt,S:Kt}},nr=function(){};nr.prototype.isParallel=function(){var n=u(this.vector,dn.apply(void 0,arguments).vector);return Z.apply(void 0,r(n))},nr.prototype.isDegenerate=function(){return L(this.vector)},nr.prototype.reflection=function(){return R.matrix($(this.vector,this.origin))},nr.prototype.nearestPoint=function(){var n=vn(arguments);return R.vector(st(this.vector,this.origin,n,this.clip_function))},nr.prototype.transform=function(){var n=this.dimension,t=K(xn(arguments),o(3,this.vector),o(3,this.origin));return this.constructor(o(n,t.vector),o(n,t.origin))},nr.prototype.intersect=function(n){return Ut(this,n)},nr.prototype.bisect=function(){var n=dn(arguments);return Wn(this.vector,this.origin,n.vector,n.origin)},Object.defineProperty(nr.prototype,"dimension",{get:function(){return[this.vector,this.origin].map((function(n){return n.length})).reduce((function(n,t){return Math.max(n,t)}),0)}});var tr={fromPoints:function(){var n=pn(arguments);return this.constructor({vector:P(n[1],n[0]),origin:n[0]})},perpendicularBisector:function(){var n=pn(arguments);return this.constructor({vector:F(P(n[1],n[0])),origin:k(n[0],n[1])})}},rr={line:{P:nr.prototype,A:function(){var n=dn.apply(void 0,arguments);this.vector=R.vector(n.vector),this.origin=R.vector(o(this.vector.length,n.origin))},G:{length:function(){return 1/0}},M:{clip_function:function(n){return n},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-n/2)),r=this.vector.scale(n);return"M".concat(t[0]," ").concat(t[1],"l").concat(r[0]," ").concat(r[1])}},S:tr}},er={ray:{P:nr.prototype,A:function(){var n=dn.apply(void 0,arguments);this.vector=R.vector(n.vector),this.origin=R.vector(o(this.vector.length,n.origin))},G:{length:function(){return 1/0}},M:{rotate180:function(){return R.ray(G(this.vector),this.origin)},clip_function:function(n){return n<-v?0:n},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(n);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:tr}},ir={segment:{P:nr.prototype,A:function(){var n=gn.apply(void 0,arguments);this.points=[R.vector(n[0]),R.vector(n[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:ft,transform:function(){for(var n=this.points[0].length,t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=xn(r),u=this.points.map((function(n){return o(3,n)})).map((function(n){return W(i,n)})).map((function(t){return o(n,t)}));return R.segment(u)},midpoint:function(){return R.vector(k(this.points[0],this.points[1]))},svgPath:function(){var n=this.points.map((function(n){return"".concat(n[0]," ").concat(n[1])}));return["M","L"].map((function(t,r){return"".concat(t).concat(n[r])})).join("")}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)}}}},or=function(n,t,r,e,i,o){var u=Math.cos(i),c=Math.sin(i),a=Math.cos(o),s=Math.sin(o);return[n+u*r*a+-c*e*s,t+c*r*a+u*e*s]},ur=function(n,t,r,e,i,o,u){var c=o;if(c<0&&!isNaN(c))for(;c<0;)c+=2*Math.PI;var a=u>2*Math.PI?2*Math.PI:u,s=or(n,t,r,e,i,c),f=or(n,t,r,e,i,c+a/2),l=or(n,t,r,e,i,c+a),h=a/2>Math.PI?1:0,v=a/2>0?1:0;return{x1:s[0],y1:s[1],x2:f[0],y2:f[1],x3:l[0],y3:l[1],fa:h,fs:v}},cr=function(n){return a(n,4)},ar=function(n,t,r,e,i,o,u){return"A".concat(cr(n)," ").concat(cr(t)," ").concat(cr(r)," ").concat(cr(e)," ").concat(cr(i)," ").concat(cr(o)," ").concat(cr(u))},sr={circle:{A:function(){var n=pn(arguments),t=o(3,l(arguments));2===n.length?(this.radius=1===n[0].length?n[0][0]:q.apply(void 0,r(n)),this.origin=1===n[0].length?R.vector.apply(R,r(n[1])):R.vector.apply(R,r(n[0]))):(this.radius=t[0],this.origin=R.vector(t[1],t[2]))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{nearestPoint:function(){return R.vector(ht(this.radius,this.origin,vn(arguments)))},intersect:function(n){return Ut(this,n)},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=ur(this.origin[0],this.origin[1],this.radius,this.radius,0,n,t),e=ar(this.radius,this.radius,0,r.fa,r.fs,r.x2,r.y2),i=ar(this.radius,this.radius,0,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(e).concat(i)},points:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(n,r){return 2*Math.PI/t*r})).map((function(t){return[n.origin[0]+n.radius*Math.cos(t),n.origin[1]+n.radius*Math.sin(t)]}))},polygon:function(){return R.polygon(this.points(arguments[0]))},segments:function(){var n=this.points(arguments[0]);return n.map((function(t,r){var e=(r+1)%n.length;return[t,n[e]]}))}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)},fromThreePoints:function(){var n=Qn.apply(void 0,arguments);return this.constructor.apply(this,[n.radius].concat(r(n.origin)))}}}},fr=function(n,t,r,e){var i=t>r,o=i?Math.pow(t,2)-Math.pow(r,2):Math.pow(r,2)-Math.pow(t,2),u=Math.sqrt(o),c=i?Math.cos(e):Math.sin(e),a=i?Math.sin(e):Math.cos(e);return[R.vector(n[0]+u*c,n[1]+u*a),R.vector(n[0]-u*c,n[1]-u*a)]},lr={ellipse:{A:function(){var n=l(arguments).filter((function(n){return!isNaN(n)})),t=o(5,n);this.rx=t[0],this.ry=t[1],this.origin=R.vector(t[2],t[3]),this.spin=t[4],this.foci=fr(this.origin,this.rx,this.ry,this.spin)},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{nearestPoint:function(){return R.vector((this.origin,this.radius,vn(arguments),!1))},intersect:function(n){return Ut(this,n)},svgPath:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,r=ur(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,n,t),e=ar(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x2,r.y2),i=ar(this.rx,this.ry,this.spin/Math.PI*180,r.fa,r.fs,r.x3,r.y3);return"M".concat(r.x1," ").concat(r.y1).concat(e).concat(i)},points:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(n,r){return 2*Math.PI/t*r})).map((function(t){return or(n.origin.x,n.origin.y,n.rx,n.ry,n.spin,t)}))},polygon:function(){return R.polygon(this.points(arguments[0]))},segments:function(){var n=this.points(arguments[0]);return n.map((function(t,r){var e=(r+1)%n.length;return[t,n[e]]}))}},S:{}}},hr=function(n){if(void 0!==n)switch(n.length){case void 0:break;case 1:return R.vector(n);case 2:return R.segment(n);default:return n}},vr={area:function(){return nt(this.points)},centroid:function(){return R.vector(tt(this.points))},enclosingRectangle:function(){return R.rect(rt(this.points))},contains:function(){return xt(vn(arguments),this.points)},scale:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt(this.points),r=this.points.map((function(n){return[0,1].map((function(r,e){return n[e]-t[e]}))})).map((function(r){return r.map((function(e,i){return t[i]+r[i]*n}))}));return this.constructor.fromPoints(r)},rotate:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt(this.points),r=this.points.map((function(r){var e=[r[0]-t[0],r[1]-t[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[t[0]+Math.cos(o+n)*i,t[1]+Math.sin(o+n)*i]}));return R.polygon(r)},translate:function(){var n=vn.apply(void 0,arguments),t=this.points.map((function(t){return t.map((function(t,r){return t+n[r]}))}));return this.constructor.fromPoints(t)},transform:function(){var n=xn.apply(void 0,arguments),t=this.points.map((function(t){return W(n,o(3,t))}));return R.polygon(t)},nearest:function(){var n=vn.apply(void 0,arguments),t=lt(this.points,n);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function(){var n=f(arguments);return wt(this.points,n)},split:function(){var n=dn.apply(void 0,arguments),t=this.convex?ot:it;return t(this.points,n.vector,n.origin).map((function(n){return R.polygon(n)}))},intersectLine:function(){var n=dn.apply(void 0,arguments),t=Zt(this.points,n.vector,n.origin);return hr(t)},intersectRay:function(){var n=dn.apply(void 0,arguments),t=Rt(this.points,n.vector,n.origin);return hr(t)},intersectSegment:function(){var n=gn.apply(void 0,arguments),t=Jt(this.points,n[0],n[1]);return hr(t)},svgPath:function(){var n=Array(this.points.length).fill("L");return n[0]="M","".concat(this.points.map((function(t,r){return"".concat(n[r]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function(n){return Ut(this,n)}},pr=function(){this.points=[]};Object.keys(vr).forEach((function(n){pr.prototype[n]=vr[n]}));var gr=function(n){return[[n.x,n.y],[n.x+n.width,n.y],[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]]},dr={rect:{P:pr.prototype,A:function(){var n=mn.apply(void 0,arguments);this.width=n.width,this.height=n.height,this.origin=R.vector(n.x,n.y),this.points=gr(this)},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{area:function(){return this.width*this.height},segments:function(){return[[[(n=this).x,n.y],[n.x+n.width,n.y]],[[n.x+n.width,n.y],[n.x+n.width,n.y+n.height]],[[n.x+n.width,n.y+n.height],[n.x,n.y+n.height]],[[n.x,n.y+n.height],[n.x,n.y]]];var n}},S:{fromPoints:function(){return R.rect(rt(pn(arguments)))}}}},_r={polygon:{P:pr.prototype,A:function(){this.points=f(arguments),this.sides=this.points.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),this.vectors=this.sides.map((function(n){return P(n[1],n[0])}))},G:{isConvex:function(){return!0},edges:function(){return this.sides}},M:{segments:function(){return this.sides}},S:{fromPoints:function(){return this.constructor.apply(this,arguments)},regularPolygon:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.constructor(et(n,t,r,e))},convexHull:function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.constructor(ut(n,t))}}}},mr=function(n,t){for(var r=0;r<12;r+=1)n[r]=t[r];return n},yr={matrix:{P:Array.prototype,A:function(){var n=this;xn(arguments).forEach((function(t){return n.push(t)}))},G:{},M:{copy:function(){return R.matrix.apply(R,r(Array.from(this)))},set:function(){return mr(this,xn(arguments))},isIdentity:function(){return V(this)},multiply:function(n){return mr(this,Q(this,n))},determinant:function(){return nn(this)},inverse:function(){return mr(this,tn(this))},translate:function(n,t,r){return mr(this,Q(this,rn(n,t,r)))},rotateX:function(n){return mr(this,Q(this,on(n)))},rotateY:function(n){return mr(this,Q(this,un(n)))},rotateZ:function(n){return mr(this,Q(this,cn(n)))},rotate:function(n,t,r){var e=an(n,t,r);return mr(this,Q(this,e))},scale:function(n){return mr(this,Q(this,sn(n)))},reflectZ:function(n,t){var r=fn(n,t);return mr(this,Q(this,r))},transform:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return R.vector(W(vn(t),this))},transformVector:function(n){return R.vector(W(this,n))},transformLine:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=dn(t);return R.line(K(this,e.vector,e.origin))}},S:{}}},Mr=Object.assign({},Qt,rr,er,ir,sr,lr,dr,_r,yr),xr=function(n,t){var r=Object.create(Mr[n].proto);return Mr[n].A.apply(r,t),r};Object.assign(R,{vector:function(){return xr("vector",arguments)},circle:function(){return xr("circle",arguments)},ellipse:function(){return xr("ellipse",arguments)},rect:function(){return xr("rect",arguments)},polygon:function(){return xr("polygon",arguments)},line:function(){return xr("line",arguments)},ray:function(){return xr("ray",arguments)},segment:function(){return xr("segment",arguments)},matrix:function(){return xr("matrix",arguments)}}),Object.keys(Mr).forEach((function(n){var t={};t.prototype=null!=Mr[n].P?Object.create(Mr[n].P):Object.create(Object.prototype),t.prototype.constructor=t,R[n].prototype=t.prototype,R[n].prototype.constructor=R[n],Object.keys(Mr[n].G).forEach((function(r){return Object.defineProperty(t.prototype,r,{get:Mr[n].G[r]})})),Object.keys(Mr[n].M).forEach((function(r){return Object.defineProperty(t.prototype,r,{value:Mr[n].M[r]})})),Object.keys(Mr[n].S).forEach((function(t){return Object.defineProperty(R[n],t,{value:Mr[n].S[t].bind(R[n].prototype)})})),Mr[n].proto=t.prototype}));var br=R;return br.core=Object.assign(Object.create(null),D,m,ct,B,ln,pt,jt,bn,h,Tt,Rn,Ct),br.typeof=Pt,br.intersect=Ut,br}));
