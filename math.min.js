/* Math (c) Robby Kraft, MIT License */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.math=t()})(this,function(){'use strict';var m=Math.PI,f=Math.abs,u=Math.sin,v=Math.cos,k=Math.atan2,P=Math.sqrt,x=Math.pow;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return r(e)||o(e,t)||p()}function n(e){return i(e)||l(e)||a()}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function r(e){if(Array.isArray(e))return e}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(e,t){var n=[],i=!0,r=!1,l=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!(t&&n.length===t));i=!0);}catch(e){r=!0,l=e}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw l}}return n}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function g(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return X(t)}function c(){var e=Array.from(arguments),t=e.filter(function(e){return!isNaN(e)}),i=e.filter(function(e){return e.constructor===Array});if(0===e.length)return{vector:[],point:[]};if(!isNaN(e[0])&&4<=t.length)return{point:[e[0],e[1]],vector:[e[2],e[3]]};if(0<i.length){if(1===i.length)return c.apply(void 0,n(i[0]));if(2===i.length)return{point:[i[0][0],i[0][1]],vector:[i[1][0],i[1][1]]};if(4===i.length)return{point:[i[0],i[1]],vector:[i[2],i[3]]}}if(e[0].constructor===Object){var r=[],l=[];return null==e[0].vector?null!=e[0].direction&&(r=G(e[0].direction)):r=G(e[0].vector),null==e[0].point?null!=e[0].origin&&(l=G(e[0].origin)):l=G(e[0].point),{point:l,vector:r}}return{point:[],vector:[]}}function y(){return c.apply(void 0,arguments)}function _(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(0!==i.length){if(1===i.length&&void 0!==i[0])return _.apply(void 0,n(i[0]));var l=Array.from(i),o=l.filter(function(e){return!isNaN(e)}),a=l.filter(function(t){return"object"===e(t)}).filter(function(e){return e.constructor===Array});return 4<=o.length?[[o[0],o[1]],[o[2],o[3]]]:2<=a.length&&!isNaN(a[0][0])?a:1!==a.length||isNaN(a[0][0][0])?void 0:a[0]}}function d(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?void 0:1===t.length&&void 0!==t[0]?d.apply(void 0,n(t[0])):Array.from(t)}function h(e,t){var n=null==t?{}:t,i=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ee;return this.compare_function(e,t)&&!0},r=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ee;return this.compare_function(e,n)&&t>=-n},l=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ee;return this.compare_function(e,n)&&t>=-n&&t<=1+n};return Object.defineProperty(n,"isParallel",{value:function(e,t){if(null==e.vector)throw"line isParallel(): please ensure object contains a vector";var n=this.vector.length<e.vector.length,i=n?this.vector:e.vector,r=n?e.vector:this.vector;return ge(i,r,t)}}),Object.defineProperty(n,"isDegenerate",{value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ee;return pe(this.vector,e)}}),Object.defineProperty(n,"nearestPoint",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=G(t);return pt(nt(this.point,this.vector,i,this.clip_function))}}),Object.defineProperty(n,"reflection",{value:function(){return gt.makeReflection(this.vector,this.point)}}),Object.defineProperty(n,"intersect",{value:function(e){var t=this;return qe(this.point,this.vector,e.point,e.vector,function(n,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ee;return t.compare_function(n,r)&&e.compare_function(i,r)})}}),Object.defineProperty(n,"intersectLine",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=c(t);return qe(this.point,this.vector,r.point,r.vector,i.bind(this))}}),Object.defineProperty(n,"intersectRay",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=y(t);return qe(this.point,this.vector,i.point,i.vector,r.bind(this))}}),Object.defineProperty(n,"intersectEdge",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=g(t),r=[i[1][0]-i[0][0],i[1][1]-i[0][1]];return qe(this.point,this.vector,i[0],r,l.bind(this))}}),Object.freeze(n)}function s(e){var t={},n=e,i=function(){return Ce(this.points)},r=function(){return this.points.map(function(e,t,n){return[n[(t+n.length-1)%n.length],n[t],n[(t+1)%n.length]]}).map(function(e){return ht(e[1],e[2],e[0])})};return Object.defineProperty(t,"area",{value:i}),Object.defineProperty(t,"centroid",{value:function(){return $e(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return j(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return Ue(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ye(G(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,l=G(t),o=this.sides.map(function(e){return e.nearestPoint(l)}),a=1/0;return o.map(function(e){return I(l,e)}).forEach(function(e,t){e<a&&(a=e,r=t)}),{point:o[r],edge:this.sides[r]}}}),Object.defineProperty(t,"clipSegment",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=g(n),l=We(this.points,r[0],r[1]);return void 0===l?void 0:dt(l)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=c(n),l=De(this.points,r.point,r.vector);return void 0===l?void 0:dt(l)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=c(n),l=Fe(this.points,r.point,r.vector);return void 0===l?void 0:dt(l)}}),Object.defineProperty(t,"split",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=c(t);return it(this.points,r.point,r.vector).map(function(e){return n(e)})}}),Object.defineProperty(t,"scale",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:$e(this.points),i=this.points.map(function(e){return[0,1].map(function(n,r){return e[r]-t[r]})}).map(function(n){return n.map(function(r,l){return t[l]+n[l]*e})});return n(i)}}),Object.defineProperty(t,"rotate",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:$e(this.points),i=this.points.map(function(n){var i=[n[0]-t[0],n[1]-t[1]],r=P(x(i[0],2)+x(i[1],2)),l=k(i[1],i[0]);return[t[0]+v(l+e)*r,t[1]+u(l+e)*r]});return n(i)}}),Object.defineProperty(t,"translate",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=G(t),l=this.points.map(function(e){return e.map(function(e,t){return e+r[t]})});return n(l)}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=$(t),l=this.points.map(function(e){return pt(A(e,r))});return n(l)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return r()}}),Object.defineProperty(t,"signedArea",{value:i}),Object.freeze(t)}var b=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return P(t)},w=function(e){var t=b(e);return e.map(function(e){return e/t})},z=function(e,t){return e.map(function(n,r){return e[r]*t[r]}).reduce(function(e,t){return e+t},0)},j=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=0<t.length?t[0].length:0,r=Array(i).fill(0);return t.forEach(function(e){return r.forEach(function(t,n){r[n]+=e[n]||0})}),r.map(function(e){return e/t.length})},E=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[0]*t[2]-e[2]*t[0],e[0]*t[1]-e[1]*t[0]]},I=function(e,t){var n=e[0]-t[0],i=e[1]-t[1];return P(n*n+i*i)},R=function(e,t){for(var n=e.length,r=0,l=0;l<n;l+=1)r+=x(e[l]-t[l],2);return P(r)},S=function(e,t){return e.map(function(n,r){return(e[r]+t[r])/2})},q=/*#__PURE__*/Object.freeze({magnitude:b,normalize:w,dot:z,average:j,cross2:function(e,t){return[e[0]*t[1],e[1]*t[0]]},cross3:E,distance2:I,distance3:function(t,n){var i=t[0]-n[0],r=t[1]-n[1],l=t[2]-n[2];return P(i*i+r*r+l*l)},distance:R,midpoint2:S}),A=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},V=function(e,t,n){var r=A(e,n),l=t.map(function(n,r){return t[r]+e[r]}),o=A(l,n).map(function(e,t){return e-r[t]});return[r,o]},Z=function(e,t){var n=e[0]*t[0]+e[2]*t[1],i=e[0]*t[2]+e[2]*t[3],r=e[0]*t[4]+e[2]*t[5]+e[4],l=e[1]*t[0]+e[3]*t[1],o=e[1]*t[2]+e[3]*t[3],a=e[1]*t[4]+e[3]*t[5]+e[5];return[n,l,i,o,r,a]},L=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=e*-t[0]+t[0],i=e*-t[1]+t[1];return[e,0,0,e,n,i]},T=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=v(e),i=u(e),r=t[0],l=t[1];return[n,i,-i,n,r,l]},O=function(e,t){var n=t&&t[0]?t[0]:0,i=t&&t[1]?t[1]:0,r=k(e[1],e[0]),l=v(r),o=u(r),p=v(-r),g=u(-r),y=l*p+o*g,a=l*-g+o*p,_=o*p+-l*g,c=o*-g+-l*p;return[y,a,_,c,n+y*-n+-i*_,i+a*-n+-i*c]},H=function(e){var t=e[0]*e[3]-e[1]*e[2];return t&&!isNaN(t)&&isFinite(e[4])&&isFinite(e[5])?[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]:void 0},N=function(e,t){var n=[];return n[0]=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],n[1]=t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],n[2]=t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],n[3]=t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3],n},B=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=e*-t[0]+t[0],i=e*-t[1]+t[1],r=e*-t[2]+t[2];return[e,0,0,0,0,e,0,0,0,0,e,0,n,i,r,1]},D=function(e){var t=[];t[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],t[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],t[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],t[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],t[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],t[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],t[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],t[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],t[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],t[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],t[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];var i=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12];if(!(1e-6>i&&-1e-6<i)){return t.map(function(e){return e*(1/i)})}},F=function(e,t){return[e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15]]},W=/*#__PURE__*/Object.freeze({multiply_vector2_matrix2:A,multiply_line_matrix2:V,multiply_matrices2:Z,make_matrix2_translation:function(e,t){return[1,0,0,1,e,t]},make_matrix2_scale:L,make_matrix2_rotation:T,make_matrix2_reflection:O,make_matrix2_inverse:H,multiply_vector4_matrix4:N,make_matrix4_scale:B,make_matrix4_inverse:D,transpose_matrix4:function(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]},multiply_matrices4:F}),J=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:15;return parseFloat(e.toFixed(t))},Q=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},M=function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];switch(i.length){case void 0:case 0:return i;case 1:return Q(i[0])&&"string"!=typeof i[0]?e.apply(void 0,n(i[0])):[i[0]];default:return Array.from(i).map(function(t){return Q(t)?n(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},K=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var r=n;1===r.length&&r[0].length;){var l=r,o=t(l,1);r=o[0]}return r},G=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=M(t).filter(function(e){return void 0!==e});if(void 0!==i)return 0===i.length?void 0:(isNaN(i[0].x)||(i=["x","y","z"].map(function(e){return i[0][e]}).filter(function(e){return void 0!==e})),i.filter(function(e){return"number"==typeof e}))},X=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return K(t).map(function(e){return G(e)})},Y=[1,0,0,1,0,0],C=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=G(t);return void 0===r?void 0:6===r.length?r:6<r.length?[r[0],r[1],r[2],r[3],r[4],r[5]]:6>r.length?Y.map(function(e,t){return r[t]||e}):void 0},U=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=G(t);return void 0===r?void 0:16===r.length?r:9===r.length?[r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1]:6===r.length?[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,r[4],r[5],0,1]:4===r.length?[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,0,0,0,1]:16<r.length?[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]]:16>r.length?C.map(function(e,t){return r[t]||e}):void 0},ee=1e-6,te=function(e,t){return Array.from(Array(e.length-1)).map(function(n,r){return t(e[0],e[r+1])}).reduce(function(e,t){return e&&t},!0)},ne=function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var l=X(i);if(0===l.length)return!1;if(1===l.length&&void 0!==l[0])return e.apply(void 0,n(l[0]));var o=l[0].length,a=Array.from(Array(o));return Array.from(Array(l.length-1)).map(function(e,t){return a.map(function(e,n){return f(l[t][n]-l[t+1][n])<ee}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)&&Array.from(Array(l.length-1)).map(function(e,t){return l[0].length===l[t+1].length}).reduce(function(e,t){return e&&t},!0)},ie=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=K(n);if(1>r.length)return!1;var l=e(r[0]);if("undefined"===l)return!1;switch(r[0].constructor===Array&&(r=r.map(function(e){return K(e)})),l){case"number":return te(r,function(e,t){return f(e-t)<ee});case"boolean":return te(r,function(e,t){return e===t});case"object":return r[0].constructor===Array?ne(r):(console.warn("comparing array of objects for equivalency by slow stringify and no-epsilon"),te(r,function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:console.warn("incapable of determining comparison method");}return!1},re=/*#__PURE__*/Object.freeze({EPSILON:ee,equivalent_numbers:function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return 0!==i.length&&(1===i.length&&void 0!==i[0]?e.apply(void 0,n(i[0])):te(i,function(e,t){return f(e-t)<ee}))},equivalent_vectors:ne,equivalent:ie}),le=function(e,t,n,i,r){var l=function(e,t){return e[0]*t[1]-t[0]*e[1]},o=l(t,i),a=l([n[0]-e[0],n[1]-e[1]],i),p=l([e[0]-n[0],e[1]-n[1]],t);if(f(o)<ee)return!1;return r(a/o,p/-o)},oe=function(e,t){return e>=-ee&&e<=1+ee&&t>=-ee&&t<=1+ee},ae=function(e,t,n,i){var r=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]];return le(e,r,n,l,oe)},pe=function(e){return f(e.reduce(function(e,t){return e+t},0))<ee},ge=function(e,t){return 1-f(z(w(e),w(t)))<ee},ce=function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:ee,r=[n[0]-e[0],n[1]-e[1]],l=r[0]*t[1]-r[1]*t[0];return f(l)<i},ye=function(e,t){for(var n=!1,r=0,l=t.length-1;r<t.length;l=r++)t[r][1]>e[1]!=t[l][1]>e[1]&&e[0]<(t[l][0]-t[r][0])*(e[1]-t[r][1])/(t[l][1]-t[r][1])+t[r][0]&&(n=!n);return n},_e=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:ee;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var l=i[(r+1)%i.length],o=[l[0]-t[0],l[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>-n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},de=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:ee;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var l=i[(r+1)%i.length],o=[l[0]-t[0],l[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},he=function(e,t){for(var n=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),r=t.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),l=0;l<n.length;l+=1)for(var o=0;o<r.length;o+=1)if(ae(n[l][0],n[l][1],r[o][0],r[o][1]))return!0;return!!ye(t[0],e)||!!ye(e[0],t)},se=function(e,t,n){for(;n<t;)n+=2*m;for(;e<t;)e+=2*m;return e<n},me=/*#__PURE__*/Object.freeze({overlap_function:le,segment_segment_overlap:ae,degenerate:pe,parallel:ge,point_on_line:ce,point_on_segment:function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:ee,r=[e[0]-t[0],e[1]-t[1]],l=[e[0]-n[0],e[1]-n[1]],o=[t[0]-n[0],t[1]-n[1]],a=P(r[0]*r[0]+r[1]*r[1]),p=P(l[0]*l[0]+l[1]*l[1]),g=P(o[0]*o[0]+o[1]*o[1]);return f(a-p-g)<i},point_in_poly:ye,point_in_convex_poly:_e,point_in_convex_poly_exclusive:de,convex_polygons_overlap:he,convex_polygon_is_enclosed:function(e,t){var n=t.map(function(t){return _e(t,e)}).reduce(function(e,t){return e||t},!1);return!n&&void 0},convex_polygons_enclose:function(e,t){var n=t.map(function(t){return _e(t,e)}).reduce(function(e,t){return e||t},!1),i=e.map(function(t){return _e(t,e)}).reduce(function(e,t){return e&&t},!0);return!n&&i},is_counter_clockwise_between:se}),fe=function(){return!0},ue=function(e,t){return t>=-ee},ve=function(e,t){return t>=-ee&&t<=1+ee},ke=function(e,t){return e>=-ee&&t>=-ee},Pe=function(e,t){return e>=-ee&&t>=-ee&&t<=1+ee},xe=function(e,t){return e>=-ee&&e<=1+ee&&t>=-ee&&t<=1+ee},be=function(e,t){return t>ee},we=function(e,t){return t>ee&&t<1-ee},ze=function(e,t){return e>ee&&t>ee},je=function(e,t){return e>ee&&t>ee&&t<1-ee},Ee=function(e,t){return e>ee&&e<1-ee&&t>ee&&t<1-ee},Ie=function(e){return e},Re=function(e){return e<-ee?0:e},Se=function(e){return e<-ee?0:e>1+ee?1:e},qe=function(e,t,n,i,r){function l(e,t){return e[0]*t[1]-t[0]*e[1]}var o=5<arguments.length&&arguments[5]!==void 0?arguments[5]:ee,a=l(t,i);if(!(f(a)<o)){var p=l([n[0]-e[0],n[1]-e[1]],i),g=l([e[0]-n[0],e[1]-n[1]],t),c=p/a;return r(c,g/-a,o)?[e[0]+t[0]*c,e[1]+t[1]*c]:void 0}},Ae=function(e,t,n,i,r){var l=[i[0]-n[0],i[1]-n[1]];return qe(e,t,n,l,ve,r)},Ve=function(e,t,n,i,r){var l=[i[0]-n[0],i[1]-n[1]];return qe(e,t,n,l,Pe,r)},Ze=function(e,t,n,i,r){var l=[i[0]-n[0],i[1]-n[1]];return qe(e,t,n,l,we,r)},Le=function(e,t,n,i,r){var l=[i[0]-n[0],i[1]-n[1]];return qe(e,t,n,l,je,r)},Te=function(e,t,n,i,r){var l=[t[0]-e[0],t[1]-e[1]],o=[i[0]-n[0],i[1]-n[1]];return qe(e,l,n,o,Ee,r)},Oe=function(e,t,n,i){function r(e){return e<-l?-1:1}var l=4<arguments.length&&arguments[4]!==void 0?arguments[4]:ee,o=n[0]-e[0],a=n[1]-e[1],p=i[0]-e[0],g=i[1]-e[1],c=p-o,y=g-a,_=o*g-p*a,d=_*_,h=t*t,s=f(c*c+y*y),m=h*s-d;if(!(m<-l)){var u=P(h*s-d),v=[e[0]+(_*y+r(y)*c*u)/s,e[1]+(-_*c+f(y)*u)/s];if(m>l){var k=[e[0]+(_*y-r(y)*c*u)/s,e[1]+(-_*c-f(y)*u)/s];return[v,k]}return[v]}},He=function(){throw"circle_ray has not been written yet"},Ne=function(e,t,n,i){function r(e){return 0>e?-1:1}var l=x(t,2),o=n[0]-e[0],a=n[1]-e[1],p=i[0]-e[0],g=i[1]-e[1],c=p-o,y=g-a,_=c*c+y*y,d=o*g-p*a,h=(d*y+r(y)*c*P(l*_-d*d))/_,s=(d*y-r(y)*c*P(l*_-d*d))/_,m=(-d*c+f(y)*P(l*_-d*d))/_,u=(-d*c-f(y)*P(l*_-d*d))/_,v=isNaN(h),k=isNaN(s);return v||k?v&&k?void 0:v?k?void 0:[[s+e[0],u+e[1]]]:[[h+e[0],m+e[1]]]:[[h+e[0],m+e[1]],[s+e[0],u+e[1]]]},Be=function(e,t){return f(e[0]-t[0])<ee&&f(e[1]-t[1])<ee},De=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Ae(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[r[0],r[0]];case 2:return r;default:for(var l=1;l<r.length;l+=1)if(!Be(r[0],r[l]))return[r[0],r[l]];}},Fe=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Ve(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var l=1;l<r.length;l+=1)if(!Be(r[0],r[l]))return[r[0],r[l]];}},We=function(e,t,i){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Te(t,i,e[0],e[1])}).filter(function(e){return null!=e}),l=de(t,e),o=de(i,e),a=_e(t,e),p=_e(i,e);if(0===r.length&&(l||o))return[t,i];if(0===r.length&&a&&p)return[t,i];switch(r.length){case 0:return l?[n(t),n(i)]:void 0;case 1:return a?[n(t),r[0]]:[n(i),r[0]];case 2:return r;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points");}},Je=/*#__PURE__*/Object.freeze({limit_line:Ie,limit_ray:Re,limit_segment:Se,intersection_function:qe,line_line:function(e,t,n,i,r){return qe(e,t,n,i,fe,r)},line_ray:function(e,t,n,i,r){return qe(e,t,n,i,ue,r)},line_segment:Ae,ray_ray:function(e,t,n,i,r){return qe(e,t,n,i,ke,r)},ray_segment:Ve,segment_segment:function(e,t,n,i,r){var l=[t[0]-e[0],t[1]-e[1]],o=[i[0]-n[0],i[1]-n[1]];return qe(e,l,n,o,xe,r)},line_ray_exclusive:function(e,t,n,i,r){return qe(e,t,n,i,be,r)},line_segment_exclusive:Ze,ray_ray_exclusive:function(e,t,n,i,r){return qe(e,t,n,i,ze,r)},ray_segment_exclusive:Le,segment_segment_exclusive:Te,circle_line:Oe,circle_ray:He,circle_segment:Ne,convex_poly_line:De,convex_poly_ray:Fe,convex_poly_segment:We,convex_poly_ray_exclusive:function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Le(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var l=1;l<r.length;l+=1)if(!Be(r[0],r[l]))return[r[0],r[l]];}}}),Qe=function(e,t){for(;0>e;)e+=2*m;for(;0>t;)t+=2*m;var n=t-e;return 0<=n?n:2*m-(e-t)},Me=function(e,t){var n=e[0]*t[0]+e[1]*t[1],i=e[0]*t[1]-e[1]*t[0],r=k(i,n);return 0>r&&(r+=2*m),r},Ke=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.map(function(e){return k(e[1],e[0])}),r=Array.from(Array(i.length)).map(function(e,t){return t}).sort(function(e,t){return i[e]-i[t]});return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},Ge=function(e,t){var n=w(e),r=w(t),i=n.map(function(e,t){return n[t]+r[t]}),l=w(i),o=n.map(function(e,t){return-n[t]+-r[t]});return[l,w(o)]},Xe=function(e,t,n){var r=Me(t,n)/e;return Array.from(Array(e-1)).map(function(e,n){return t+r*n})},Ye=function(e,t,n){var i=k(t[1],t[0]),r=k(n[1],n[0]);return Xe(e,i,r).map(function(e){return[v(e),u(e)]})},Ce=function(e){return .5*e.map(function(e,t,n){var i=n[(t+1)%n.length];return e[0]*i[1]-i[0]*e[1]}).reduce(function(e,t){return e+t},0)},$e=function(e){var t=1/(6*Ce(e));return e.map(function(e,t,n){var i=n[(t+1)%n.length],r=e[0]*i[1]-i[0]*e[1];return[(e[0]+i[0])*r,(e[1]+i[1])*r]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(e){return e*t})},Ue=function(e){var t=e[0].length,n=Array.from(Array(t)).map(function(){return 1/0}),r=Array.from(Array(t)).map(function(){return-Infinity});e.forEach(function(e){return e.forEach(function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)})});var l=r.map(function(e,t){return e-n[t]});return[n,l]},et=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,l=.5*(2*m/e),o=i/v(l);return Array.from(Array(Math.floor(e))).map(function(r,p){var i=-2*m*p/e+l,a=J(t+o*u(i),14),g=J(n+o*v(i),14);return[a,g]})},tt=function(e,t,n){for(var r,l=t.map(function(t,r){return{o:t,i:r,d:n(e,t)}}),o=1/0,a=0;a<l.length;a+=1)l[a].d<o&&(r=a,o=l[a].d);return r},nt=function(e,t,n,i){var r=4<arguments.length&&arguments[4]!==void 0?arguments[4]:ee,l=x(t[0],2)+x(t[1],2),o=[0,1].map(function(t,r){return n[r]-e[r]}),a=[0,1].map(function(t,r){return n[r]-e[r]}),p=[0,1].map(function(e,n){return t[n]*o[n]}).reduce(function(e,t){return e+t},0),g=i(p/l,r);return[0,1].map(function(n,r){return e[r]+t[r]*g})},it=function(e,t,n){var i=e.map(function(e,r){var i=ce(t,n,e);return{type:"v",point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var l=Ze(t,n,e,i[(r+1)%i.length]);return{type:"e",point:l,at_index:r}}).filter(function(e){return null!=e.point}),l=i.concat(r).sort(function(e,t){return f(e.point[0]-t.point[0])<ee?e.point[1]-t.point[1]:e.point[0]-t.point[0]});return console.log(l),e},rt=function(e,t,n){var i=e.map(function(e,r){var i=ce(t,n,e);return{point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var l=Ze(t,n,e,i[(r+1)%i.length]);return{point:l,at_index:r}}).filter(function(e){return null!=e.point});if(2==r.length){var l=r.slice().sort(function(e,t){return e.at_index-t.at_index}),o=e.slice(l[1].at_index+1).concat(e.slice(0,l[0].at_index+1));o.push(l[0].point),o.push(l[1].point);var a=e.slice(l[0].at_index+1,l[1].at_index+1);return a.push(l[1].point),a.push(l[0].point),[o,a]}if(1==r.length&&1==i.length){i[0].type="v",r[0].type="e";var p=i.concat(r).sort(function(e,t){return e.at_index-t.at_index}),g=e.slice(p[1].at_index+1).concat(e.slice(0,p[0].at_index+1));"e"===p[0].type&&g.push(p[0].point),g.push(p[1].point);var c=e.slice(p[0].at_index+1,p[1].at_index+1);return"e"===p[1].type&&c.push(p[1].point),c.push(p[0].point),[g,c]}if(2==i.length){var y=i.slice().sort(function(e,t){return e.at_index-t.at_index}),_=e.slice(y[1].at_index).concat(e.slice(0,y[0].at_index+1)),d=e.slice(y[0].at_index,y[1].at_index+1);return[_,d]}return[e.slice()]},lt=function(t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:ee,i=t.slice().sort(function(e,t){return f(e[1]-t[1])<n?e[0]-t[0]:e[1]-t[1]}),r=[];r.push(i[0]);var l=0,o=0,a=function(){o+=1;var e=r.length-1,t=i.filter(function(t){return!(f(t[0]-r[e][0])<n&&f(t[1]-r[e][1])<n)}).map(function(t){for(var n=k(r[e][1]-t[1],r[e][0]-t[0]);n<l;)n+=2*m;return{node:t,angle:n,distance:void 0}}).sort(function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0});if(0===t.length)return{v:void 0};var a=t[0];return t=t.filter(function(e){return f(a.angle-e.angle)<n}).map(function(t){var n=P(x(r[e][0]-t.node[0],2)+x(r[e][1]-t.node[1],2));return t.distance=n,t}).sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0}),0<r.filter(function(e){return e===t[0].node}).length?{v:r}:void(r.push(t[0].node),l=k(r[e][1]-t[0].node[1],r[e][0]-t[0].node[0]))};do{var p=a();if("object"===e(p))return p.v}while(o<1e4)},ot=/*#__PURE__*/Object.freeze({clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*m;for(;0>t;)t+=2*m;var n=e-t;return 0<=n?n:2*m-(t-e)},counter_clockwise_angle2_radians:Qe,clockwise_angle2:function(e,t){var n=t[0]*e[0]+t[1]*e[1],i=t[0]*e[1]-t[1]*e[0],r=k(i,n);return 0>r&&(r+=2*m),r},counter_clockwise_angle2:Me,counter_clockwise_vector_order:Ke,interior_angles2:function(e,t){var n=Me(e,t);return[n,2*m-n]},interior_angles:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e,t,n){return Me(e,n[(t+1)%n.length])})},bisect_vectors:Ge,bisect_lines2:function(e,n,i,r){var l=n[0]*r[1]-r[0]*n[1];if(f(l)<ee){var o=[S(e,i),[n[0],n[1]]],a=[o,o],p=n[0]*r[0]+n[1]*r[1];return delete(0<p?a[1]:a[0]),a}var g=(i[0]-e[0])*r[1]-r[0]*(i[1]-e[1]),c=g/l,t=e[0]+n[0]*c,_=e[1]+n[1]*c,y=Ge(n,r);return y[1]=[y[1][1],-y[1][0]],y.map(function(e){return[[t,_],e]})},subsect_radians:Xe,subsect:Ye,signed_area:Ce,centroid:$e,enclosing_rectangle:Ue,make_regular_polygon:et,nearest_point2:function(e,t){var n=tt(e,t,I);return n===void 0?void 0:t[n]},nearest_point:function(e,t){var n=tt(e,t,R);return n===void 0?void 0:t[n]},nearest_point_on_line:nt,split_polygon:it,split_convex_polygon:rt,convex_hull:lt}),at=function(e){var t,i=[],r=e,l=function(){return r(w(t))},o=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n);return this.length>r.length?z(r,t):z(t,r)},a=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=G(n),o=t.slice();return null==o[2]&&(o[2]=0),null==l[2]&&(l[2]=0),r(E(o,l))},p=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n),l=t.length<r.length?t.length:r.length,o=Array.from(Array(l)).map(function(e,n){return x(t[n]-r[n],2)}).reduce(function(e,t){return e+t},0);return P(o)},g=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=$(n);return r(A(t,l))},y=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=G(n);return r(t.map(function(e,t){return e+l[t]}))},_=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=G(n);return r(t.map(function(e,t){return e-l[t]}))},d=function(e,n){var i=T(e,n);return r(A(t,i))},h=function(){return r(-t[1],t[0])},s=function(){return r(-t[0],-t[1])},m=function(){return r(t[1],-t[0])},f=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=c(n),o=O(l.vector,l.point);return r(A(t,o))},u=function(e,n){var l=G(e),o=t.length<l.length?t.length:l.length,a=Array.from(Array(o)).map(function(e,r){return t[r]*n+l[r]*(1-n)});return r(a)},v=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n),l=t.length<r.length?t:r,o=t.length<r.length?r:t;return ie(l,o)},k=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n),l=t.length<r.length?t:r,o=t.length<r.length?r:t;return ge(l,o)},j=function(e){return r(t.map(function(t){return t*e}))},I=function(){for(var e=arguments.length,n=Array(e),l=0;l<e;l++)n[l]=arguments[l];for(var o=G(n),a=t.length<o.length?t.slice():o,p=t.length<o.length?o:t.slice(),g=a.length;g<p.length;g+=1)a[g]=0;return r(p.map(function(e,t){return .5*(a[t]+p[t])}))},R=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var l=G(n);return Ge(t,l).map(function(e){return r(e)})};return Object.defineProperty(i,"normalize",{value:l}),Object.defineProperty(i,"dot",{value:o}),Object.defineProperty(i,"cross",{value:a}),Object.defineProperty(i,"distanceTo",{value:p}),Object.defineProperty(i,"transform",{value:g}),Object.defineProperty(i,"add",{value:y}),Object.defineProperty(i,"subtract",{value:_}),Object.defineProperty(i,"rotateZ",{value:d}),Object.defineProperty(i,"rotateZ90",{value:h}),Object.defineProperty(i,"rotateZ180",{value:s}),Object.defineProperty(i,"rotateZ270",{value:m}),Object.defineProperty(i,"reflect",{value:f}),Object.defineProperty(i,"lerp",{value:u}),Object.defineProperty(i,"isEquivalent",{value:v}),Object.defineProperty(i,"isParallel",{value:k}),Object.defineProperty(i,"scale",{value:j}),Object.defineProperty(i,"midpoint",{value:I}),Object.defineProperty(i,"bisect",{value:R}),Object.defineProperty(i,"copy",{value:function(){return r.apply(void 0,n(t))}}),Object.defineProperty(i,"magnitude",{get:function(){return b(t)}}),Object.defineProperty(i,"bind",{value:function(e){t=e}}),i},pt=function e(){var t=at(e),n=Object.create(t);t.bind(n);for(var i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];return G(r).forEach(function(e){return n.push(e)}),Object.defineProperty(n,"x",{get:function(){return n[0]}}),Object.defineProperty(n,"y",{get:function(){return n[1]}}),Object.defineProperty(n,"z",{get:function(){return n[2]}}),n},gt=function e(){for(var t=[1,0,0,1,0,0],n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var l=$(i);void 0!==l&&l.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"inverse",{value:function(){return e(H(t).map(function(e){return J(e,13)}))}}),Object.defineProperty(t,"multiply",{value:function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var l=$(i);return e(Z(t,l).map(function(e){return J(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n);return pt(A(r,t).map(function(e){return J(e,13)}))}}),Object.freeze(t)};gt.makeIdentity=function(){return gt(1,0,0,1,0,0)},gt.makeTranslation=function(e,t){return gt(1,0,0,1,e,t)},gt.makeScale=function(){return gt.apply(void 0,n(L.apply(void 0,arguments)))},gt.makeRotation=function(e,t){return gt(T(e,t).map(function(e){return J(e,13)}))},gt.makeReflection=function(e,t){return gt(O(e,t).map(function(e){return J(e,13)}))};var ct=function e(){for(var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var l=U(i);void 0!==l&&l.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"inverse",{value:function(){return e(D(t).map(function(e){return J(e,13)}))}}),Object.defineProperty(t,"multiply",{value:function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var l=U(i);return e(F(t,l).map(function(e){return J(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=G(n);return pt(N(r,t).map(function(e){return J(e,13)}))}}),Object.freeze(t)};ct.makeIdentity=function(){return ct(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},ct.makeTranslation=function(e,t,n){return ct(1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1)},ct.makeScale=function(){return ct.apply(void 0,n(B.apply(void 0,arguments)))};var yt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=c(n),l=r.point,o=r.vector,a=h.bind(this),p=Object.create(a(e));return Object.defineProperty(p,"compare_function",{value:function(){return!0}}),Object.defineProperty(p,"clip_function",{value:Ie}),Object.defineProperty(p,"point",{get:function(){return pt(l)}}),Object.defineProperty(p,"vector",{get:function(){return pt(o)}}),Object.defineProperty(p,"length",{get:function(){return 1/0}}),Object.defineProperty(p,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=$(n),a=V(l,o,r);return e(a[0],a[1])}}),p};yt.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=_(t);return yt({point:i[0],vector:w([i[1][0]-i[0][0],i[1][1]-i[0][1]])})},yt.perpendicularBisector=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=_(t),r=w([i[1][0]-i[0][0],i[1][1]-i[0][1]]);return yt({point:j(i[0],i[1]),vector:[r[1],-r[0]]})};var _t=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=c(n),l=r.point,o=r.vector,a=h.bind(this),p=Object.create(a(e));return Object.defineProperty(p,"point",{get:function(){return pt(l)}}),Object.defineProperty(p,"vector",{get:function(){return pt(o)}}),Object.defineProperty(p,"length",{get:function(){return 1/0}}),Object.defineProperty(p,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=$(n),a=A(l,r),p=o.map(function(e,t){return e+l[t]}),g=A(p,r).map(function(e,t){return e-a[t]});return e(a,g)}}),Object.defineProperty(p,"rotate180",{value:function(){return e(l[0],l[1],-o[0],-o[1])}}),Object.defineProperty(p,"compare_function",{value:function(e,t){return e>=-t}}),Object.defineProperty(p,"clip_function",{value:Re}),p};_t.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=_(t);return _t({point:i[0],vector:w([i[1][0]-i[0][0],i[1][1]-i[0][1]])})};var dt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=_(n),l=h.bind(this),o=Object.create(l(e,[])),a=0<r.length?r.map(function(e){return pt(e)}):void 0;if(void 0!==a){a.forEach(function(e,t){o[t]=e});var p=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=$(n),l=o.map(function(e){return A(e,r)});return e(l)},g=function(){return pt(o[1][0]-o[0][0],o[1][1]-o[0][1])},c=function(){return pt(j(o[0],o[1]))},y=function(){return P(x(o[1][0]-o[0][0],2)+x(o[1][1]-o[0][1],2))},d=function(e,t){return e>=-t&&e<=1+t};return Object.defineProperty(o,"point",{get:function(){return o[0]}}),Object.defineProperty(o,"vector",{get:function(){return g()}}),Object.defineProperty(o,"midpoint",{value:c}),Object.defineProperty(o,"length",{get:function(){return y()}}),Object.defineProperty(o,"transform",{value:p}),Object.defineProperty(o,"compare_function",{value:d}),Object.defineProperty(o,"clip_function",{value:Se}),o}},ht=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],l=[G(e),G(t)];return{contains:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=G(t).map(function(e,t){return e+r[t]}),o=(i[1]-l[0][1])*-l[0][0]-(i[0]-l[0][0])*-l[0][1],a=i[1]*l[1][0]-i[0]*l[1][1];return 0>o&&0>a},bisect:function(){var e=Me(l[0],l[1]),t=l.map(function(e){return k(e[1],e[0])}),n=t[0]+.5*e;return[v(n),u(n)]},subsect:function(e){return Ye(e,l[0],l[1]).map(function(e){return[e[0],e[1]]})},get center(){return r},get vectors(){return l},get angle(){return Me(l[0],l[1])}}};ht.fromVectors=function(e,t){return ht(e,t)},ht.fromPoints=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],i=[e,t].map(function(e){return e.map(function(t,r){return e[r]-n[r]})});return ht(i[0],i[1],n)};var st=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=X(t).map(function(e){return pt(e)});if(void 0!==i){var r=i.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return dt(e[0][0],e[0][1],e[1][0],e[1][1])}),l=s.bind(this),o=Object.create(l());return Object.defineProperty(o,"points",{get:function(){return i}}),Object.defineProperty(o,"sides",{get:function(){return r}}),o}};st.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=et(e,t,n,i);return st(r)},st.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=lt(e,t);return st(n)};var mt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=d(n).map(function(e){return pt(e)});if(void 0!==r){var l=r.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return dt(e[0][0],e[0][1],e[1][0],e[1][1])}),o=s.bind(this),a=Object.create(o(e)),p=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var l=c(n);return rt(r,l.point,l.vector).map(function(t){return e(t)})},g=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=d(t);return he(r,i)},y=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:$e(a.points),i=a.points.map(function(e){return[0,1].map(function(t,r){return e[r]-n[r]})}).map(function(e){return e.map(function(r,l){return n[l]+e[l]*t})});return e(i)},_=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:$e(a.points),i=a.points.map(function(e){var i=[e[0]-n[0],e[1]-n[1]],r=P(x(i[0],2)+x(i[1],2)),l=k(i[1],i[0]);return[n[0]+v(l+t)*r,n[1]+u(l+t)*r]});return e(i)};return Object.defineProperty(a,"points",{get:function(){return r}}),Object.defineProperty(a,"sides",{get:function(){return l}}),Object.defineProperty(a,"split",{value:p}),Object.defineProperty(a,"overlaps",{value:g}),Object.defineProperty(a,"scale",{value:y}),Object.defineProperty(a,"rotate",{value:_}),a}};mt.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=et(e,t,n,i);return mt(r)},mt.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=lt(e,t);return mt(n)};var ft=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return[0,1].map(function(e){return t.filter(function(t,n){return n%2===e}).reduce(function(e,t){return e+t},0)})},ut=function(){return ft.apply(void 0,arguments).map(function(e){return 0>e?e+2*m:e}).map(function(e){return m-e})},vt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(function(e,t,n){return Qe(e,n[(t+1)%n.length])}).map(function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))}).map(function(e){return ut.apply(void 0,n(e))}).map(function(e,n){return t[n]+e[0]}).map(function(e,n){return se(e,t[n],t[(n+1)%t.length])?e:void 0})},kt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=X(t);if(void 0!==r){var l=Ke.apply(void 0,n(r)),o=function(){return l.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return ht.fromVectors(e[0],e[1])})},a=function(){return l.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Me(e[0],e[1])})},p=function(){return ft.apply(void 0,n(a()))},g=function(){return ut.apply(void 0,n(a()))},c=function(){return vt.apply(void 0,n(a()))};return{sectors:o,angles:a,kawasaki_score:g,kawasaki_solutions:c,alternatingAngleSum:p,get vectors(){return r},get vectorOrder(){return n(l)}}}};kt.fromVectors=function(){return kt.apply(void 0,arguments)},kt.fromPoints=function(e,t){var n=t.map(function(t){return t.map(function(n,r){return t[r]-e[r]})});return kt.fromVectors(n)};var Pt=Object.create(null);Object.assign(Pt,q,W,ot,me,re),Pt.clean_number=J,Pt.is_number=function(e){return null!=e&&!isNaN(e)},Pt.is_vector=function(e){return null!=e&&null!=e[0]&&!isNaN(e[0])},Pt.is_iterable=Q,Pt.flatten_input=M,Pt.semi_flatten_input=K,Pt.get_vector=G,Pt.get_vector_of_vectors=X,Pt.get_matrix2=$,Pt.get_segment=g,Pt.get_line=c,Pt.get_ray=y,Pt.get_two_vec2=_,Pt.get_array_of_vec=d,Pt.get_array_of_vec2=function(){var e=Array.from(arguments),t=e.filter(function(e){return e.constructor===Array});return 2<=t.length&&!isNaN(t[0][0])?t:1===t.length&&1<=t[0].length?t[0]:e},Pt.intersection=Je,Object.freeze(Pt);return{vector:pt,matrix2:gt,matrix:ct,line:yt,ray:_t,segment:dt,circle:function(){for(var e,n,i=arguments.length,r=Array(i),l=0;l<i;l++)r[l]=arguments[l];var o=Array.from(r),a=o.filter(function(e){return!isNaN(e)});if(3===a.length){e=pt(a[0],a[1]);var p=t(a,3);n=p[2]}var g=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var l=c(i),o=[l.point[0]+l.vector[0],l.point[1]+l.vector[1]],a=Oe(e,n,l.point,o);return a===void 0?void 0:a.map(function(e){return pt(e)})},d=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var l=y(i),o=He(e,n,l[0],l[1]);return o===void 0?void 0:o.map(function(e){return pt(e)})},h=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var l=_(i),o=Ne(e,n,l[0],l[1]);return o===void 0?void 0:o.map(function(e){return pt(e)})};return{intersectionLine:g,intersectionRay:d,intersectionSegment:h,get origin(){return e},get radius(){return n},set origin(t){e=pt(t)},set radius(e){n=e}}},polygon:st,convexPolygon:mt,rectangle:function e(){for(var n,i,r,l=arguments.length,o=Array(l),a=0;a<l;a++)o[a]=arguments[a];var p=Array.from(o),g=p.filter(function(e){return!isNaN(e)}),c=p.filter(function(e){return e.constructor===Array});if(4===g.length){n=g.slice(0,2);var y=t(g,4);i=y[2],r=y[3]}1===c.length&&(c=c[0]),2===c.length&&"number"==typeof c[0][0]&&(n=c[0].slice(),i=c[1][0],r=c[1][1]);var _=[[n[0],n[1]],[n[0]+i,n[1]],[n[0]+i,n[1]+r],[n[0],n[1]+r]],d=s.bind(this),h=Object.create(d(e)),m=function(t,l){var o=null==l?[n[0]+i,n[1]+r]:l,a=n[0]+(o[0]-n[0])*(1-t),p=n[1]+(o[1]-n[1])*(1-t);return e(a,p,i*t,r*t)};return Object.defineProperty(h,"origin",{get:function(){return n}}),Object.defineProperty(h,"width",{get:function(){return i}}),Object.defineProperty(h,"height",{get:function(){return r}}),Object.defineProperty(h,"area",{get:function(){return i*r}}),Object.defineProperty(h,"scale",{value:m}),Object.defineProperty(h,"rotate",{value:function(){var e;return(e=mt(_)).rotate.apply(e,arguments)}}),Object.defineProperty(h,"transform",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return mt(_).transform(t)}}),h},junction:kt,sector:ht,core:Pt}});
