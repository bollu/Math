!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self).math=t()}(this,(function(){"use strict";var n=function(n){var t=n.map((function(n){return n*n})).reduce((function(n,t){return n+t}),0);return Math.sqrt(t)},t=function(t){var r=n(t);return 0===r?t:t.map((function(n){return n/r}))},r=function(n,t){return n.map((function(r,e){return n[e]*t[e]})).reduce((function(n,t){return n+t}),0)},e=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=t.length>0?t[0].length:0,i=Array(e).fill(0);return t.forEach((function(n){return i.forEach((function(t,r){i[r]+=n[r]||0}))})),i.map((function(n){return n/t.length}))},i=function(n,t){return[n[1]*t[2]-n[2]*t[1],n[0]*t[2]-n[2]*t[0],n[0]*t[1]-n[1]*t[0]]},o=function(n,t){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)},u=function(n,t){for(var r=n.length,e=0,i=0;i<r;i+=1)e+=Math.pow(n[i]-t[i],2);return Math.sqrt(e)},a=function(n,t){return n.map((function(r,e){return(n[e]+t[e])/2}))},c=Object.freeze({__proto__:null,magnitude:n,normalize:t,dot:r,average:e,cross2:function(n,t){return[n[0]*t[1],n[1]*t[0]]},cross3:i,distance2:o,distance3:function(n,t){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(r*r+e*e+i*i)},distance:u,midpoint2:a}),f=function(n,t){return[n[0]*t[0]+n[2]*t[1]+n[4],n[1]*t[0]+n[3]*t[1]+n[5]]},l=function(n,t,r){return{origin:[n[0]*t[0]+n[2]*t[1]+n[4],n[1]*t[0]+n[3]*t[1]+n[5]],vector:[n[0]*r[0]+n[2]*r[1],n[1]*r[0]+n[3]*r[1]]}},v=function(n,t){return[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1],n[0]*t[2]+n[2]*t[3],n[1]*t[2]+n[3]*t[3],n[0]*t[4]+n[2]*t[5]+n[4],n[1]*t[4]+n[3]*t[5]+n[5]]},s=function(n){return n[0]*n[3]-n[1]*n[2]},h=function(n){var t=s(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[4])&&isFinite(n[5]))return[n[3]/t,-n[1]/t,-n[2]/t,n[0]/t,(n[2]*n[5]-n[3]*n[4])/t,(n[1]*n[4]-n[0]*n[5])/t]},p=function(n,t){return[1,0,0,1,n,t]},g=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[n,0,0,t,n*-r[0]+r[0],t*-r[1]+r[1]]},m=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(n),e=Math.sin(n);return[r,e,-e,r,t[0],t[1]]},d=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,l=i*-u+-e*o,v=t[0]+a*-t[0]+-t[1]*f,s=t[1]+c*-t[0]+-t[1]*l;return[a,c,f,l,v,s]},y=Object.freeze({__proto__:null,multiply_matrix2_vector2:f,multiply_matrix2_line2:l,multiply_matrices2:v,matrix2_determinant:s,invert_matrix2:h,make_matrix2_translate:p,make_matrix2_scale:g,make_matrix2_rotate:m,make_matrix2_reflection:d});function b(n){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function _(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var r=[],e=!0,i=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(e=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);e=!0);}catch(n){i=!0,o=n}finally{try{e||null==a.return||a.return()}finally{if(i)throw o}}return r}(n,t)||j(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(n){return function(n){if(Array.isArray(n))return O(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||j(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(n,t){if(n){if("string"==typeof n)return O(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(n,t):void 0}}function O(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=new Array(t);r<t;r++)e[r]=n[r];return e}var P=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2]+n[9],n[1]*t[0]+n[4]*t[1]+n[7]*t[2]+n[10],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]+n[11]]},w=function(n,t,r){return{origin:[n[0]*t[0]+n[3]*t[1]+n[6]*t[2]+n[9],n[1]*t[0]+n[4]*t[1]+n[7]*t[2]+n[10],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]+n[11]],vector:[n[0]*r[0]+n[3]*r[1]+n[6]*r[2],n[1]*r[0]+n[4]*r[1]+n[7]*r[2],n[2]*r[0]+n[5]*r[1]+n[8]*r[2]]}},A=function(n,t){return[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2],n[0]*t[3]+n[3]*t[4]+n[6]*t[5],n[1]*t[3]+n[4]*t[4]+n[7]*t[5],n[2]*t[3]+n[5]*t[4]+n[8]*t[5],n[0]*t[6]+n[3]*t[7]+n[6]*t[8],n[1]*t[6]+n[4]*t[7]+n[7]*t[8],n[2]*t[6]+n[5]*t[7]+n[8]*t[8],n[0]*t[9]+n[3]*t[10]+n[6]*t[11]+n[9],n[1]*t[9]+n[4]*t[10]+n[7]*t[11]+n[10],n[2]*t[9]+n[5]*t[10]+n[8]*t[11]+n[11]]},x=function(n){return n[0]*n[4]*n[8]-n[0]*n[7]*n[5]-n[3]*n[1]*n[8]+n[3]*n[7]*n[2]+n[6]*n[1]*n[5]-n[6]*n[4]*n[2]},k=function(n){var t=x(n);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(n[9])&&isFinite(n[10])&&isFinite(n[11])){var r=[n[4]*n[8]-n[7]*n[5],-n[1]*n[8]+n[7]*n[2],n[1]*n[5]-n[4]*n[2],-n[3]*n[8]+n[6]*n[5],n[0]*n[8]-n[6]*n[2],-n[0]*n[5]+n[3]*n[2],n[3]*n[7]-n[6]*n[4],-n[0]*n[7]+n[6]*n[1],n[0]*n[4]-n[3]*n[1],-n[3]*n[7]*n[11]+n[3]*n[8]*n[10]+n[6]*n[4]*n[11]-n[6]*n[5]*n[10]-n[9]*n[4]*n[8]+n[9]*n[5]*n[7],n[0]*n[7]*n[11]-n[0]*n[8]*n[10]-n[6]*n[1]*n[11]+n[6]*n[2]*n[10]+n[9]*n[1]*n[8]-n[9]*n[2]*n[7],-n[0]*n[4]*n[11]+n[0]*n[5]*n[10]+n[3]*n[1]*n[11]-n[3]*n[2]*n[10]-n[9]*n[1]*n[5]+n[9]*n[2]*n[4]],e=1/t;return r.map((function(n){return n*e}))}},N=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[1,0,0,0,1,0,0,0,1,n,t,r]},q=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(n),e=Math.sin(n);return[1,0,0,0,r,e,0,-e,r,t[0]||0,t[1]||0,t[2]||0]},S=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(n),e=Math.sin(n);return[r,0,-e,0,1,0,e,0,r,t[0]||0,t[1]||0,t[2]||0]},E=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(n),e=Math.sin(n);return[r,e,0,-e,r,0,0,0,1,t[0]||0,t[1]||0,t[2]||0]},I=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=t(r),o=Array.from(Array(3)).map((function(n,t){return e[t]||0})),u=_(i,3),a=u[0],c=u[1],f=u[2],l=Math.cos(n),v=Math.sin(n),s=Math.sqrt(i[1]*i[1]+i[2]*i[2]),h=Math.abs(s)<1e-6?0:c/s,p=Math.abs(s)<1e-6?1:f/s,g=[1,0,0,0,1,0,0,0,1,o[0],o[1],o[2]],m=[1,0,0,0,1,0,0,0,1,-o[0],-o[1],-o[2]],d=[1,0,0,0,p,h,0,-h,p,0,0,0],y=[1,0,0,0,p,-h,0,h,p,0,0,0],b=[s,0,a,0,1,0,-a,0,s,0,0,0],M=[s,0,-a,0,1,0,a,0,s,0,0,0],j=[l,v,0,-v,l,0,0,0,1,0,0,0];return A(m,A(y,A(M,A(j,A(b,A(d,g))))))},z=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[n,0,0,0,n,0,0,0,n,n*-t[0]+t[0],n*-t[1]+t[1],n*-t[2]+t[2]]},R=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(n[1],n[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,l=i*-u+-e*o,v=t[0]+a*-t[0]+-t[1]*f,s=t[1]+c*-t[0]+-t[1]*l;return[a,c,0,f,l,0,0,0,0,v,s,0]},Z=Object.freeze({__proto__:null,multiply_matrix3_vector3:P,multiply_matrix3_line3:w,multiply_matrices3:A,matrix3_determinant:x,invert_matrix3:k,make_matrix3_translate:N,make_matrix3_rotateX:q,make_matrix3_rotateY:S,make_matrix3_rotateZ:E,make_matrix3_rotate:I,make_matrix3_scale:z,make_matrix3_reflectionZ:R}),F=function(n){if("object"===b(n)){if(null!=n.radius)return"circle";if(null!=n.width)return"rectangle";if(null!=n.x)return"vector";if(null!=n.rotate180)return"ray";if(null!=n[0]&&n[0].length&&null!=n[0].x)return"segment";if(null!=n.vector&&null!=n.origin)return"line"}},L=function(n){var t="".concat(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},T=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof n)return n;var r=parseFloat(n.toFixed(t));return L(r)===Math.min(t,L(n))?n:r},V=function(n){return null!=n&&"function"==typeof n[Symbol.iterator]},J=function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];switch(r.length){case void 0:case 0:return r;case 1:return V(r[0])&&"string"!=typeof r[0]?n.apply(void 0,M(r[0])):[r[0]];default:return Array.from(r).map((function(t){return V(t)?M(n(t)):t})).reduce((function(n,t){return n.concat(t)}),[])}},X=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];for(var e=t;1===e.length&&"object"===b(e[0])&&e[0].length;){var i=e,o=_(i,1);e=o[0]}return e},Y=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=J(t).filter((function(n){return void 0!==n}));if(void 0!==e&&0!==e.length)return isNaN(e[0].x)||(e=["x","y","z"].map((function(n){return e[0][n]})).filter((function(n){return void 0!==n}))),e.filter((function(n){return"number"==typeof n}))},C=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return X(t).map((function(n){return Y(n)}))},H=[1,0,0,1,0,0],$=[1,0,0,0,1,0,0,0,1,0,0,0],B=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=Y(t);if(void 0!==e)return 6===e.length?e:e.length>6?[e[0],e[1],e[2],e[3],e[4],e[5]]:e.length<6?H.map((function(n,t){return e[t]||n})):void 0},D=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=Y(t);if(void 0!==e){switch(e.length){case 4:return[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,0,0,0,1];case 6:return[e[0],e[1],0,e[2],e[3],0,0,0,1,e[4],e[5],0];case 9:return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],0,0,0];case 12:return e;case 16:return[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]}return e.length>12?[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]:e.length<12?$.map((function(n,t){return e[t]||n})):void 0}};function U(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return C(t)}function G(){var n=Array.from(arguments),t=n.filter((function(n){return!isNaN(n)})),r=n.filter((function(n){return n.constructor===Array}));if(0===n.length)return{vector:[],origin:[]};if(!isNaN(n[0])&&t.length>=4)return{origin:[n[0],n[1]],vector:[n[2],n[3]]};if(r.length>0){if(1===r.length)return G.apply(void 0,M(r[0]));if(2===r.length)return{origin:[r[0][0],r[0][1]],vector:[r[1][0],r[1][1]]};if(4===r.length)return{origin:[r[0],r[1]],vector:[r[2],r[3]]}}if(n[0].constructor===Object){var e=[],i=[];return null!=n[0].vector?e=Y(n[0].vector):null!=n[0].direction&&(e=Y(n[0].direction)),null!=n[0].origin?i=Y(n[0].origin):null!=n[0].point&&(i=Y(n[0].point)),{origin:i,vector:e}}return{origin:[],vector:[]}}function K(){return G.apply(void 0,arguments)}function Q(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];if(0!==t.length)return 1===t.length&&void 0!==t[0]?Q.apply(void 0,M(t[0])):Array.from(t)}var W=Object.freeze({__proto__:null,Typeof:F,clean_number:T,is_number:function(n){return null!=n&&!isNaN(n)},is_vector:function(n){return null!=n&&null!=n[0]&&!isNaN(n[0])},is_iterable:V,flatten_input:J,semi_flatten_input:X,get_vector:Y,get_vector_of_vectors:C,get_matrix2:B,get_matrix3:D,get_segment:U,get_line:G,get_ray:K,get_two_vec2:function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];if(0!==r.length){if(1===r.length&&void 0!==r[0])return n.apply(void 0,M(r[0]));var i=Array.from(r),o=i.filter((function(n){return!isNaN(n)})),u=i.filter((function(n){return"object"===b(n)})).filter((function(n){return n.constructor===Array}));return o.length>=4?[[o[0],o[1]],[o[2],o[3]]]:u.length>=2&&!isNaN(u[0][0])?u:1!==u.length||isNaN(u[0][0][0])?void 0:u[0]}},get_array_of_vec:Q,get_array_of_vec2:function(){var n=Array.from(arguments),t=n.filter((function(n){return n.constructor===Array}));return t.length>=2&&!isNaN(t[0][0])?t:1===t.length&&t[0].length>=1?t[0]:n}}),nn=1e-6,tn=function(n,t){return Array.from(Array(n.length-1)).map((function(r,e){return t(n[0],n[e+1])})).reduce((function(n,t){return n&&t}),!0)},rn=function n(){var t=C.apply(void 0,arguments);if(0===t.length)return!1;if(1===t.length&&void 0!==t[0])return n.apply(void 0,M(t[0]));for(var r=t[0].length,e=Array.from(Array(r)),i=1;i<t.length;i+=1)if(b(t[i-1])!==b(t[i]))return!1;return Array.from(Array(t.length-1)).map((function(n,r){return e.map((function(n,e){return Math.abs(t[r][e]-t[r+1][e])<nn})).reduce((function(n,t){return n&&t}),!0)})).reduce((function(n,t){return n&&t}),!0)&&Array.from(Array(t.length-1)).map((function(n,r){return t[0].length===t[r+1].length})).reduce((function(n,t){return n&&t}),!0)},en=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=X(t);if(e.length<1)return!1;var i=b(e[0]);if("undefined"===i)return!1;switch(e[0].constructor===Array&&(e=e.map((function(n){return X(n)}))),i){case"number":return tn(e,(function(n,t){return Math.abs(n-t)<nn}));case"boolean":case"string":return tn(e,(function(n,t){return n===t}));case"object":return e[0].constructor===Array?rn.apply(void 0,M(e)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),tn(e,(function(n,t){return JSON.stringify(n)===JSON.stringify(t)})));default:console.warn("incapable of determining comparison method")}return!1},on=Object.freeze({__proto__:null,EPSILON:nn,equivalent_numbers:function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return 0!==r.length&&(1===r.length&&void 0!==r[0]?n.apply(void 0,M(r[0])):tn(r,(function(n,t){return Math.abs(n-t)<nn})))},equivalent_vectors:rn,equivalent:en}),un=function(n,t,r,e,i){var o=function(n,t){return n[0]*t[1]-t[0]*n[1]},u=o(t,e),a=-u,c=o([r[0]-n[0],r[1]-n[1]],e),f=o([n[0]-r[0],n[1]-r[1]],t);return!(Math.abs(u)<nn)&&i(c/u,f/a)},an=function(n,t){return n>=-nn&&n<=1+nn&&t>=-nn&&t<=1+nn},cn=function(n,t,r,e){var i=[t[0]-n[0],t[1]-n[1]],o=[e[0]-r[0],e[1]-r[1]];return un(n,i,r,o,an)},fn=function(n){return Math.abs(n.reduce((function(n,t){return n+t}),0))<nn},ln=function(n,e){return 1-Math.abs(r(t(n),t(e)))<nn},vn=function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nn,i=[r[0]-n[0],r[1]-n[1]],o=i[0]*t[1]-i[1]*t[0];return Math.abs(o)<e},sn=function(n,t){for(var r=!1,e=0,i=t.length-1;e<t.length;i=e++)t[e][1]>n[1]!=t[i][1]>n[1]&&n[0]<(t[i][0]-t[e][0])*(n[1]-t[e][1])/(t[i][1]-t[e][1])+t[e][0]&&(r=!r);return r},hn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return null!=t&&t.length>0&&t.map((function(t,e,i){var o=i[(e+1)%i.length],u=[o[0]-t[0],o[1]-t[1]],a=[n[0]-t[0],n[1]-t[1]];return u[0]*a[1]-u[1]*a[0]>-r})).map((function(n,t,r){return n===r[0]})).reduce((function(n,t){return n&&t}),!0)},pn=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return null!=t&&t.length>0&&t.map((function(t,e,i){var o=i[(e+1)%i.length],u=[o[0]-t[0],o[1]-t[1]],a=[n[0]-t[0],n[1]-t[1]];return u[0]*a[1]-u[1]*a[0]>r})).map((function(n,t,r){return n===r[0]})).reduce((function(n,t){return n&&t}),!0)},gn=function(n,t){for(var r=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),e=t.map((function(n,t,r){return[n,r[(t+1)%r.length]]})),i=0;i<r.length;i+=1)for(var o=0;o<e.length;o+=1)if(cn(r[i][0],r[i][1],e[o][0],e[o][1]))return!0;return!!sn(t[0],n)||!!sn(n[0],t)},mn=Object.freeze({__proto__:null,overlap_function:un,segment_segment_overlap:cn,degenerate:fn,parallel:ln,point_on_line:vn,point_on_segment:function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nn,i=[n[0]-t[0],n[1]-t[1]],o=[n[0]-r[0],n[1]-r[1]],u=[t[0]-r[0],t[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),c=Math.sqrt(o[0]*o[0]+o[1]*o[1]),f=Math.sqrt(u[0]*u[0]+u[1]*u[1]);return Math.abs(a-c-f)<e},point_in_poly:sn,point_in_convex_poly:hn,point_in_convex_poly_exclusive:pn,convex_polygons_overlap:gn,convex_polygon_is_enclosed:function(n,t){if(t.map((function(t){return hn(t,n)})).reduce((function(n,t){return n||t}),!1))return!1},convex_polygons_enclose:function(n,t){var r=t.map((function(t){return hn(t,n)})).reduce((function(n,t){return n||t}),!1),e=n.map((function(t){return hn(t,n)})).reduce((function(n,t){return n&&t}),!0);return!r&&e},is_counter_clockwise_between:function(n,t,r){for(;r<t;)r+=2*Math.PI;for(;n<t;)n+=2*Math.PI;return n<r}}),dn=function(){return!0},yn=function(n,t){return t>=-nn},bn=function(n,t){return t>=-nn&&t<=1+nn},_n=function(n,t){return n>=-nn&&t>=-nn},Mn=function(n,t){return n>=-nn&&t>=-nn&&t<=1+nn},jn=function(n,t){return n>=-nn&&n<=1+nn&&t>=-nn&&t<=1+nn},On=function(n,t){return t>nn},Pn=function(n,t){return t>nn&&t<1-nn},wn=function(n,t){return n>nn&&t>nn},An=function(n,t){return n>nn&&t>nn&&t<1-nn},xn=function(n,t){return n>nn&&n<1-nn&&t>nn&&t<1-nn},kn=function(n){return n},Nn=function(n){return n<-nn?0:n},qn=function(n){return n<-nn?0:n>1+nn?1:n},Sn=function(n,t,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:nn;function u(n,t){return n[0]*t[1]-t[0]*n[1]}var a=u(t,e);if(!(Math.abs(a)<o)){var c=-a,f=u([r[0]-n[0],r[1]-n[1]],e),l=u([n[0]-r[0],n[1]-r[1]],t),v=f/a,s=l/c;return i(v,s,o)?[n[0]+t[0]*v,n[1]+t[1]*v]:void 0}},En=function(n,t,r,e,i){return Sn(n,t,r,e,dn,i)},In=function(n,t,r,e,i){return Sn(n,t,r,e,yn,i)},zn=function(n,t,r,e,i){var o=[e[0]-r[0],e[1]-r[1]];return Sn(n,t,r,o,bn,i)},Rn=function(n,t,r,e,i){return Sn(n,t,r,e,_n,i)},Zn=function(n,t,r,e,i){var o=[e[0]-r[0],e[1]-r[1]];return Sn(n,t,r,o,Mn,i)},Fn=function(n,t,r,e,i){var o=[t[0]-n[0],t[1]-n[1]],u=[e[0]-r[0],e[1]-r[1]];return Sn(n,o,r,u,jn,i)},Ln=function(n,t,r,e,i){var o=[e[0]-r[0],e[1]-r[1]];return Sn(n,t,r,o,Pn,i)},Tn=function(n,t,r,e,i){var o=[e[0]-r[0],e[1]-r[1]];return Sn(n,t,r,o,An,i)},Vn=function(n,t,r,e,i){var o=[t[0]-n[0],t[1]-n[1]],u=[e[0]-r[0],e[1]-r[1]];return Sn(n,o,r,u,xn,i)},Jn=function(n){return n>=1?0:n<=-1?Math.PI:Math.acos(n)},Xn=function(n,t,r){var e=t[0]-n[0],i=t[1]-n[1],o=e*Math.cos(r)+i*Math.sin(r),u=i*Math.cos(r)-e*Math.sin(r);return[n[0]+o,n[1]+u]},Yn=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=t<e?t:e,u=t<e?e:t,a=t<e?n:r,c=t<e?r:n,f=[a[0]-c[0],a[1]-c[1]],l=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(l<i&&Math.abs(u-o)<i||l<i)){var v=f.map((function(n,t){return n/l*u+c[t]}));if(Math.abs(u+o-l)<i||Math.abs(u-(o+l))<i)return[v];if(!(l+o<u||u+o<l)){var s=Jn((o*o-l*l-u*u)/(-2*l*u)),h=Xn(c,v,+s),p=Xn(c,v,-s);return[h,p]}}},Cn=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(o),a=0===u?e:e.map((function(n){return n/u})),c=[-a[1],a[0]],f=[r[0]-n[0],r[1]-n[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>t+i)){var v=Math.sqrt(Math.pow(t,2)-Math.pow(l,2)),s=function(t,r){return n[r]-c[r]*l+a[r]*t};return Math.abs(t-Math.abs(l))<i?[v].map((function(n){return[n,n].map(s)})):[-v,v].map((function(n){return[n,n].map(s)}))}},Hn=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(o),a=0===u?e:e.map((function(n){return n/u})),c=[-a[1],a[0]],f=[r[0]-n[0],r[1]-n[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>t+i)){var v=Math.sqrt(Math.pow(t,2)-Math.pow(l,2)),s=function(t,r){return n[r]-c[r]*l+a[r]*t},h=Math.abs(t-Math.abs(l))<i?[v].map((function(n){return[n,n].map(s)})):[-v,v].map((function(n){return[n,n].map(s)})),p=h.map((function(n){return n.map((function(n,t){return n-r[t]}))})).map((function(n){return n[0]*e[0]+e[1]*n[1]})).map((function(n){return n/o}));return h.filter((function(n,t){return p[t]>-i}))}},$n=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=r,u=[e[0]-r[0],e[1]-r[1]],a=Math.pow(u[0],2)+Math.pow(u[1],2),c=Math.sqrt(a),f=0===c?u:u.map((function(n){return n/c})),l=[-f[1],f[0]],v=[o[0]-n[0],o[1]-n[1]],s=v[0]*f[1]-f[0]*v[1];if(!(Math.abs(s)>t+i)){var h=Math.sqrt(Math.pow(t,2)-Math.pow(s,2)),p=function(t,r){return n[r]-l[r]*s+f[r]*t},g=Math.abs(t-Math.abs(s))<i?[h].map((function(n){return[n,n].map(p)})):[-h,h].map((function(n){return[n,n].map(p)})),m=g.map((function(n){return n.map((function(n,t){return n-o[t]}))})).map((function(n){return n[0]*u[0]+u[1]*n[1]})).map((function(n){return n/a}));return g.filter((function(n,t){return m[t]>-i&&m[t]<1+i}))}},Bn=function(n,t){return Math.abs(n[0]-t[0])<nn&&Math.abs(n[1]-t[1])<nn},Dn=function(n,t,r){return[]},Un=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return zn(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Bn(e[0],e[i]))return[e[0],e[i]];return}},Gn=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Zn(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[t,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Bn(e[0],e[i]))return[e[0],e[i]];return}},Kn=function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Vn(t,r,n[0],n[1])})).filter((function(n){return null!=n})),i=pn(t,n),o=pn(r,n),u=hn(t,n),a=hn(r,n);if(0===e.length&&(i||o))return[t,r];if(0===e.length&&u&&a)return[t,r];switch(e.length){case 0:return i?[M(t),M(r)]:void 0;case 1:return u?[M(t),e[0]]:[M(r),e[0]];case 2:return e;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},Qn=Object.freeze({__proto__:null,limit_line:kn,limit_ray:Nn,limit_segment:qn,intersection_function:Sn,line_line:En,line_ray:In,line_segment:zn,ray_ray:Rn,ray_segment:Zn,segment_segment:Fn,line_ray_exclusive:function(n,t,r,e,i){return Sn(n,t,r,e,On,i)},line_segment_exclusive:Ln,ray_ray_exclusive:function(n,t,r,e,i){return Sn(n,t,r,e,wn,i)},ray_segment_exclusive:Tn,segment_segment_exclusive:Vn,circle_circle:Yn,circle_line:Cn,circle_ray:Hn,circle_segment:$n,convex_poly_circle:Dn,convex_poly_line:Un,convex_poly_ray:Gn,convex_poly_segment:Kn,convex_poly_ray_exclusive:function(n,t,r){var e=n.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Tn(t,r,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[t,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Bn(e[0],e[i]))return[e[0],e[i]];return}}}),Wn=function(n,t){var r=n[0]*t[0]+n[1]*t[1],e=n[0]*t[1]-n[1]*t[0],i=Math.atan2(e,r);return i<0&&(i+=2*Math.PI),i},nt=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=t.map((function(n){return Math.atan2(n[1],n[0])})),i=Array.from(Array(e.length)).map((function(n,t){return t})).sort((function(n,t){return e[n]-e[t]}));return i.slice(i.indexOf(0),i.length).concat(i.slice(0,i.indexOf(0)))},tt=function(n,r){var e=t(n),i=t(r),o=e.map((function(n,t){return e[t]+i[t]})),u=t(o),a=e.map((function(n,t){return-e[t]-i[t]}));return[u,t(a)]},rt=function(n,t,r,e){var i=t[0]*e[1]-e[0]*t[1];if(Math.abs(i)<nn){var o=[a(n,r),[t[0],t[1]]],u=[o,o];return delete u[t[0]*e[0]+t[1]*e[1]>0?1:0],u}var c=((r[0]-n[0])*e[1]-e[0]*(r[1]-n[1]))/i,f=n[0]+t[0]*c,l=n[1]+t[1]*c,v=tt(t,e);return v[1]=[v[1][1],-v[1][0]],v.map((function(n){return[[f,l],n]}))},et=function(n,t,r){var e=Wn(t,r)/n;return Array.from(Array(n-1)).map((function(n,r){return t+e*r}))},it=function(n,t,r){var e=Math.atan2(t[1],t[0]),i=Math.atan2(r[1],r[0]);return et(n,e,i).map((function(n){return[Math.cos(n),Math.sin(n)]}))},ot=function(n){return.5*n.map((function(n,t,r){var e=r[(t+1)%r.length];return n[0]*e[1]-e[0]*n[1]})).reduce((function(n,t){return n+t}),0)},ut=function(n){var t=1/(6*ot(n));return n.map((function(n,t,r){var e=r[(t+1)%r.length],i=n[0]*e[1]-e[0]*n[1];return[(n[0]+e[0])*i,(n[1]+e[1])*i]})).reduce((function(n,t){return[n[0]+t[0],n[1]+t[1]]}),[0,0]).map((function(n){return n*t}))},at=function(n){var t=n[0].length,r=Array.from(Array(t)).map((function(){return 1/0})),e=Array.from(Array(t)).map((function(){return-1/0}));n.forEach((function(n){return n.forEach((function(n,t){n<r[t]&&(r[t]=n),n>e[t]&&(e[t]=n)}))}));var i=e.map((function(n,t){return n-r[t]}));return[r,i]},ct=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=2*Math.PI/n*.5,o=e/Math.cos(i);return Array.from(Array(Math.floor(n))).map((function(e,u){var a=-2*Math.PI*u/n+i;return[T(t+o*Math.sin(a),14),T(r+o*Math.cos(a),14)]}))},ft=function(n,t,r){for(var e,i=t.map((function(t,e){return{o:t,i:e,d:r(n,t)}})),o=1/0,u=0;u<i.length;u+=1)i[u].d<o&&(e=u,o=i[u].d);return e},lt=function(n,t,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(t[0],2)+Math.pow(t[1],2),u=[0,1].map((function(t,e){return r[e]-n[e]})),a=[0,1].map((function(n,r){return t[r]*u[r]})).reduce((function(n,t){return n+t}),0),c=a/o,f=e(c,i);return[0,1].map((function(r,e){return n[e]+t[e]*f}))},vt=function(n,t,r){var e=n.map((function(n,e){return{type:"v",point:vn(t,r,n)?n:null,at_index:e}})).filter((function(n){return null!=n.point})),i=n.map((function(n,e,i){return{type:"e",point:Ln(t,r,n,i[(e+1)%i.length]),at_index:e}})).filter((function(n){return null!=n.point})),o=e.concat(i).sort((function(n,t){return Math.abs(n.point[0]-t.point[0])<nn?n.point[1]-t.point[1]:n.point[0]-t.point[0]}));return console.log(o),n},st=function(n,t,r){var e=n.map((function(n,e){return{point:vn(t,r,n)?n:null,at_index:e}})).filter((function(n){return null!=n.point})),i=n.map((function(n,e,i){return{point:Ln(t,r,n,i[(e+1)%i.length]),at_index:e}})).filter((function(n){return null!=n.point}));if(2==i.length){var o=i.slice().sort((function(n,t){return n.at_index-t.at_index})),u=n.slice(o[1].at_index+1).concat(n.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var a=n.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[u,a]}if(1==i.length&&1==e.length){e[0].type="v",i[0].type="e";var c=e.concat(i).sort((function(n,t){return n.at_index-t.at_index})),f=n.slice(c[1].at_index+1).concat(n.slice(0,c[0].at_index+1));"e"===c[0].type&&f.push(c[0].point),f.push(c[1].point);var l=n.slice(c[0].at_index+1,c[1].at_index+1);return"e"===c[1].type&&l.push(c[1].point),l.push(c[0].point),[f,l]}if(2==e.length){var v=e.slice().sort((function(n,t){return n.at_index-t.at_index}));return[n.slice(v[1].at_index).concat(n.slice(0,v[0].at_index+1)),n.slice(v[0].at_index,v[1].at_index+1)]}return[n.slice()]},ht=function(n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn,r=1e4,e=n.slice().sort((function(n,r){return Math.abs(n[1]-r[1])<t?n[0]-r[0]:n[1]-r[1]})),i=[];i.push(e[0]);var o=0,u=0,a=function(){u+=1;var n=i.length-1,r=e.filter((function(r){return!(Math.abs(r[0]-i[n][0])<t&&Math.abs(r[1]-i[n][1])<t)})).map((function(t){for(var r=Math.atan2(i[n][1]-t[1],i[n][0]-t[0]);r<o;)r+=2*Math.PI;return{node:t,angle:r,distance:void 0}})).sort((function(n,t){return n.angle<t.angle?-1:n.angle>t.angle?1:0}));if(0===r.length)return{v:void 0};var a=r[0];if(r=r.filter((function(n){return Math.abs(a.angle-n.angle)<t})).map((function(t){var r=Math.sqrt(Math.pow(i[n][0]-t.node[0],2)+Math.pow(i[n][1]-t.node[1],2));return t.distance=r,t})).sort((function(n,t){return n.distance<t.distance?1:n.distance>t.distance?-1:0})),i.filter((function(n){return n===r[0].node})).length>0)return{v:i};i.push(r[0].node),o=Math.atan2(i[n][1]-r[0].node[1],i[n][0]-r[0].node[0])};do{var c=a();if("object"===b(c))return c.v}while(u<r)},pt=Object.freeze({__proto__:null,clockwise_angle2_radians:function(n,t){for(;n<0;)n+=2*Math.PI;for(;t<0;)t+=2*Math.PI;var r=n-t;return r>=0?r:2*Math.PI-(t-n)},counter_clockwise_angle2_radians:function(n,t){for(;n<0;)n+=2*Math.PI;for(;t<0;)t+=2*Math.PI;var r=t-n;return r>=0?r:2*Math.PI-(n-t)},clockwise_angle2:function(n,t){var r=t[0]*n[0]+t[1]*n[1],e=t[0]*n[1]-t[1]*n[0],i=Math.atan2(e,r);return i<0&&(i+=2*Math.PI),i},counter_clockwise_angle2:Wn,counter_clockwise_vector_order:nt,interior_angles2:function(n,t){var r=Wn(n,t);return[r,2*Math.PI-r]},interior_angles:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.map((function(n,t,r){return Wn(n,r[(t+1)%r.length])}))},bisect_vectors:tt,bisect_lines2:rt,subsect_radians:et,subsect:it,signed_area:ot,centroid:ut,enclosing_rectangle:at,make_regular_polygon:ct,nearest_point2:function(n,t){var r=ft(n,t,o);return void 0===r?void 0:t[r]},nearest_point:function(n,t){var r=ft(n,t,u);return void 0===r?void 0:t[r]},nearest_point_on_line:lt,split_polygon:vt,split_convex_polygon:st,convex_hull:ht}),gt=function(){var n=this;Y(arguments).forEach((function(t){return n.push(t)}))},mt={},dt={preserve:{isEquivalent:function(){var n=Y(arguments),t=this.length<n.length?this:n,r=this.length<n.length?n:this;return en(t,r)},isParallel:function(){var n=Y(arguments),t=this.length<n.length?this:n,r=this.length<n.length?n:this;return ln(t,r)},dot:function(){var n=Y(arguments);return this.length>n.length?r(n,this):r(this,n)},distanceTo:function(){var n=this,t=Y(arguments),r=this.length<t.length?this.length:t.length,e=Array.from(Array(r)).map((function(r,e){return Math.pow(n[e]-t[e],2)})).reduce((function(n,t){return n+t}),0);return Math.sqrt(e)},bisect:function(){var n=Y(arguments);return tt(this,n).map((function(n){return mt.constructor(n)}))}},vector:{copy:function(){return M(this)},normalize:function(){return t(this)},scale:function(n){return this.map((function(t){return t*n}))},cross:function(){var n=Y(arguments),t=this.slice();return null==t[2]&&(t[2]=0),null==n[2]&&(n[2]=0),i(t,n)},transform:function(){return f(B(arguments),this)},add:function(){var n=Y(arguments);return this.map((function(t,r){return t+n[r]}))},subtract:function(){var n=Y(arguments);return this.map((function(t,r){return t-n[r]}))},rotateZ:function(n,t){return f(m(n,t),this)},rotateZ90:function(){return[-this[1],this[0]]},rotateZ180:function(){return[-this[0],-this[1]]},rotateZ270:function(){return[this[1],-this[0]]},flip:function(){return this.map((function(n){return-n}))},reflect:function(){var n=G(arguments),t=d(n.vector,n.origin);return f(t,this)},lerp:function(n,t){var r=this,e=Y(n),i=1-t,o=this.length<e.length?this.length:e.length;return Array.from(Array(o)).map((function(n,o){return r[o]*t+e[o]*i}))},midpoint:function(){for(var n=Y(arguments),t=this.length<n.length?this.slice():n,r=this.length<n.length?n:this.slice(),e=t.length;e<r.length;e+=1)t[e]=0;return r.map((function(n,e){return.5*(t[e]+r[e])}))}}};Object.keys(dt.preserve).forEach((function(n){mt[n]=dt.preserve[n]})),Object.keys(dt.vector).forEach((function(n){mt[n]=function(){return mt.constructor.apply(mt,M(dt.vector[n].apply(this,arguments)))}}));var yt={x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]},magnitude:function(){return n(this)}},bt=function n(){var t=Object.create(n.prototype);return gt.apply(t,arguments),Object.keys(yt).forEach((function(n){return Object.defineProperty(t,n,{get:yt[n].bind(t),enumerable:!0})})),Object.keys(mt).forEach((function(n){return Object.defineProperty(t,n,{value:mt[n].bind(t)})})),Object.freeze(t)};(bt.prototype=Object.create(Array.prototype)).constructor=bt,mt.constructor=bt,bt.fromAngle=function(n){return bt(Math.cos(n),Math.sin(n))},Object.freeze(bt);var _t=function n(){for(var t=[1,0,0,1,0,0],r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];var o=B(e);void 0!==o&&o.forEach((function(n,r){t[r]=n}));var u=function(){for(var r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];return n(v(t,B(e)).map((function(n){return T(n,13)})))},a=function(){return T(s(t))},c=function(){return n(h(t).map((function(n){return T(n,13)})))},y=function(r,e){var i=p(r,e);return n(v(t,i).map((function(n){return T(n,13)})))},b=function(){var r=g.apply(void 0,arguments);return n(v(t,r).map((function(n){return T(n,13)})))},_=function(){var r=m.apply(void 0,arguments);return n(v(t,r).map((function(n){return T(n,13)})))},M=function(){var r=d.apply(void 0,arguments);return n(v(t,r).map((function(n){return T(n,13)})))},j=function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=Y(r);return bt(f(t,i).map((function(n){return T(n,13)})))},O=function(r){return n(f(t,r).map((function(n){return T(n,13)})))},P=function(r,e){return n(l(t,r,e).map((function(n){return T(n,13)})))};return Object.defineProperty(t,"multiply",{value:u}),Object.defineProperty(t,"determinant",{value:a}),Object.defineProperty(t,"inverse",{value:c}),Object.defineProperty(t,"translate",{value:y}),Object.defineProperty(t,"scale",{value:b}),Object.defineProperty(t,"rotate",{value:_}),Object.defineProperty(t,"reflect",{value:M}),Object.defineProperty(t,"transform",{value:j}),Object.defineProperty(t,"transformVector",{value:O}),Object.defineProperty(t,"transformLine",{value:P}),Object.freeze(t)};_t.makeIdentity=function(){return _t(1,0,0,1,0,0)},_t.makeTranslation=function(n,t){return _t(p(n,t))},_t.makeRotation=function(n,t){return _t(m(n,t).map((function(n){return T(n,13)})))},_t.makeScale=function(n,t,r){return _t(g(n,t,r).map((function(n){return T(n,13)})))},_t.makeReflection=function(n,t){return _t(d(n,t).map((function(n){return T(n,13)})))};var Mt=function n(){for(var t=[1,0,0,0,1,0,0,0,1,0,0,0],r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];var o=D(e);void 0!==o&&o.forEach((function(n,r){t[r]=n}));var u=function(){for(var r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];return n(A(t,D(e)).map((function(n){return T(n,13)})))},a=function(){return T(x(t),13)},c=function(){return n(k(t).map((function(n){return T(n,13)})))},f=function(r,e,i){var o=N(r,e,i);return n(A(t,o).map((function(n){return T(n,13)})))},l=function(r){var e=q(r);return n(A(t,e).map((function(n){return T(n,13)})))},v=function(r){var e=S(r);return n(A(t,e).map((function(n){return T(n,13)})))},s=function(r){var e=E(r);return n(A(t,e).map((function(n){return T(n,13)})))},h=function(r,e,i){var o=I(r,e,i);return n(A(t,o).map((function(n){return T(n,13)})))},p=function(r){var e=z(r);return n(A(t,e).map((function(n){return T(n,13)})))},g=function(r,e){var i=R(r,e);return n(A(t,i).map((function(n){return T(n,13)})))},m=function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=Y(r);return bt(P(i,t).map((function(n){return T(n,13)})))},d=function(r){return n(P(t,r).map((function(n){return T(n,13)})))},y=function(r,e){return n(w(t,r,e).map((function(n){return T(n,13)})))};return Object.defineProperty(t,"multiply",{value:u}),Object.defineProperty(t,"determinant",{value:a}),Object.defineProperty(t,"inverse",{value:c}),Object.defineProperty(t,"translate",{value:f}),Object.defineProperty(t,"rotateX",{value:l}),Object.defineProperty(t,"rotateY",{value:v}),Object.defineProperty(t,"rotateZ",{value:s}),Object.defineProperty(t,"rotate",{value:h}),Object.defineProperty(t,"scale",{value:p}),Object.defineProperty(t,"reflectZ",{value:g}),Object.defineProperty(t,"transform",{value:m}),Object.defineProperty(t,"transformVector",{value:d}),Object.defineProperty(t,"transformLine",{value:y}),Object.freeze(t)};Mt.makeIdentity=function(){return Mt(1,0,0,0,1,0,0,0,1,0,0,0)},Mt.makeTranslation=function(n,t,r){return Mt(N(n,t,r))},Mt.makeRotationX=function(n){return Mt(q(n).map((function(n){return T(n,13)})))},Mt.makeRotationY=function(n){return Mt(S(n).map((function(n){return T(n,13)})))},Mt.makeRotationZ=function(n){return Mt(E(n).map((function(n){return T(n,13)})))},Mt.makeRotation=function(n,t,r){return Mt(I(n,t,r).map((function(n){return T(n,13)})))},Mt.makeScale=function(n,t){return Mt(z(n,t).map((function(n){return T(n,13)})))},Mt.makeReflectionZ=function(n,t){return Mt(R(n,t).map((function(n){return T(n,13)})))};var jt={circle:{poly:function(n,t){return n.origin,n.radius,[]},circle:function(n,t){return Yn(n.origin,n.radius,t.origin,t.radius)},line:function(n,t){return Cn(n.origin,n.radius,t.origin,t.vector)},ray:function(n,t){return Hn(n.origin,n.radius,t.origin,t.vector)},segment:function(n,t){return $n(n.origin,n.radius,t[0],t[1])}},line:{poly:function(n,t){return Un(t,n.origin,n.vector)},circle:function(n,t){return Cn(t.origin,t.radius,n.origin,n.vector)},line:function(n,t){return En(n.origin,n.vector,t.origin,t.vector)},ray:function(n,t){return In(n.origin,n.vector,t.origin,t.vector)},segment:function(n,t){return zn(n.origin,n.vector,t[0],t[1])}},ray:{poly:function(n,t){return Gn(t,n.origin,n.vector)},circle:function(n,t){return Hn(t.origin,t.radius,n.origin,n.vector)},line:function(n,t){return In(t.origin,t.vector,n.origin,n.vector)},ray:function(n,t){return Rn(n.origin,n.vector,t.origin,t.vector)},segment:function(n,t){return Zn(n.origin,n.vector,t[0],t[1])}},segment:{poly:function(n,t){return Kn(t,n.origin,n.vector)},circle:function(n,t){return $n(t.origin,t.radius,n[0],n[1])},line:function(n,t){return zn(t.origin,t.vector,n[0],n[1])},ray:function(n,t){return Zn(t.origin,t.vector,n[0],n[1])},segment:function(n,t){return Fn(n[0],n[1],t[0],t[1])}}},Ot=function(n,t){var r=F(n),e=F(t);return(0,jt[r][e])(n,t)};function Pt(n,t){var r=null!=t?t:{},e=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,r)&&!0},i=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,r)&&t>=-r},o=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,r)&&t>=-r&&t<=1+r};return Object.defineProperty(r,"isParallel",{value:function(n,t){if(null==n.vector)throw new Error("isParallel() argument is missing a vector");var r=this.vector.length<n.vector.length,e=r?this.vector:n.vector,i=r?n.vector:this.vector;return ln(e,i)}}),Object.defineProperty(r,"isDegenerate",{value:function(){return fn(this.vector)}}),Object.defineProperty(r,"nearestPoint",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=Y(t);return bt(lt(this.origin,this.vector,e,this.clip_function))}}),Object.defineProperty(r,"reflection",{value:function(){return _t.makeReflection(this.vector,this.origin)}}),Object.defineProperty(r,"intersect",{value:function(n){return Ot(this,n)}}),Object.defineProperty(r,"intersectLine",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var i=G(t);return Sn(this.origin,this.vector,i.origin,i.vector,e.bind(this))}}),Object.defineProperty(r,"intersectRay",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=K(t);return Sn(this.origin,this.vector,e.origin,e.vector,i.bind(this))}}),Object.defineProperty(r,"intersectSegment",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=U(t),i=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return Sn(this.origin,this.vector,e[0],i,o.bind(this))}}),Object.defineProperty(r,"bisectLine",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=G(t);return rt(this.origin,this.vector,e.origin,e.vector)}}),Object.defineProperty(r,"bisectRay",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=K(t);return rt(this.origin,this.vector,e.origin,e.vector)}}),Object.defineProperty(r,"bisectSegment",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=U(t),i=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return rt(this.origin,this.vector,e[0],i)}}),Object.freeze(r)}var wt=function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=G(r),o=i.origin,u=i.vector,a=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=B(r),a=l(i,o,u);return n(a[0],a[1])},c=Pt.bind(this),f=Object.create(c(n)),v=function(){return!0};return Object.defineProperty(f,"compare_function",{value:v}),Object.defineProperty(f,"clip_function",{value:kn}),f.origin=bt(o),f.vector=bt(u),Object.defineProperty(f,"length",{get:function(){return 1/0}}),Object.defineProperty(f,"transform",{value:a}),f};wt.fromPoints=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=C(t);return wt({origin:e[0],vector:[e[1][0]-e[0][0],e[1][1]-e[0][1]]})},wt.perpendicularBisector=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=C(r),u=t([o[1][0]-o[0][0],o[1][1]-o[0][1]]);return wt({origin:e(o[0],o[1]),vector:[u[1],-u[0]]})};var At=function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=G(r),o=i.origin,u=i.vector,a=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=B(r),a=u.map((function(n,t){return n+o[t]})),c=f(i,o),l=f(i,a).map((function(n,t){return n-c[t]}));return n(c,l)},c=function(){return n(o[0],o[1],-u[0],-u[1])},l=Pt.bind(this),v=Object.create(l(n)),s=function(n,t){return n>=-t};return Object.defineProperty(v,"origin",{get:function(){return bt(o)}}),Object.defineProperty(v,"vector",{get:function(){return bt(u)}}),Object.defineProperty(v,"length",{get:function(){return 1/0}}),Object.defineProperty(v,"transform",{value:a}),Object.defineProperty(v,"rotate180",{value:c}),Object.defineProperty(v,"compare_function",{value:s}),Object.defineProperty(v,"clip_function",{value:Nn}),v};At.fromPoints=function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=C(r);return At({origin:i[0],vector:t([i[1][0]-i[0][0],i[1][1]-i[0][1]])})};var xt=function n(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=C(r),u=Pt.bind(this),a=o.length>0?o.map((function(n){return bt(n)})):void 0;if(void 0!==a){var c=Object.create(u(n,a)),l=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=B(r),o=c.map((function(n){return f(i,n)}));return n(o)},v=function(t){var r=e(c[0],c[1]),i=c.map((function(n){return n.lerp(r,t)}));return n(i)},s=function(){return bt(c[1][0]-c[0][0],c[1][1]-c[0][1])},h=function(){return bt(e(c[0],c[1]))},p=function(){return Math.sqrt(Math.pow(c[1][0]-c[0][0],2)+Math.pow(c[1][1]-c[0][1],2))},g=function(n,t){return n>=-t&&n<=1+t};return Object.defineProperty(c,"origin",{get:function(){return c[0]}}),Object.defineProperty(c,"vector",{get:function(){return s()}}),Object.defineProperty(c,"midpoint",{value:h}),Object.defineProperty(c,"magnitude",{get:function(){return p()}}),Object.defineProperty(c,"transform",{value:l}),Object.defineProperty(c,"scale",{value:v}),Object.defineProperty(c,"compare_function",{value:g}),Object.defineProperty(c,"clip_function",{value:qn}),c}},kt=function(){var n=Array.from(arguments),t=n.filter((function(n){return!isNaN(n)})),r=C(n);if(3===t.length){this.origin=bt(t[0],t[1]);var e=_(t,3);this.radius=e[2]}else 2===r.length&&(this.radius=o.apply(void 0,M(r)),this.origin=bt.apply(void 0,M(r[0])))},Nt={intersectionLine:function(){var n=G(arguments),t=Cn(origin,radius,n.origin,n.vector);return void 0===t?void 0:t.map((function(n){return bt(n)}))},intersectionRay:function(){var n=K(arguments),t=Hn(origin,radius,n.origin,n.vector);return void 0===t?void 0:t.map((function(n){return bt(n)}))},intersectionSegment:function(){var n=C(arguments),t=$n(origin,radius,n[0],n[1]);return void 0===t?void 0:t.map((function(n){return bt(n)}))},intersectionCircle:function(){},intersect:function(n){return Ot(circle,n)}},qt={x:function(){return this.origin[0]},y:function(){return this.origin[1]}},St=function n(){var t=Object.create(n.prototype);return kt.apply(t,arguments),Object.keys(qt).forEach((function(n){return Object.defineProperty(t,n,{get:qt[n].bind(t),enumerable:!0})})),Object.keys(Nt).forEach((function(n){return Object.defineProperty(t,n,{value:Nt[n].bind(t)})})),Object.freeze(t)};(St.prototype=Object.create(Array.prototype)).constructor=St,function(n){n.fromPoints=function(){var t=C(innerArgs);return n(t,o(t[0],t[1]))}}(St),Object.freeze(St);var Et=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],e=[Y(n),Y(t)],i=function(){var n=Wn(e[0],e[1]),t=e.map((function(n){return Math.atan2(n[1],n[0])}))[0]+.5*n;return bt(Math.cos(t),Math.sin(t))},o=function(n){return it(n,e[0],e[1]).map((function(n){return bt(n[0],n[1])}))},u=function(){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];var o=Y(t).map((function(n,t){return n+r[t]})),u=(o[1]-e[0][1])*-e[0][0]-(o[0]-e[0][0])*-e[0][1],a=o[1]*e[1][0]-o[0]*e[1][1];return u<0&&a<0};return{contains:u,bisect:i,subsect:o,get center(){return r},get vectors(){return e},get angle(){return Wn(e[0],e[1])}}};function It(n){var t={},r=n,i=function(){return ot(this.points)},u=function(){return this.points.map((function(n,t,r){var e=(t+r.length-1)%r.length,i=(t+1)%r.length,o=n,u=r[e].map((function(n,t){return n-o[t]})),a=r[i].map((function(n,t){return n-o[t]}));return Et(a,u,o)}))};return Object.defineProperty(t,"area",{value:i}),Object.defineProperty(t,"centroid",{value:function(){return ut(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return e(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return at(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return sn(Y(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e,i=Y(t),u=this.sides.map((function(n){return n.nearestPoint(i)})),a=1/0;return u.map((function(n){return o(i,n)})).forEach((function(n,t){n<a&&(a=n,e=t)})),{point:u[e],edge:this.sides[e]}}}),Object.defineProperty(t,"clipSegment",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=U(t),i=Kn(this.points,e[0],e[1]);return void 0===i?void 0:xt(i)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=G(t),i=Un(this.points,e.origin,e.vector);return void 0===i?void 0:xt(i)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=G(t),i=Gn(this.points,e.origin,e.vector);return void 0===i?void 0:xt(i)}}),Object.defineProperty(t,"split",{value:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=G(t);return vt(this.points,i.origin,i.vector).map((function(n){return r(n)}))}}),Object.defineProperty(t,"scale",{value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut(this.points),e=this.points.map((function(n){return[0,1].map((function(r,e){return n[e]-t[e]}))})).map((function(r){return r.map((function(e,i){return t[i]+r[i]*n}))}));return r(e)}}),Object.defineProperty(t,"rotate",{value:function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut(this.points),e=this.points.map((function(r){var e=[r[0]-t[0],r[1]-t[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[t[0]+Math.cos(o+n)*i,t[1]+Math.sin(o+n)*i]}));return r(e)}}),Object.defineProperty(t,"translate",{value:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=Y(t),o=this.points.map((function(n){return n.map((function(n,t){return n+i[t]}))}));return r(o)}}),Object.defineProperty(t,"transform",{value:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=B(t),o=this.points.map((function(n){return bt(f(i,n))}));return r(o)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return u.call(this)}}),Object.defineProperty(t,"signedArea",{value:i}),Object.freeze(t)}Et.fromVectors=function(n,t){return Et(n,t)},Et.fromPoints=function(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],e=[n,t].map((function(n){return n.map((function(t,e){return n[e]-r[e]}))}));return Et(e[0],e[1],r)};var zt=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=C(t).map((function(n){return bt(n)}));if(void 0!==e){var i=e.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return xt(n[0][0],n[0][1],n[1][0],n[1][1])})),o=It.bind(this),u=Object.create(o());return Object.defineProperty(u,"points",{get:function(){return e}}),Object.defineProperty(u,"sides",{get:function(){return i}}),u}};zt.regularPolygon=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=ct(n,t,r,e);return zt(i)},zt.convexHull=function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ht(n,t);return zt(r)};var Rt=function n(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var i=Q(r).map((function(n){return bt(n)}));if(void 0!==i){var o=i.map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return xt(n[0][0],n[0][1],n[1][0],n[1][1])})),u=It.bind(this),a=Object.create(u(n)),c=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var o=G(r);return st(i,o.origin,o.vector).map((function(t){return n(t)}))},f=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=Q(t);return gn(i,e)},l=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut(a.points),e=a.points.map((function(n){return[0,1].map((function(t,e){return n[e]-r[e]}))})).map((function(n){return n.map((function(e,i){return r[i]+n[i]*t}))}));return n(e)},v=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ut(a.points),e=a.points.map((function(n){var e=[n[0]-r[0],n[1]-r[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[r[0]+Math.cos(o+t)*i,r[1]+Math.sin(o+t)*i]}));return n(e)};return Object.defineProperty(a,"points",{get:function(){return i}}),Object.defineProperty(a,"sides",{get:function(){return o}}),Object.defineProperty(a,"split",{value:c}),Object.defineProperty(a,"overlaps",{value:f}),Object.defineProperty(a,"scale",{value:l}),Object.defineProperty(a,"rotate",{value:v}),a}};Rt.regularPolygon=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=ct(n,t,r,e);return Rt(i)},Rt.convexHull=function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ht(n,t);return Rt(r)};var Zt=function n(){for(var t,r,e,i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];var a=Array.from(o),c=a.filter((function(n){return!isNaN(n)})),f=a.filter((function(n){return n.constructor===Array}));if(4===c.length){t=bt(c.slice(0,2));var l=_(c,4);r=l[2],e=l[3]}1===f.length&&(f=f[0]),2===f.length&&"number"==typeof f[0][0]&&(t=bt(f[0].slice()),r=f[1][0],e=f[1][1]);var v=[[t[0],t[1]],[t[0]+r,t[1]],[t[0]+r,t[1]+e],[t[0],t[1]+e]],s=It.bind(this),h=Object.create(s(n)),p=function(i,o){var u=null!=o?o:[t[0]+r,t[1]+e],a=t[0]+(u[0]-t[0])*(1-i),c=t[1]+(u[1]-t[1])*(1-i);return n(a,c,r*i,e*i)},g=function(){var n;return(n=Rt(v)).rotate.apply(n,arguments)},m=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Rt(v).transform(t)};return Object.defineProperty(h,"points",{get:function(){return v}}),Object.defineProperty(h,"origin",{get:function(){return t}}),Object.defineProperty(h,"width",{get:function(){return r}}),Object.defineProperty(h,"height",{get:function(){return e}}),Object.defineProperty(h,"area",{get:function(){return r*e}}),Object.defineProperty(h,"scale",{value:p}),Object.defineProperty(h,"rotate",{value:g}),Object.defineProperty(h,"transform",{value:m}),h};Zt.fromPoints=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=C(t),i=at(e);return Zt(i)};var Ft=function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];var e=C(t);if(void 0!==e){var i=nt.apply(void 0,M(e)),o=function(){return i.map((function(n){return e[n]})).map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Et.fromVectors(n[0],n[1])}))},u=function(){return i.map((function(n){return e[n]})).map((function(n,t,r){return[n,r[(t+1)%r.length]]})).map((function(n){return Wn(n[0],n[1])}))};return{sectors:o,angles:u,get vectors(){return e},get vectorOrder(){return M(i)}}}};Ft.fromVectors=function(){return Ft.apply(void 0,arguments)},Ft.fromPoints=function(n,t){var r=t.map((function(t){return t.map((function(r,e){return t[e]-n[e]}))}));return Ft.fromVectors(r)};var Lt=Object.create(null);return Object.assign(Lt,c,y,Z,pt,mn,on),Lt.clean_number=T,Lt.flatten_input=J,Lt.semi_flatten_input=X,Object.keys(W).filter((function(n){return/^is_/g.test(n)})).forEach((function(n){Lt[n]=W[n]})),Object.keys(W).filter((function(n){return/^get_/g.test(n)})).forEach((function(n){Lt[n]=W[n]})),Lt.intersection=Qn,Object.freeze(Lt),{vector:bt,matrix2:_t,matrix:Mt,line:wt,ray:At,segment:xt,circle:St,polygon:zt,convexPolygon:Rt,rectangle:Zt,junction:Ft,sector:Et,core:Lt}}));
