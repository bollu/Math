!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(n=n||self).math=r()}(this,(function(){"use strict";var n=function(n){var r=n.map((function(n){return n*n})).reduce((function(n,r){return n+r}),0);return Math.sqrt(r)},r=function(r){var t=n(r);return 0===t?r:r.map((function(n){return n/t}))},t=function(n,r){return n.map((function(t,e){return n[e]*r[e]})).reduce((function(n,r){return n+r}),0)},e=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=r.length>0?r[0].length:0,i=Array(e).fill(0);return r.forEach((function(n){return i.forEach((function(r,t){i[t]+=n[t]||0}))})),i.map((function(n){return n/r.length}))},i=function(n,r){return[n[1]*r[2]-n[2]*r[1],n[0]*r[2]-n[2]*r[0],n[0]*r[1]-n[1]*r[0]]},o=function(n,r){var t=n[0]-r[0],e=n[1]-r[1];return Math.sqrt(t*t+e*e)},u=function(n,r){for(var t=n.length,e=0,i=0;i<t;i+=1)e+=Math.pow(n[i]-r[i],2);return Math.sqrt(e)},a=function(n,r){return n.map((function(t,e){return(n[e]+r[e])/2}))},c=Object.freeze({__proto__:null,magnitude:n,normalize:r,dot:t,average:e,cross2:function(n,r){return[n[0]*r[1],n[1]*r[0]]},cross3:i,distance2:o,distance3:function(n,r){var t=n[0]-r[0],e=n[1]-r[1],i=n[2]-r[2];return Math.sqrt(t*t+e*e+i*i)},distance:u,midpoint2:a}),f=function(n,r){return[n[0]*r[0]+n[2]*r[1]+n[4],n[1]*r[0]+n[3]*r[1]+n[5]]},l=function(n,r,t){return{origin:[n[0]*r[0]+n[2]*r[1]+n[4],n[1]*r[0]+n[3]*r[1]+n[5]],vector:[n[0]*t[0]+n[2]*t[1],n[1]*t[0]+n[3]*t[1]]}},v=function(n,r){return[n[0]*r[0]+n[2]*r[1],n[1]*r[0]+n[3]*r[1],n[0]*r[2]+n[2]*r[3],n[1]*r[2]+n[3]*r[3],n[0]*r[4]+n[2]*r[5]+n[4],n[1]*r[4]+n[3]*r[5]+n[5]]},s=function(n){return n[0]*n[3]-n[1]*n[2]},h=function(n){var r=s(n);if(!(Math.abs(r)<1e-6||isNaN(r))&&isFinite(n[4])&&isFinite(n[5]))return[n[3]/r,-n[1]/r,-n[2]/r,n[0]/r,(n[2]*n[5]-n[3]*n[4])/r,(n[1]*n[4]-n[0]*n[5])/r]},p=function(n,r){return[1,0,0,1,n,r]},g=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[n,0,0,r,n*-t[0]+t[0],r*-t[1]+t[1]]},m=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],t=Math.cos(n),e=Math.sin(n);return[t,e,-e,t,r[0],r[1]]},d=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],t=Math.atan2(n[1],n[0]),e=Math.cos(t),i=Math.sin(t),o=Math.cos(-t),u=Math.sin(-t),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,l=i*-u+-e*o,v=r[0]+a*-r[0]+-r[1]*f,s=r[1]+c*-r[0]+-r[1]*l;return[a,c,f,l,v,s]},y=Object.freeze({__proto__:null,multiply_matrix2_vector2:f,multiply_matrix2_line2:l,multiply_matrices2:v,matrix2_determinant:s,invert_matrix2:h,make_matrix2_translate:p,make_matrix2_scale:g,make_matrix2_rotate:m,make_matrix2_reflection:d});function b(n){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function _(n,r){return function(n){if(Array.isArray(n))return n}(n)||function(n,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var t=[],e=!0,i=!1,o=void 0;try{for(var u,a=n[Symbol.iterator]();!(e=(u=a.next()).done)&&(t.push(u.value),!r||t.length!==r);e=!0);}catch(n){i=!0,o=n}finally{try{e||null==a.return||a.return()}finally{if(i)throw o}}return t}(n,r)||j(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(n){return function(n){if(Array.isArray(n))return O(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||j(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(n,r){if(n){if("string"==typeof n)return O(n,r);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?O(n,r):void 0}}function O(n,r){(null==r||r>n.length)&&(r=n.length);for(var t=0,e=new Array(r);t<r;t++)e[t]=n[t];return e}var P=function(n,r){return[n[0]*r[0]+n[3]*r[1]+n[6]*r[2]+n[9],n[1]*r[0]+n[4]*r[1]+n[7]*r[2]+n[10],n[2]*r[0]+n[5]*r[1]+n[8]*r[2]+n[11]]},w=function(n,r,t){return{origin:[n[0]*r[0]+n[3]*r[1]+n[6]*r[2]+n[9],n[1]*r[0]+n[4]*r[1]+n[7]*r[2]+n[10],n[2]*r[0]+n[5]*r[1]+n[8]*r[2]+n[11]],vector:[n[0]*t[0]+n[3]*t[1]+n[6]*t[2],n[1]*t[0]+n[4]*t[1]+n[7]*t[2],n[2]*t[0]+n[5]*t[1]+n[8]*t[2]]}},A=function(n,r){return[n[0]*r[0]+n[3]*r[1]+n[6]*r[2],n[1]*r[0]+n[4]*r[1]+n[7]*r[2],n[2]*r[0]+n[5]*r[1]+n[8]*r[2],n[0]*r[3]+n[3]*r[4]+n[6]*r[5],n[1]*r[3]+n[4]*r[4]+n[7]*r[5],n[2]*r[3]+n[5]*r[4]+n[8]*r[5],n[0]*r[6]+n[3]*r[7]+n[6]*r[8],n[1]*r[6]+n[4]*r[7]+n[7]*r[8],n[2]*r[6]+n[5]*r[7]+n[8]*r[8],n[0]*r[9]+n[3]*r[10]+n[6]*r[11]+n[9],n[1]*r[9]+n[4]*r[10]+n[7]*r[11]+n[10],n[2]*r[9]+n[5]*r[10]+n[8]*r[11]+n[11]]},x=function(n){return n[0]*n[4]*n[8]-n[0]*n[7]*n[5]-n[3]*n[1]*n[8]+n[3]*n[7]*n[2]+n[6]*n[1]*n[5]-n[6]*n[4]*n[2]},k=function(n){var r=x(n);if(!(Math.abs(r)<1e-6||isNaN(r))&&isFinite(n[9])&&isFinite(n[10])&&isFinite(n[11])){var t=[n[4]*n[8]-n[7]*n[5],-n[1]*n[8]+n[7]*n[2],n[1]*n[5]-n[4]*n[2],-n[3]*n[8]+n[6]*n[5],n[0]*n[8]-n[6]*n[2],-n[0]*n[5]+n[3]*n[2],n[3]*n[7]-n[6]*n[4],-n[0]*n[7]+n[6]*n[1],n[0]*n[4]-n[3]*n[1],-n[3]*n[7]*n[11]+n[3]*n[8]*n[10]+n[6]*n[4]*n[11]-n[6]*n[5]*n[10]-n[9]*n[4]*n[8]+n[9]*n[5]*n[7],n[0]*n[7]*n[11]-n[0]*n[8]*n[10]-n[6]*n[1]*n[11]+n[6]*n[2]*n[10]+n[9]*n[1]*n[8]-n[9]*n[2]*n[7],-n[0]*n[4]*n[11]+n[0]*n[5]*n[10]+n[3]*n[1]*n[11]-n[3]*n[2]*n[10]-n[9]*n[1]*n[5]+n[9]*n[2]*n[4]],e=1/r;return t.map((function(n){return n*e}))}},N=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[1,0,0,0,1,0,0,0,1,n,r,t]},q=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],t=Math.cos(n),e=Math.sin(n);return[1,0,0,0,t,e,0,-e,t,r[0]||0,r[1]||0,r[2]||0]},S=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],t=Math.cos(n),e=Math.sin(n);return[t,0,-e,0,1,0,e,0,t,r[0]||0,r[1]||0,r[2]||0]},I=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],t=Math.cos(n),e=Math.sin(n);return[t,e,0,-e,t,0,0,0,1,r[0]||0,r[1]||0,r[2]||0]},E=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=r(t),o=Array.from(Array(3)).map((function(n,r){return e[r]||0})),u=_(i,3),a=u[0],c=u[1],f=u[2],l=Math.cos(n),v=Math.sin(n),s=Math.sqrt(i[1]*i[1]+i[2]*i[2]),h=Math.abs(s)<1e-6?0:c/s,p=Math.abs(s)<1e-6?1:f/s,g=[1,0,0,0,1,0,0,0,1,o[0],o[1],o[2]],m=[1,0,0,0,1,0,0,0,1,-o[0],-o[1],-o[2]],d=[1,0,0,0,p,h,0,-h,p,0,0,0],y=[1,0,0,0,p,-h,0,h,p,0,0,0],b=[s,0,a,0,1,0,-a,0,s,0,0,0],M=[s,0,-a,0,1,0,a,0,s,0,0,0],j=[l,v,0,-v,l,0,0,0,1,0,0,0];return A(m,A(y,A(M,A(j,A(b,A(d,g))))))},z=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[n,0,0,0,n,0,0,0,n,n*-r[0]+r[0],n*-r[1]+r[1],n*-r[2]+r[2]]},R=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],t=Math.atan2(n[1],n[0]),e=Math.cos(t),i=Math.sin(t),o=Math.cos(-t),u=Math.sin(-t),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,l=i*-u+-e*o,v=r[0]+a*-r[0]+-r[1]*f,s=r[1]+c*-r[0]+-r[1]*l;return[a,c,0,f,l,0,0,0,0,v,s,0]},Z=Object.freeze({__proto__:null,multiply_matrix3_vector3:P,multiply_matrix3_line3:w,multiply_matrices3:A,matrix3_determinant:x,invert_matrix3:k,make_matrix3_translate:N,make_matrix3_rotateX:q,make_matrix3_rotateY:S,make_matrix3_rotateZ:I,make_matrix3_rotate:E,make_matrix3_scale:z,make_matrix3_reflectionZ:R}),F=function(n){if("object"===b(n)){if(null!=n.radius)return"circle";if(null!=n.width)return"rectangle";if(null!=n.x)return"vector";if(null!=n.rotate180)return"ray";if(null!=n[0]&&n[0].length&&null!=n[0].x)return"segment";if(null!=n.vector&&null!=n.origin)return"line"}},L=function(n){var r="".concat(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return r?Math.max(0,(r[1]?r[1].length:0)-(r[2]?+r[2]:0)):0},T=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof n)return n;var t=parseFloat(n.toFixed(r));return L(t)===Math.min(r,L(n))?n:t},V=function(n){return null!=n&&"function"==typeof n[Symbol.iterator]},J=function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];switch(t.length){case void 0:case 0:return t;case 1:return V(t[0])&&"string"!=typeof t[0]?n.apply(void 0,M(t[0])):[t[0]];default:return Array.from(t).map((function(r){return V(r)?M(n(r)):r})).reduce((function(n,r){return n.concat(r)}),[])}},X=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];for(var e=r;1===e.length&&"object"===b(e[0])&&e[0].length;){var i=e,o=_(i,1);e=o[0]}return e},Y=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=J(r).filter((function(n){return void 0!==n}));if(void 0!==e&&0!==e.length)return isNaN(e[0].x)||(e=["x","y","z"].map((function(n){return e[0][n]})).filter((function(n){return void 0!==n}))),e.filter((function(n){return"number"==typeof n}))},H=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return X(r).map((function(n){return Y(n)}))},$=[1,0,0,1,0,0],B=[1,0,0,0,1,0,0,0,1,0,0,0],C=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=Y(r);if(void 0!==e)return 6===e.length?e:e.length>6?[e[0],e[1],e[2],e[3],e[4],e[5]]:e.length<6?$.map((function(n,r){return e[r]||n})):void 0},D=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=Y(r);if(void 0!==e){switch(e.length){case 4:return[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,0,0,0,1];case 6:return[e[0],e[1],0,e[2],e[3],0,0,0,1,e[4],e[5],0];case 9:return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],0,0,0];case 12:return e;case 16:return[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]}return e.length>12?[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]:e.length<12?B.map((function(n,r){return e[r]||n})):void 0}};function U(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return H(r)}function G(){var n=Array.from(arguments),r=n.filter((function(n){return!isNaN(n)})),t=n.filter((function(n){return n.constructor===Array}));if(0===n.length)return{vector:[],origin:[]};if(!isNaN(n[0])&&r.length>=4)return{origin:[n[0],n[1]],vector:[n[2],n[3]]};if(t.length>0){if(1===t.length)return G.apply(void 0,M(t[0]));if(2===t.length)return{origin:[t[0][0],t[0][1]],vector:[t[1][0],t[1][1]]};if(4===t.length)return{origin:[t[0],t[1]],vector:[t[2],t[3]]}}if(n[0].constructor===Object){var e=[],i=[];return null!=n[0].vector?e=Y(n[0].vector):null!=n[0].direction&&(e=Y(n[0].direction)),null!=n[0].origin?i=Y(n[0].origin):null!=n[0].point&&(i=Y(n[0].point)),{origin:i,vector:e}}return{origin:[],vector:[]}}function K(){return G.apply(void 0,arguments)}function Q(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];if(0!==r.length)return 1===r.length&&void 0!==r[0]?Q.apply(void 0,M(r[0])):Array.from(r)}var W=Object.freeze({__proto__:null,Typeof:F,clean_number:T,is_number:function(n){return null!=n&&!isNaN(n)},is_vector:function(n){return null!=n&&null!=n[0]&&!isNaN(n[0])},is_iterable:V,flatten_input:J,semi_flatten_input:X,get_vector:Y,get_vector_of_vectors:H,get_matrix2:C,get_matrix3:D,get_segment:U,get_line:G,get_ray:K,get_two_vec2:function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];if(0!==t.length){if(1===t.length&&void 0!==t[0])return n.apply(void 0,M(t[0]));var i=Array.from(t),o=i.filter((function(n){return!isNaN(n)})),u=i.filter((function(n){return"object"===b(n)})).filter((function(n){return n.constructor===Array}));return o.length>=4?[[o[0],o[1]],[o[2],o[3]]]:u.length>=2&&!isNaN(u[0][0])?u:1!==u.length||isNaN(u[0][0][0])?void 0:u[0]}},get_array_of_vec:Q,get_array_of_vec2:function(){var n=Array.from(arguments),r=n.filter((function(n){return n.constructor===Array}));return r.length>=2&&!isNaN(r[0][0])?r:1===r.length&&r[0].length>=1?r[0]:n}}),nn=1e-6,rn=function(n,r){return Array.from(Array(n.length-1)).map((function(t,e){return r(n[0],n[e+1])})).reduce((function(n,r){return n&&r}),!0)},tn=function n(){var r=H.apply(void 0,arguments);if(0===r.length)return!1;if(1===r.length&&void 0!==r[0])return n.apply(void 0,M(r[0]));for(var t=r[0].length,e=Array.from(Array(t)),i=1;i<r.length;i+=1)if(b(r[i-1])!==b(r[i]))return!1;return Array.from(Array(r.length-1)).map((function(n,t){return e.map((function(n,e){return Math.abs(r[t][e]-r[t+1][e])<nn})).reduce((function(n,r){return n&&r}),!0)})).reduce((function(n,r){return n&&r}),!0)&&Array.from(Array(r.length-1)).map((function(n,t){return r[0].length===r[t+1].length})).reduce((function(n,r){return n&&r}),!0)},en=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=X(r);if(e.length<1)return!1;var i=b(e[0]);if("undefined"===i)return!1;switch(e[0].constructor===Array&&(e=e.map((function(n){return X(n)}))),i){case"number":return rn(e,(function(n,r){return Math.abs(n-r)<nn}));case"boolean":case"string":return rn(e,(function(n,r){return n===r}));case"object":return e[0].constructor===Array?tn.apply(void 0,M(e)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),rn(e,(function(n,r){return JSON.stringify(n)===JSON.stringify(r)})));default:console.warn("incapable of determining comparison method")}return!1},on=Object.freeze({__proto__:null,EPSILON:nn,equivalent_numbers:function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return 0!==t.length&&(1===t.length&&void 0!==t[0]?n.apply(void 0,M(t[0])):rn(t,(function(n,r){return Math.abs(n-r)<nn})))},equivalent_vectors:tn,equivalent:en}),un=function(n,r,t,e,i){var o=function(n,r){return n[0]*r[1]-r[0]*n[1]},u=o(r,e),a=-u,c=o([t[0]-n[0],t[1]-n[1]],e),f=o([n[0]-t[0],n[1]-t[1]],r);return!(Math.abs(u)<nn)&&i(c/u,f/a)},an=function(n,r){return n>=-nn&&n<=1+nn&&r>=-nn&&r<=1+nn},cn=function(n,r,t,e){var i=[r[0]-n[0],r[1]-n[1]],o=[e[0]-t[0],e[1]-t[1]];return un(n,i,t,o,an)},fn=function(n){return Math.abs(n.reduce((function(n,r){return n+r}),0))<nn},ln=function(n,e){return 1-Math.abs(t(r(n),r(e)))<nn},vn=function(n,r,t){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nn,i=[t[0]-n[0],t[1]-n[1]],o=i[0]*r[1]-i[1]*r[0];return Math.abs(o)<e},sn=function(n,r){for(var t=!1,e=0,i=r.length-1;e<r.length;i=e++)r[e][1]>n[1]!=r[i][1]>n[1]&&n[0]<(r[i][0]-r[e][0])*(n[1]-r[e][1])/(r[i][1]-r[e][1])+r[e][0]&&(t=!t);return t},hn=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return null!=r&&r.length>0&&r.map((function(r,e,i){var o=i[(e+1)%i.length],u=[o[0]-r[0],o[1]-r[1]],a=[n[0]-r[0],n[1]-r[1]];return u[0]*a[1]-u[1]*a[0]>-t})).map((function(n,r,t){return n===t[0]})).reduce((function(n,r){return n&&r}),!0)},pn=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return null!=r&&r.length>0&&r.map((function(r,e,i){var o=i[(e+1)%i.length],u=[o[0]-r[0],o[1]-r[1]],a=[n[0]-r[0],n[1]-r[1]];return u[0]*a[1]-u[1]*a[0]>t})).map((function(n,r,t){return n===t[0]})).reduce((function(n,r){return n&&r}),!0)},gn=function(n,r){for(var t=n.map((function(n,r,t){return[n,t[(r+1)%t.length]]})),e=r.map((function(n,r,t){return[n,t[(r+1)%t.length]]})),i=0;i<t.length;i+=1)for(var o=0;o<e.length;o+=1)if(cn(t[i][0],t[i][1],e[o][0],e[o][1]))return!0;return!!sn(r[0],n)||!!sn(n[0],r)},mn=Object.freeze({__proto__:null,overlap_function:un,segment_segment_overlap:cn,degenerate:fn,parallel:ln,point_on_line:vn,point_on_segment:function(n,r,t){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nn,i=[n[0]-r[0],n[1]-r[1]],o=[n[0]-t[0],n[1]-t[1]],u=[r[0]-t[0],r[1]-t[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),c=Math.sqrt(o[0]*o[0]+o[1]*o[1]),f=Math.sqrt(u[0]*u[0]+u[1]*u[1]);return Math.abs(a-c-f)<e},point_in_poly:sn,point_in_convex_poly:hn,point_in_convex_poly_exclusive:pn,convex_polygons_overlap:gn,convex_polygon_is_enclosed:function(n,r){if(r.map((function(r){return hn(r,n)})).reduce((function(n,r){return n||r}),!1))return!1},convex_polygons_enclose:function(n,r){var t=r.map((function(r){return hn(r,n)})).reduce((function(n,r){return n||r}),!1),e=n.map((function(r){return hn(r,n)})).reduce((function(n,r){return n&&r}),!0);return!t&&e},is_counter_clockwise_between:function(n,r,t){for(;t<r;)t+=2*Math.PI;for(;n<r;)n+=2*Math.PI;return n<t}}),dn=function(){return!0},yn=function(n,r){return r>=-nn},bn=function(n,r){return r>=-nn&&r<=1+nn},_n=function(n,r){return n>=-nn&&r>=-nn},Mn=function(n,r){return n>=-nn&&r>=-nn&&r<=1+nn},jn=function(n,r){return n>=-nn&&n<=1+nn&&r>=-nn&&r<=1+nn},On=function(n,r){return r>nn},Pn=function(n,r){return r>nn&&r<1-nn},wn=function(n,r){return n>nn&&r>nn},An=function(n,r){return n>nn&&r>nn&&r<1-nn},xn=function(n,r){return n>nn&&n<1-nn&&r>nn&&r<1-nn},kn=function(n){return n},Nn=function(n){return n<-nn?0:n},qn=function(n){return n<-nn?0:n>1+nn?1:n},Sn=function(n,r,t,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:nn;function u(n,r){return n[0]*r[1]-r[0]*n[1]}var a=u(r,e);if(!(Math.abs(a)<o)){var c=-a,f=u([t[0]-n[0],t[1]-n[1]],e),l=u([n[0]-t[0],n[1]-t[1]],r),v=f/a,s=l/c;return i(v,s,o)?[n[0]+r[0]*v,n[1]+r[1]*v]:void 0}},In=function(n,r,t,e,i){return Sn(n,r,t,e,dn,i)},En=function(n,r,t,e,i){return Sn(n,r,t,e,yn,i)},zn=function(n,r,t,e,i){var o=[e[0]-t[0],e[1]-t[1]];return Sn(n,r,t,o,bn,i)},Rn=function(n,r,t,e,i){return Sn(n,r,t,e,_n,i)},Zn=function(n,r,t,e,i){var o=[e[0]-t[0],e[1]-t[1]];return Sn(n,r,t,o,Mn,i)},Fn=function(n,r,t,e,i){var o=[r[0]-n[0],r[1]-n[1]],u=[e[0]-t[0],e[1]-t[1]];return Sn(n,o,t,u,jn,i)},Ln=function(n,r,t,e,i){var o=[e[0]-t[0],e[1]-t[1]];return Sn(n,r,t,o,Pn,i)},Tn=function(n,r,t,e,i){var o=[e[0]-t[0],e[1]-t[1]];return Sn(n,r,t,o,An,i)},Vn=function(n,r,t,e,i){var o=[r[0]-n[0],r[1]-n[1]],u=[e[0]-t[0],e[1]-t[1]];return Sn(n,o,t,u,xn,i)},Jn=function(n){return n>=1?0:n<=-1?Math.PI:Math.acos(n)},Xn=function(n,r,t){var e=r[0]-n[0],i=r[1]-n[1],o=e*Math.cos(t)+i*Math.sin(t),u=i*Math.cos(t)-e*Math.sin(t);return[n[0]+o,n[1]+u]},Yn=function(n,r,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=r<e?r:e,u=r<e?e:r,a=r<e?n:t,c=r<e?t:n,f=[a[0]-c[0],a[1]-c[1]],l=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(l<i&&Math.abs(u-o)<i||l<i)){var v=f.map((function(n,r){return n/l*u+c[r]}));if(Math.abs(u+o-l)<i||Math.abs(u-(o+l))<i)return[v];if(!(l+o<u||u+o<l)){var s=Jn((o*o-l*l-u*u)/(-2*l*u)),h=Xn(c,v,+s),p=Xn(c,v,-s);return[h,p]}}},Hn=function(n,r,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(o),a=0===u?e:e.map((function(n){return n/u})),c=[-a[1],a[0]],f=[t[0]-n[0],t[1]-n[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>r+i)){var v=Math.sqrt(Math.pow(r,2)-Math.pow(l,2)),s=function(r,t){return n[t]-c[t]*l+a[t]*r};return Math.abs(r-Math.abs(l))<i?[v].map((function(n){return[n,n].map(s)})):[-v,v].map((function(n){return[n,n].map(s)}))}},$n=function(n,r,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(o),a=0===u?e:e.map((function(n){return n/u})),c=[-a[1],a[0]],f=[t[0]-n[0],t[1]-n[1]],l=f[0]*a[1]-a[0]*f[1];if(!(Math.abs(l)>r+i)){var v=Math.sqrt(Math.pow(r,2)-Math.pow(l,2)),s=function(r,t){return n[t]-c[t]*l+a[t]*r},h=Math.abs(r-Math.abs(l))<i?[v].map((function(n){return[n,n].map(s)})):[-v,v].map((function(n){return[n,n].map(s)})),p=h.map((function(n){return n.map((function(n,r){return n-t[r]}))})).map((function(n){return n[0]*e[0]+e[1]*n[1]})).map((function(n){return n/o}));return h.filter((function(n,r){return p[r]>-i}))}},Bn=function(n,r,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=t,u=[e[0]-t[0],e[1]-t[1]],a=Math.pow(u[0],2)+Math.pow(u[1],2),c=Math.sqrt(a),f=0===c?u:u.map((function(n){return n/c})),l=[-f[1],f[0]],v=[o[0]-n[0],o[1]-n[1]],s=v[0]*f[1]-f[0]*v[1];if(!(Math.abs(s)>r+i)){var h=Math.sqrt(Math.pow(r,2)-Math.pow(s,2)),p=function(r,t){return n[t]-l[t]*s+f[t]*r},g=Math.abs(r-Math.abs(s))<i?[h].map((function(n){return[n,n].map(p)})):[-h,h].map((function(n){return[n,n].map(p)})),m=g.map((function(n){return n.map((function(n,r){return n-o[r]}))})).map((function(n){return n[0]*u[0]+u[1]*n[1]})).map((function(n){return n/a}));return g.filter((function(n,r){return m[r]>-i&&m[r]<1+i}))}},Cn=function(n,r){return Math.abs(n[0]-r[0])<nn&&Math.abs(n[1]-r[1])<nn},Dn=function(n,r,t){return[]},Un=function(n,r,t){var e=n.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return zn(r,t,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Cn(e[0],e[i]))return[e[0],e[i]];return}},Gn=function(n,r,t){var e=n.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return Zn(r,t,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[r,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Cn(e[0],e[i]))return[e[0],e[i]];return}},Kn=function(n,r,t){var e=n.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return Vn(r,t,n[0],n[1])})).filter((function(n){return null!=n})),i=pn(r,n),o=pn(t,n),u=hn(r,n),a=hn(t,n);if(0===e.length&&(i||o))return[r,t];if(0===e.length&&u&&a)return[r,t];switch(e.length){case 0:return i?[M(r),M(t)]:void 0;case 1:return u?[M(r),e[0]]:[M(t),e[0]];case 2:return e;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},Qn=Object.freeze({__proto__:null,limit_line:kn,limit_ray:Nn,limit_segment:qn,intersection_function:Sn,line_line:In,line_ray:En,line_segment:zn,ray_ray:Rn,ray_segment:Zn,segment_segment:Fn,line_ray_exclusive:function(n,r,t,e,i){return Sn(n,r,t,e,On,i)},line_segment_exclusive:Ln,ray_ray_exclusive:function(n,r,t,e,i){return Sn(n,r,t,e,wn,i)},ray_segment_exclusive:Tn,segment_segment_exclusive:Vn,circle_circle:Yn,circle_line:Hn,circle_ray:$n,circle_segment:Bn,convex_poly_circle:Dn,convex_poly_line:Un,convex_poly_ray:Gn,convex_poly_segment:Kn,convex_poly_ray_exclusive:function(n,r,t){var e=n.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return Tn(r,t,n[0],n[1])})).filter((function(n){return null!=n}));switch(e.length){case 0:return;case 1:return[r,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!Cn(e[0],e[i]))return[e[0],e[i]];return}}}),Wn=function(n,r){var t=n[0]*r[0]+n[1]*r[1],e=n[0]*r[1]-n[1]*r[0],i=Math.atan2(e,t);return i<0&&(i+=2*Math.PI),i},nr=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=r.map((function(n){return Math.atan2(n[1],n[0])})),i=Array.from(Array(e.length)).map((function(n,r){return r})).sort((function(n,r){return e[n]-e[r]}));return i.slice(i.indexOf(0),i.length).concat(i.slice(0,i.indexOf(0)))},rr=function(n,t){var e=r(n),i=r(t),o=e.map((function(n,r){return e[r]+i[r]})),u=r(o),a=e.map((function(n,r){return-e[r]-i[r]}));return[u,r(a)]},tr=function(n,r,t,e){var i=r[0]*e[1]-e[0]*r[1];if(Math.abs(i)<nn){var o=[a(n,t),[r[0],r[1]]],u=[o,o];return delete u[r[0]*e[0]+r[1]*e[1]>0?1:0],u}var c=((t[0]-n[0])*e[1]-e[0]*(t[1]-n[1]))/i,f=n[0]+r[0]*c,l=n[1]+r[1]*c,v=rr(r,e);return v[1]=[v[1][1],-v[1][0]],v.map((function(n){return[[f,l],n]}))},er=function(n,r,t){var e=Wn(r,t)/n;return Array.from(Array(n-1)).map((function(n,t){return r+e*t}))},ir=function(n,r,t){var e=Math.atan2(r[1],r[0]),i=Math.atan2(t[1],t[0]);return er(n,e,i).map((function(n){return[Math.cos(n),Math.sin(n)]}))},or=function(n){return.5*n.map((function(n,r,t){var e=t[(r+1)%t.length];return n[0]*e[1]-e[0]*n[1]})).reduce((function(n,r){return n+r}),0)},ur=function(n){var r=1/(6*or(n));return n.map((function(n,r,t){var e=t[(r+1)%t.length],i=n[0]*e[1]-e[0]*n[1];return[(n[0]+e[0])*i,(n[1]+e[1])*i]})).reduce((function(n,r){return[n[0]+r[0],n[1]+r[1]]}),[0,0]).map((function(n){return n*r}))},ar=function(n){var r=n[0].length,t=Array.from(Array(r)).map((function(){return 1/0})),e=Array.from(Array(r)).map((function(){return-1/0}));n.forEach((function(n){return n.forEach((function(n,r){n<t[r]&&(t[r]=n),n>e[r]&&(e[r]=n)}))}));var i=e.map((function(n,r){return n-t[r]}));return[t,i]},cr=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=2*Math.PI/n*.5,o=e/Math.cos(i);return Array.from(Array(Math.floor(n))).map((function(e,u){var a=-2*Math.PI*u/n+i;return[T(r+o*Math.sin(a),14),T(t+o*Math.cos(a),14)]}))},fr=function(n,r,t){for(var e,i=r.map((function(r,e){return{o:r,i:e,d:t(n,r)}})),o=1/0,u=0;u<i.length;u+=1)i[u].d<o&&(e=u,o=i[u].d);return e},lr=function(n,r,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nn,o=Math.pow(r[0],2)+Math.pow(r[1],2),u=[0,1].map((function(r,e){return t[e]-n[e]})),a=[0,1].map((function(n,t){return r[t]*u[t]})).reduce((function(n,r){return n+r}),0),c=a/o,f=e(c,i);return[0,1].map((function(t,e){return n[e]+r[e]*f}))},vr=function(n,r,t){var e=n.map((function(n,e){return{type:"v",point:vn(r,t,n)?n:null,at_index:e}})).filter((function(n){return null!=n.point})),i=n.map((function(n,e,i){return{type:"e",point:Ln(r,t,n,i[(e+1)%i.length]),at_index:e}})).filter((function(n){return null!=n.point})),o=e.concat(i).sort((function(n,r){return Math.abs(n.point[0]-r.point[0])<nn?n.point[1]-r.point[1]:n.point[0]-r.point[0]}));return console.log(o),n},sr=function(n,r,t){var e=n.map((function(n,e){return{point:vn(r,t,n)?n:null,at_index:e}})).filter((function(n){return null!=n.point})),i=n.map((function(n,e,i){return{point:Ln(r,t,n,i[(e+1)%i.length]),at_index:e}})).filter((function(n){return null!=n.point}));if(2==i.length){var o=i.slice().sort((function(n,r){return n.at_index-r.at_index})),u=n.slice(o[1].at_index+1).concat(n.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var a=n.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[u,a]}if(1==i.length&&1==e.length){e[0].type="v",i[0].type="e";var c=e.concat(i).sort((function(n,r){return n.at_index-r.at_index})),f=n.slice(c[1].at_index+1).concat(n.slice(0,c[0].at_index+1));"e"===c[0].type&&f.push(c[0].point),f.push(c[1].point);var l=n.slice(c[0].at_index+1,c[1].at_index+1);return"e"===c[1].type&&l.push(c[1].point),l.push(c[0].point),[f,l]}if(2==e.length){var v=e.slice().sort((function(n,r){return n.at_index-r.at_index}));return[n.slice(v[1].at_index).concat(n.slice(0,v[0].at_index+1)),n.slice(v[0].at_index,v[1].at_index+1)]}return[n.slice()]},hr=function(n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn,t=1e4,e=n.slice().sort((function(n,t){return Math.abs(n[1]-t[1])<r?n[0]-t[0]:n[1]-t[1]})),i=[];i.push(e[0]);var o=0,u=0,a=function(){u+=1;var n=i.length-1,t=e.filter((function(t){return!(Math.abs(t[0]-i[n][0])<r&&Math.abs(t[1]-i[n][1])<r)})).map((function(r){for(var t=Math.atan2(i[n][1]-r[1],i[n][0]-r[0]);t<o;)t+=2*Math.PI;return{node:r,angle:t,distance:void 0}})).sort((function(n,r){return n.angle<r.angle?-1:n.angle>r.angle?1:0}));if(0===t.length)return{v:void 0};var a=t[0];if(t=t.filter((function(n){return Math.abs(a.angle-n.angle)<r})).map((function(r){var t=Math.sqrt(Math.pow(i[n][0]-r.node[0],2)+Math.pow(i[n][1]-r.node[1],2));return r.distance=t,r})).sort((function(n,r){return n.distance<r.distance?1:n.distance>r.distance?-1:0})),i.filter((function(n){return n===t[0].node})).length>0)return{v:i};i.push(t[0].node),o=Math.atan2(i[n][1]-t[0].node[1],i[n][0]-t[0].node[0])};do{var c=a();if("object"===b(c))return c.v}while(u<t)},pr=Object.freeze({__proto__:null,clockwise_angle2_radians:function(n,r){for(;n<0;)n+=2*Math.PI;for(;r<0;)r+=2*Math.PI;var t=n-r;return t>=0?t:2*Math.PI-(r-n)},counter_clockwise_angle2_radians:function(n,r){for(;n<0;)n+=2*Math.PI;for(;r<0;)r+=2*Math.PI;var t=r-n;return t>=0?t:2*Math.PI-(n-r)},clockwise_angle2:function(n,r){var t=r[0]*n[0]+r[1]*n[1],e=r[0]*n[1]-r[1]*n[0],i=Math.atan2(e,t);return i<0&&(i+=2*Math.PI),i},counter_clockwise_angle2:Wn,counter_clockwise_vector_order:nr,interior_angles2:function(n,r){var t=Wn(n,r);return[t,2*Math.PI-t]},interior_angles:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return r.map((function(n,r,t){return Wn(n,t[(r+1)%t.length])}))},bisect_vectors:rr,bisect_lines2:tr,subsect_radians:er,subsect:ir,signed_area:or,centroid:ur,enclosing_rectangle:ar,make_regular_polygon:cr,nearest_point2:function(n,r){var t=fr(n,r,o);return void 0===t?void 0:r[t]},nearest_point:function(n,r){var t=fr(n,r,u);return void 0===t?void 0:r[t]},nearest_point_on_line:lr,split_polygon:vr,split_convex_polygon:sr,convex_hull:hr}),gr=function(){var n=this;Y(arguments).forEach((function(r){return n.push(r)}))},mr={},dr={preserve:{isEquivalent:function(){var n=Y(arguments),r=this.length<n.length?this:n,t=this.length<n.length?n:this;return en(r,t)},isParallel:function(){var n=Y(arguments),r=this.length<n.length?this:n,t=this.length<n.length?n:this;return ln(r,t)},dot:function(){var n=Y(arguments);return this.length>n.length?t(n,this):t(this,n)},distanceTo:function(){var n=this,r=Y(arguments),t=this.length<r.length?this.length:r.length,e=Array.from(Array(t)).map((function(t,e){return Math.pow(n[e]-r[e],2)})).reduce((function(n,r){return n+r}),0);return Math.sqrt(e)},bisect:function(){var n=Y(arguments);return rr(this,n).map((function(n){return mr.constructor(n)}))}},vector:{copy:function(){return M(this)},normalize:function(){return r(this)},scale:function(n){return this.map((function(r){return r*n}))},cross:function(){var n=Y(arguments),r=this.slice();return null==r[2]&&(r[2]=0),null==n[2]&&(n[2]=0),i(r,n)},transform:function(){return f(C(arguments),this)},add:function(){var n=Y(arguments);return this.map((function(r,t){return r+n[t]}))},subtract:function(){var n=Y(arguments);return this.map((function(r,t){return r-n[t]}))},rotateZ:function(n,r){return f(m(n,r),this)},rotateZ90:function(){return[-this[1],this[0]]},rotateZ180:function(){return[-this[0],-this[1]]},rotateZ270:function(){return[this[1],-this[0]]},flip:function(){return this.map((function(n){return-n}))},reflect:function(){var n=G(arguments),r=d(n.vector,n.origin);return f(r,this)},lerp:function(n,r){var t=this,e=Y(n),i=1-r,o=this.length<e.length?this.length:e.length;return Array.from(Array(o)).map((function(n,o){return t[o]*r+e[o]*i}))},midpoint:function(){for(var n=Y(arguments),r=this.length<n.length?this.slice():n,t=this.length<n.length?n:this.slice(),e=r.length;e<t.length;e+=1)r[e]=0;return t.map((function(n,e){return.5*(r[e]+t[e])}))}}};Object.keys(dr.preserve).forEach((function(n){mr[n]=dr.preserve[n]})),Object.keys(dr.vector).forEach((function(n){mr[n]=function(){return mr.constructor.apply(mr,M(dr.vector[n].apply(this,arguments)))}}));var yr={x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]},magnitude:function(){return n(this)}},br=function n(){var r=Object.create(n.prototype);return gr.apply(r,arguments),Object.keys(yr).forEach((function(n){return Object.defineProperty(r,n,{get:yr[n].bind(r),enumerable:!0})})),Object.keys(mr).forEach((function(n){return Object.defineProperty(r,n,{value:mr[n].bind(r)})})),Object.freeze(r)};(br.prototype=Object.create(Array.prototype)).constructor=br,mr.constructor=br,br.fromAngle=function(n){return br(Math.cos(n),Math.sin(n))},Object.freeze(br);var _r=function n(){for(var r=[1,0,0,1,0,0],t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=C(e);void 0!==o&&o.forEach((function(n,t){r[t]=n}));var u=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n(v(r,C(e)).map((function(n){return T(n,13)})))},a=function(){return T(s(r))},c=function(){return n(h(r).map((function(n){return T(n,13)})))},y=function(t,e){var i=p(t,e);return n(v(r,i).map((function(n){return T(n,13)})))},b=function(){var t=g.apply(void 0,arguments);return n(v(r,t).map((function(n){return T(n,13)})))},_=function(){var t=m.apply(void 0,arguments);return n(v(r,t).map((function(n){return T(n,13)})))},M=function(){var t=d.apply(void 0,arguments);return n(v(r,t).map((function(n){return T(n,13)})))},j=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=Y(t);return br(f(r,i).map((function(n){return T(n,13)})))},O=function(t){return n(f(r,t).map((function(n){return T(n,13)})))},P=function(t,e){return n(l(r,t,e).map((function(n){return T(n,13)})))};return Object.defineProperty(r,"multiply",{value:u}),Object.defineProperty(r,"determinant",{value:a}),Object.defineProperty(r,"inverse",{value:c}),Object.defineProperty(r,"translate",{value:y}),Object.defineProperty(r,"scale",{value:b}),Object.defineProperty(r,"rotate",{value:_}),Object.defineProperty(r,"reflect",{value:M}),Object.defineProperty(r,"transform",{value:j}),Object.defineProperty(r,"transformVector",{value:O}),Object.defineProperty(r,"transformLine",{value:P}),Object.freeze(r)};_r.makeIdentity=function(){return _r(1,0,0,1,0,0)},_r.makeTranslation=function(n,r){return _r(p(n,r))},_r.makeRotation=function(n,r){return _r(m(n,r).map((function(n){return T(n,13)})))},_r.makeScale=function(n,r,t){return _r(g(n,r,t).map((function(n){return T(n,13)})))},_r.makeReflection=function(n,r){return _r(d(n,r).map((function(n){return T(n,13)})))};var Mr=function n(){for(var r=[1,0,0,0,1,0,0,0,1,0,0,0],t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=D(e);void 0!==o&&o.forEach((function(n,t){r[t]=n}));var u=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n(A(r,D(e)).map((function(n){return T(n,13)})))},a=function(){return T(x(r),13)},c=function(){return n(k(r).map((function(n){return T(n,13)})))},f=function(t,e,i){var o=N(t,e,i);return n(A(r,o).map((function(n){return T(n,13)})))},l=function(t){var e=q(t);return n(A(r,e).map((function(n){return T(n,13)})))},v=function(t){var e=S(t);return n(A(r,e).map((function(n){return T(n,13)})))},s=function(t){var e=I(t);return n(A(r,e).map((function(n){return T(n,13)})))},h=function(t,e,i){var o=E(t,e,i);return n(A(r,o).map((function(n){return T(n,13)})))},p=function(t){var e=z(t);return n(A(r,e).map((function(n){return T(n,13)})))},g=function(t,e){var i=R(t,e);return n(A(r,i).map((function(n){return T(n,13)})))},m=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=Y(t);return br(P(i,r).map((function(n){return T(n,13)})))},d=function(t){return n(P(r,t).map((function(n){return T(n,13)})))},y=function(t,e){return n(w(r,t,e).map((function(n){return T(n,13)})))};return Object.defineProperty(r,"multiply",{value:u}),Object.defineProperty(r,"determinant",{value:a}),Object.defineProperty(r,"inverse",{value:c}),Object.defineProperty(r,"translate",{value:f}),Object.defineProperty(r,"rotateX",{value:l}),Object.defineProperty(r,"rotateY",{value:v}),Object.defineProperty(r,"rotateZ",{value:s}),Object.defineProperty(r,"rotate",{value:h}),Object.defineProperty(r,"scale",{value:p}),Object.defineProperty(r,"reflectZ",{value:g}),Object.defineProperty(r,"transform",{value:m}),Object.defineProperty(r,"transformVector",{value:d}),Object.defineProperty(r,"transformLine",{value:y}),Object.freeze(r)};Mr.makeIdentity=function(){return Mr(1,0,0,0,1,0,0,0,1,0,0,0)},Mr.makeTranslation=function(n,r,t){return Mr(N(n,r,t))},Mr.makeRotationX=function(n){return Mr(q(n).map((function(n){return T(n,13)})))},Mr.makeRotationY=function(n){return Mr(S(n).map((function(n){return T(n,13)})))},Mr.makeRotationZ=function(n){return Mr(I(n).map((function(n){return T(n,13)})))},Mr.makeRotation=function(n,r,t){return Mr(E(n,r,t).map((function(n){return T(n,13)})))},Mr.makeScale=function(n,r){return Mr(z(n,r).map((function(n){return T(n,13)})))},Mr.makeReflectionZ=function(n,r){return Mr(R(n,r).map((function(n){return T(n,13)})))};var jr={circle:{poly:function(n,r){return n.origin,n.radius,[]},circle:function(n,r){return Yn(n.origin,n.radius,r.origin,r.radius)},line:function(n,r){return Hn(n.origin,n.radius,r.origin,r.vector)},ray:function(n,r){return $n(n.origin,n.radius,r.origin,r.vector)},segment:function(n,r){return Bn(n.origin,n.radius,r[0],r[1])}},line:{poly:function(n,r){return Un(r,n.origin,n.vector)},circle:function(n,r){return Hn(r.origin,r.radius,n.origin,n.vector)},line:function(n,r){return In(n.origin,n.vector,r.origin,r.vector)},ray:function(n,r){return En(n.origin,n.vector,r.origin,r.vector)},segment:function(n,r){return zn(n.origin,n.vector,r[0],r[1])}},ray:{poly:function(n,r){return Gn(r,n.origin,n.vector)},circle:function(n,r){return $n(r.origin,r.radius,n.origin,n.vector)},line:function(n,r){return En(r.origin,r.vector,n.origin,n.vector)},ray:function(n,r){return Rn(n.origin,n.vector,r.origin,r.vector)},segment:function(n,r){return Zn(n.origin,n.vector,r[0],r[1])}},segment:{poly:function(n,r){return Kn(r,n.origin,n.vector)},circle:function(n,r){return Bn(r.origin,r.radius,n[0],n[1])},line:function(n,r){return zn(r.origin,r.vector,n[0],n[1])},ray:function(n,r){return Zn(r.origin,r.vector,n[0],n[1])},segment:function(n,r){return Fn(n[0],n[1],r[0],r[1])}}},Or=function(n,r){var t=F(n),e=F(r);return(0,jr[t][e])(n,r)};function Pr(n,r){var t=null!=r?r:{},e=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,t)&&!0},i=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,t)&&r>=-t},o=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nn;return this.compare_function(n,t)&&r>=-t&&r<=1+t};return Object.defineProperty(t,"isParallel",{value:function(n,r){if(null==n.vector)throw new Error("isParallel() argument is missing a vector");var t=this.vector.length<n.vector.length,e=t?this.vector:n.vector,i=t?n.vector:this.vector;return ln(e,i)}}),Object.defineProperty(t,"isDegenerate",{value:function(){return fn(this.vector)}}),Object.defineProperty(t,"nearestPoint",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=Y(r);return br(lr(this.origin,this.vector,e,this.clip_function))}}),Object.defineProperty(t,"reflection",{value:function(){return _r.makeReflection(this.vector,this.origin)}}),Object.defineProperty(t,"intersect",{value:function(n){return Or(this,n)}}),Object.defineProperty(t,"intersectLine",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var i=G(r);return Sn(this.origin,this.vector,i.origin,i.vector,e.bind(this))}}),Object.defineProperty(t,"intersectRay",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=K(r);return Sn(this.origin,this.vector,e.origin,e.vector,i.bind(this))}}),Object.defineProperty(t,"intersectSegment",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=U(r),i=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return Sn(this.origin,this.vector,e[0],i,o.bind(this))}}),Object.defineProperty(t,"bisectLine",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=G(r);return tr(this.origin,this.vector,e.origin,e.vector)}}),Object.defineProperty(t,"bisectRay",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=K(r);return tr(this.origin,this.vector,e.origin,e.vector)}}),Object.defineProperty(t,"bisectSegment",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=U(r),i=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return tr(this.origin,this.vector,e[0],i)}}),Object.freeze(t)}var wr=function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=G(t),o=i.origin,u=i.vector,a=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=C(t),a=l(i,o,u);return n(a[0],a[1])},c=Pr.bind(this),f=Object.create(c(n)),v=function(){return!0};return Object.defineProperty(f,"compare_function",{value:v}),Object.defineProperty(f,"clip_function",{value:kn}),f.origin=br(o),f.vector=br(u),Object.defineProperty(f,"length",{get:function(){return 1/0}}),Object.defineProperty(f,"transform",{value:a}),f};wr.fromPoints=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=H(r);return wr({origin:e[0],vector:[e[1][0]-e[0][0],e[1][1]-e[0][1]]})},wr.perpendicularBisector=function(){for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];var o=H(t),u=r([o[1][0]-o[0][0],o[1][1]-o[0][1]]);return wr({origin:e(o[0],o[1]),vector:[u[1],-u[0]]})};var Ar=function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=G(t),o=i.origin,u=i.vector,a=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=C(t),a=u.map((function(n,r){return n+o[r]})),c=f(i,o),l=f(i,a).map((function(n,r){return n-c[r]}));return n(c,l)},c=function(){return n(o[0],o[1],-u[0],-u[1])},l=Pr.bind(this),v=Object.create(l(n)),s=function(n,r){return n>=-r};return Object.defineProperty(v,"origin",{get:function(){return br(o)}}),Object.defineProperty(v,"vector",{get:function(){return br(u)}}),Object.defineProperty(v,"length",{get:function(){return 1/0}}),Object.defineProperty(v,"transform",{value:a}),Object.defineProperty(v,"rotate180",{value:c}),Object.defineProperty(v,"compare_function",{value:s}),Object.defineProperty(v,"clip_function",{value:Nn}),v};Ar.fromPoints=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];var i=H(t);return Ar({origin:i[0],vector:r([i[1][0]-i[0][0],i[1][1]-i[0][1]])})};var xr=function n(){for(var r=arguments.length,t=new Array(r),i=0;i<r;i++)t[i]=arguments[i];var o=H(t),u=Pr.bind(this),a=o.length>0?o.map((function(n){return br(n)})):void 0;if(void 0!==a){var c=Object.create(u(n,a)),l=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=C(t),o=c.map((function(n){return f(i,n)}));return n(o)},v=function(r){var t=e(c[0],c[1]),i=c.map((function(n){return n.lerp(t,r)}));return n(i)},s=function(){return br(c[1][0]-c[0][0],c[1][1]-c[0][1])},h=function(){return br(e(c[0],c[1]))},p=function(){return Math.sqrt(Math.pow(c[1][0]-c[0][0],2)+Math.pow(c[1][1]-c[0][1],2))},g=function(n,r){return n>=-r&&n<=1+r};return Object.defineProperty(c,"origin",{get:function(){return c[0]}}),Object.defineProperty(c,"vector",{get:function(){return s()}}),Object.defineProperty(c,"midpoint",{value:h}),Object.defineProperty(c,"magnitude",{get:function(){return p()}}),Object.defineProperty(c,"transform",{value:l}),Object.defineProperty(c,"scale",{value:v}),Object.defineProperty(c,"compare_function",{value:g}),Object.defineProperty(c,"clip_function",{value:qn}),c}},kr=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],e=[Y(n),Y(r)],i=function(){var n=Wn(e[0],e[1]),r=e.map((function(n){return Math.atan2(n[1],n[0])}))[0]+.5*n;return br(Math.cos(r),Math.sin(r))},o=function(n){return ir(n,e[0],e[1]).map((function(n){return br(n[0],n[1])}))},u=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=Y(r).map((function(n,r){return n+t[r]})),u=(o[1]-e[0][1])*-e[0][0]-(o[0]-e[0][0])*-e[0][1],a=o[1]*e[1][0]-o[0]*e[1][1];return u<0&&a<0};return{contains:u,bisect:i,subsect:o,get center(){return t},get vectors(){return e},get angle(){return Wn(e[0],e[1])}}};function Nr(n){var r={},t=n,i=function(){return or(this.points)},u=function(){return this.points.map((function(n,r,t){var e=(r+t.length-1)%t.length,i=(r+1)%t.length,o=n,u=t[e].map((function(n,r){return n-o[r]})),a=t[i].map((function(n,r){return n-o[r]}));return kr(a,u,o)}))};return Object.defineProperty(r,"area",{value:i}),Object.defineProperty(r,"centroid",{value:function(){return ur(this.points)}}),Object.defineProperty(r,"midpoint",{value:function(){return e(this.points)}}),Object.defineProperty(r,"enclosingRectangle",{value:function(){return ar(this.points)}}),Object.defineProperty(r,"contains",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return sn(Y(r),this.points)}}),Object.defineProperty(r,"nearest",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e,i=Y(r),u=this.sides.map((function(n){return n.nearestPoint(i)})),a=1/0;return u.map((function(n){return o(i,n)})).forEach((function(n,r){n<a&&(a=n,e=r)})),{point:u[e],edge:this.sides[e]}}}),Object.defineProperty(r,"clipSegment",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=U(r),i=Kn(this.points,e[0],e[1]);return void 0===i?void 0:xr(i)}}),Object.defineProperty(r,"clipLine",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=G(r),i=Un(this.points,e.origin,e.vector);return void 0===i?void 0:xr(i)}}),Object.defineProperty(r,"clipRay",{value:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=G(r),i=Gn(this.points,e.origin,e.vector);return void 0===i?void 0:xr(i)}}),Object.defineProperty(r,"split",{value:function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=G(r);return vr(this.points,i.origin,i.vector).map((function(n){return t(n)}))}}),Object.defineProperty(r,"scale",{value:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ur(this.points),e=this.points.map((function(n){return[0,1].map((function(t,e){return n[e]-r[e]}))})).map((function(t){return t.map((function(e,i){return r[i]+t[i]*n}))}));return t(e)}}),Object.defineProperty(r,"rotate",{value:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ur(this.points),e=this.points.map((function(t){var e=[t[0]-r[0],t[1]-r[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[r[0]+Math.cos(o+n)*i,r[1]+Math.sin(o+n)*i]}));return t(e)}}),Object.defineProperty(r,"translate",{value:function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=Y(r),o=this.points.map((function(n){return n.map((function(n,r){return n+i[r]}))}));return t(o)}}),Object.defineProperty(r,"transform",{value:function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=C(r),o=this.points.map((function(n){return br(f(i,n))}));return t(o)}}),Object.defineProperty(r,"edges",{get:function(){return this.sides}}),Object.defineProperty(r,"sectors",{get:function(){return u.call(this)}}),Object.defineProperty(r,"signedArea",{value:i}),Object.freeze(r)}kr.fromVectors=function(n,r){return kr(n,r)},kr.fromPoints=function(n,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],e=[n,r].map((function(n){return n.map((function(r,e){return n[e]-t[e]}))}));return kr(e[0],e[1],t)};var qr=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=H(r).map((function(n){return br(n)}));if(void 0!==e){var i=e.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return xr(n[0][0],n[0][1],n[1][0],n[1][1])})),o=Nr.bind(this),u=Object.create(o());return Object.defineProperty(u,"points",{get:function(){return e}}),Object.defineProperty(u,"sides",{get:function(){return i}}),u}};qr.regularPolygon=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=cr(n,r,t,e);return qr(i)},qr.convexHull=function(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=hr(n,r);return qr(t)};var Sr=function n(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var i=Q(t).map((function(n){return br(n)}));if(void 0!==i){var o=i.map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return xr(n[0][0],n[0][1],n[1][0],n[1][1])})),u=Nr.bind(this),a=Object.create(u(n)),c=function(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];var o=G(t);return sr(i,o.origin,o.vector).map((function(r){return n(r)}))},f=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=Q(r);return gn(i,e)},l=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ur(a.points),e=a.points.map((function(n){return[0,1].map((function(r,e){return n[e]-t[e]}))})).map((function(n){return n.map((function(e,i){return t[i]+n[i]*r}))}));return n(e)},v=function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ur(a.points),e=a.points.map((function(n){var e=[n[0]-t[0],n[1]-t[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[t[0]+Math.cos(o+r)*i,t[1]+Math.sin(o+r)*i]}));return n(e)};return Object.defineProperty(a,"points",{get:function(){return i}}),Object.defineProperty(a,"sides",{get:function(){return o}}),Object.defineProperty(a,"split",{value:c}),Object.defineProperty(a,"overlaps",{value:f}),Object.defineProperty(a,"scale",{value:l}),Object.defineProperty(a,"rotate",{value:v}),a}};Sr.regularPolygon=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=cr(n,r,t,e);return Sr(i)},Sr.convexHull=function(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=hr(n,r);return Sr(t)};var Ir=function n(){for(var r,t,e,i=arguments.length,o=new Array(i),u=0;u<i;u++)o[u]=arguments[u];var a=Array.from(o),c=a.filter((function(n){return!isNaN(n)})),f=a.filter((function(n){return n.constructor===Array}));if(4===c.length){r=br(c.slice(0,2));var l=_(c,4);t=l[2],e=l[3]}1===f.length&&(f=f[0]),2===f.length&&"number"==typeof f[0][0]&&(r=br(f[0].slice()),t=f[1][0],e=f[1][1]);var v=[[r[0],r[1]],[r[0]+t,r[1]],[r[0]+t,r[1]+e],[r[0],r[1]+e]],s=Nr.bind(this),h=Object.create(s(n)),p=function(i,o){var u=null!=o?o:[r[0]+t,r[1]+e],a=r[0]+(u[0]-r[0])*(1-i),c=r[1]+(u[1]-r[1])*(1-i);return n(a,c,t*i,e*i)},g=function(){var n;return(n=Sr(v)).rotate.apply(n,arguments)},m=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];return Sr(v).transform(r)};return Object.defineProperty(h,"points",{get:function(){return v}}),Object.defineProperty(h,"origin",{get:function(){return r}}),Object.defineProperty(h,"width",{get:function(){return t}}),Object.defineProperty(h,"height",{get:function(){return e}}),Object.defineProperty(h,"area",{get:function(){return t*e}}),Object.defineProperty(h,"scale",{value:p}),Object.defineProperty(h,"rotate",{value:g}),Object.defineProperty(h,"transform",{value:m}),h};Ir.fromPoints=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=H(r),i=ar(e);return Ir(i)};var Er=function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];var e=H(r);if(void 0!==e){var i=nr.apply(void 0,M(e)),o=function(){return i.map((function(n){return e[n]})).map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return kr.fromVectors(n[0],n[1])}))},u=function(){return i.map((function(n){return e[n]})).map((function(n,r,t){return[n,t[(r+1)%t.length]]})).map((function(n){return Wn(n[0],n[1])}))};return{sectors:o,angles:u,get vectors(){return e},get vectorOrder(){return M(i)}}}};Er.fromVectors=function(){return Er.apply(void 0,arguments)},Er.fromPoints=function(n,r){var t=r.map((function(r){return r.map((function(t,e){return r[e]-n[e]}))}));return Er.fromVectors(t)};var zr=Object.create(null);return Object.assign(zr,c,y,Z,pr,mn,on),zr.clean_number=T,zr.flatten_input=J,zr.semi_flatten_input=X,Object.keys(W).filter((function(n){return/^is_/g.test(n)})).forEach((function(n){zr[n]=W[n]})),Object.keys(W).filter((function(n){return/^get_/g.test(n)})).forEach((function(n){zr[n]=W[n]})),zr.intersection=Qn,Object.freeze(zr),{vector:br,matrix2:_r,matrix:Mr,line:wr,ray:Ar,segment:xr,circle:function(){for(var n,r,t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var u=e.filter((function(n){return!isNaN(n)})),a=H(e);if(3===u.length){n=br(u[0],u[1]);var c=_(u,3);r=c[2]}else 2===a.length&&(r=o.apply(void 0,M(a)),n=br.apply(void 0,M(a[0])));var f=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=G(e),u=Hn(n,r,o.origin,o.vector);return void 0===u?void 0:u.map((function(n){return br(n)}))},l=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=K(e),u=$n(n,r,o.origin,o.vector);return void 0===u?void 0:u.map((function(n){return br(n)}))},v=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var o=H(e),u=Bn(n,r,o[0],o[1]);return void 0===u?void 0:u.map((function(n){return br(n)}))},s={intersectionLine:f,intersectionRay:l,intersectionSegment:v,get origin(){return n},get x(){return n[0]},get y(){return n[1]},get radius(){return r},intersect:function(n){return Or(s,n)}};return s},polygon:qr,convexPolygon:Sr,rectangle:Ir,junction:Er,sector:kr,core:zr}}));
