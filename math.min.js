!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).math=n()}(this,(function(){"use strict";var t={};function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var o=function(t){if("object"===n(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rectangle";if(null!=t.x)return"vector";if(null!=t.rotate180)return"ray";if(null!=t[0]&&t[0].length&&null!=t[0].x)return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},i=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},u=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return i(r,t)}))},c=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},a=function t(){switch(arguments.length){case void 0:case 0:return arguments;case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return c(n)?r(t(n)):n}))}},f=function(){var t=a(arguments);return t.length>1?t.reduce((function(t,n){return t.concat(n)}),[]):t},p=function(){var t=f(arguments);return t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(n){return t[0][n]})).filter((function(t){return void 0!==t}))),t.filter((function(t){return"number"==typeof t}))},h=function(){return a(arguments).map((function(t){return p(t)}))},s=[1,0,0,1,0,0],l=function(){var t=p(arguments);if(void 0!==t)return 6===t.length?t:t.length>6?[t[0],t[1],t[2],t[3],t[4],t[5]]:t.length<6?s.map((function(n,r){return t[r]||n})):void 0};function v(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return h(n)}function g(){if(4===arguments.length)return{origin:[arguments[0],arguments[1]],vector:[arguments[2],arguments[3]]};var t=Array.from(arguments),n=t.filter((function(t){return!isNaN(t)})),e=t.filter((function(t){return t.constructor===Array}));if(0===t.length)return{vector:[],origin:[]};if(!isNaN(t[0])&&n.length>=4)return{origin:[t[0],t[1]],vector:[t[2],t[3]]};if(e.length>0){if(1===e.length)return g.apply(void 0,r(e[0]));if(2===e.length)return{origin:[e[0][0],e[0][1]],vector:[e[1][0],e[1][1]]};if(4===e.length)return{origin:[e[0],e[1]],vector:[e[2],e[3]]}}if(t[0].constructor===Object){var o=[],i=[];return null!=t[0].vector?o=p(t[0].vector):null!=t[0].direction&&(o=p(t[0].direction)),null!=t[0].origin?i=p(t[0].origin):null!=t[0].point&&(i=p(t[0].point)),{origin:i,vector:o}}return{origin:[],vector:[]}}function y(){return g.apply(void 0,arguments)}var m=function(t){return Math.sqrt(t.map((function(t){return t*t})).reduce((function(t,n){return t+n}),0))},d=function(t){var n=m(t);return 0===n?t:t.map((function(t){return t/n}))},M=function(t,n){return t.map((function(r,e){return t[e]*n[e]})).reduce((function(t,n){return t+n}),0)},b=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=n.length>0?n[0].length:0,o=Array(e).fill(0);return n.forEach((function(t){return o.forEach((function(n,r){o[r]+=t[r]||0}))})),o.map((function(t){return t/n.length}))},w=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[0]*n[2]-t[2]*n[0],t[0]*n[1]-t[1]*n[0]]},A=function(t,n){var r=t[0]-n[0],e=t[1]-n[1];return Math.sqrt(r*r+e*e)},S=function(t,n){return 1-Math.abs(M(d(t),d(n)))<1e-6},j=function(t,n){for(var r=!1,e=0,o=n.length-1;e<n.length;o=e++)n[e][1]>t[1]!=n[o][1]>t[1]&&t[0]<(n[o][0]-n[e][0])*(t[1]-n[e][1])/(n[o][1]-n[e][1])+n[e][0]&&(r=!r);return r},O=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return null!=n&&n.length>0&&n.map((function(n,e,o){var i=o[(e+1)%o.length],u=[i[0]-n[0],i[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>-r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},_=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return null!=n&&n.length>0&&n.map((function(n,e,o){var i=o[(e+1)%o.length],u=[i[0]-n[0],i[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},P=function(t,n){return t[0]*n[1]-n[0]*t[1]},E=function(){return!0},x=function(t,n){return n>=-1e-6},q=function(t,n){return n>=-1e-6&&n<=1.000001},N=function(t,n){return t>=-1e-6&&n>=-1e-6},k=function(t,n){return t>=-1e-6&&n>=-1e-6&&n<=1.000001},G=function(t,n){return t>=-1e-6&&t<=1.000001&&n>=-1e-6&&n<=1.000001},R=function(t,n){return n>1e-6&&n<.999999},z=function(t,n){return t>1e-6&&t<.999999&&n>1e-6&&n<.999999},I=function(t,n,r,e,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1e-6,u=P(n,e);if(!(Math.abs(u)<i)){var c=-u,a=P([r[0]-t[0],r[1]-t[1]],e),f=P([t[0]-r[0],t[1]-r[1]],n),p=a/u,h=f/c;return o(p,h,i)?[t[0]+n[0]*p,t[1]+n[1]*p]:void 0}},L=function(t,n,r,e,o){return I(t,n,r,e,x,o)},Z=function(t,n,r,e,o){var i=[e[0]-r[0],e[1]-r[1]];return I(t,n,r,i,q,o)},T=function(t,n,r,e,o){var i=[e[0]-r[0],e[1]-r[1]];return I(t,n,r,i,k,o)},B=function(t){return t>=1?0:t<=-1?Math.PI:Math.acos(t)},C=function(t,n,r){var e=n[0]-t[0],o=n[1]-t[1],i=e*Math.cos(r)+o*Math.sin(r),u=o*Math.cos(r)-e*Math.sin(r);return[t[0]+i,t[1]+u]},D=function(t,n,r,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-6,i=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(i),c=0===u?e:e.map((function(t){return t/u})),a=[-c[1],c[0]],f=[r[0]-t[0],r[1]-t[1]],p=f[0]*c[1]-c[0]*f[1];if(!(Math.abs(p)>n+o)){var h=Math.sqrt(Math.pow(n,2)-Math.pow(p,2)),s=function(n,r){return t[r]-a[r]*p+c[r]*n};return Math.abs(n-Math.abs(p))<o?[h].map((function(t){return[t,t].map(s)})):[-h,h].map((function(t){return[t,t].map(s)}))}},U=function(t,n,r,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-6,i=Math.pow(e[0],2)+Math.pow(e[1],2),u=Math.sqrt(i),c=0===u?e:e.map((function(t){return t/u})),a=[-c[1],c[0]],f=[r[0]-t[0],r[1]-t[1]],p=f[0]*c[1]-c[0]*f[1];if(!(Math.abs(p)>n+o)){var h=Math.sqrt(Math.pow(n,2)-Math.pow(p,2)),s=function(n,r){return t[r]-a[r]*p+c[r]*n},l=Math.abs(n-Math.abs(p))<o?[h].map((function(t){return[t,t].map(s)})):[-h,h].map((function(t){return[t,t].map(s)})),v=l.map((function(t){return t.map((function(t,n){return t-r[n]}))})).map((function(t){return t[0]*e[0]+e[1]*t[1]})).map((function(t){return t/i}));return l.filter((function(t,n){return v[n]>-o}))}},V=function(t,n,r,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-6,i=r,u=[e[0]-r[0],e[1]-r[1]],c=Math.pow(u[0],2)+Math.pow(u[1],2),a=Math.sqrt(c),f=0===a?u:u.map((function(t){return t/a})),p=[-f[1],f[0]],h=[i[0]-t[0],i[1]-t[1]],s=h[0]*f[1]-f[0]*h[1];if(!(Math.abs(s)>n+o)){var l=Math.sqrt(Math.pow(n,2)-Math.pow(s,2)),v=function(n,r){return t[r]-p[r]*s+f[r]*n},g=Math.abs(n-Math.abs(s))<o?[l].map((function(t){return[t,t].map(v)})):[-l,l].map((function(t){return[t,t].map(v)})),y=g.map((function(t){return t.map((function(t,n){return t-i[n]}))})).map((function(t){return t[0]*u[0]+u[1]*t[1]})).map((function(t){return t/c}));return g.filter((function(t,n){return y[n]>-o&&y[n]<1+o}))}},$=function(t,n){return Math.abs(t[0]-n[0])<1e-6&&Math.abs(t[1]-n[1])<1e-6},F=function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return Z(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var o=1;o<e.length;o+=1)if(!$(e[0],e[o]))return[e[0],e[o]];return}},H=function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return T(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[n,e[0]];case 2:return e;default:for(var o=1;o<e.length;o+=1)if(!$(e[0],e[o]))return[e[0],e[o]];return}},J=function(t,n,e){var o=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return r=n,o=e,i=t[0],u=t[1],a=[o[0]-r[0],o[1]-r[1]],f=[u[0]-i[0],u[1]-i[1]],I(r,a,i,f,z,c);var r,o,i,u,c,a,f})).filter((function(t){return null!=t})),i=_(n,t),u=_(e,t),c=O(n,t),a=O(e,t);if(0===o.length&&(i||u))return[n,e];if(0===o.length&&c&&a)return[n,e];switch(o.length){case 0:return i?[r(n),r(e)]:void 0;case 1:return c?[r(n),o[0]]:[r(e),o[0]];case 2:return o;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},K=function(t,n){var r=d(t),e=d(n),o=r.map((function(t,n){return r[n]+e[n]})),i=d(o),u=r.map((function(t,n){return-r[n]-e[n]}));return[i,d(u)]},Q=function(t,n,r,e){var o,i,u=n[0]*e[1]-e[0]*n[1];if(Math.abs(u)<1e-6){var c=[(o=t,i=r,o.map((function(t,n){return(o[n]+i[n])/2}))),[n[0],n[1]]],a=[c,c];return delete a[n[0]*e[0]+n[1]*e[1]>0?1:0],a}var f=((r[0]-t[0])*e[1]-e[0]*(r[1]-t[1]))/u,p=t[0]+n[0]*f,h=t[1]+n[1]*f,s=K(n,e);return s[1]=[s[1][1],-s[1][0]],s.map((function(t){return[[p,h],t]}))},W=function(t){return.5*t.map((function(t,n,r){var e=r[(n+1)%r.length];return t[0]*e[1]-e[0]*t[1]})).reduce((function(t,n){return t+n}),0)},X=function(t){var n=1/(6*W(t));return t.map((function(t,n,r){var e=r[(n+1)%r.length],o=t[0]*e[1]-e[0]*t[1];return[(t[0]+e[0])*o,(t[1]+e[1])*o]})).reduce((function(t,n){return[t[0]+n[0],t[1]+n[1]]}),[0,0]).map((function(t){return t*n}))},Y=function(t){var n=Array(t[0].length).fill(1/0),r=Array(t[0].length).fill(-1/0);t.forEach((function(t){return t.forEach((function(t,e){t<n[e]&&(n[e]=t),t>r[e]&&(r[e]=t)}))}));var e=r.map((function(t,r){return t-n[r]}));return[n,e]},tt=function(t,n,r){var e=t.map((function(t,e){return{type:"v",point:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,o=[r[0]-t[0],r[1]-t[1]],i=o[0]*n[1]-o[1]*n[0];return Math.abs(i)<e}(n,r,t)?t:null,at_index:e}})).filter((function(t){return null!=t.point})),o=t.map((function(t,e,o){var i,u,c,a,f,p;return{type:"e",point:(i=n,u=r,c=t,a=o[(e+1)%o.length],p=[a[0]-c[0],a[1]-c[1]],I(i,u,c,p,R,f)),at_index:e}})).filter((function(t){return null!=t.point})),i=e.concat(o).sort((function(t,n){return Math.abs(t.point[0]-n.point[0])<1e-6?t.point[1]-n.point[1]:t.point[0]-n.point[0]}));return console.log(i),t},nt=function(t,n){return[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]]},rt=function(t,n,r){return{origin:[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]],vector:[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1]]}},et={preserve:{magnitude:function(){return m(this)},isEquivalent:function(){var t=u(this,p(arguments));return t[0].map((function(n,r){return Math.abs(t[0][r]-t[1][r])<1e-6})).reduce((function(t,n){return t&&n}),!0)},isParallel:function(){return S.apply(void 0,r(u(this,p(arguments))))},dot:function(){return M.apply(void 0,r(lengthSort(this,p(arguments))))},distanceTo:function(){var t=u(this,p(arguments));return Math.sqrt(t.map((function(n,r){return Math.pow(t[0][r]-t[1][r],2)})).reduce((function(t,n){return t+n}),0))},bisect:function(){return K(this,p(arguments)).map((function(n){return t.vector(n)}))}},vector:{copy:function(){return r(this)},normalize:function(){return d(this)},scale:function(t){return this.map((function(n){return n*t}))},cross:function(){return w(i(3,this),i(3,p(arguments)))},add:function(){var t=this;return i(this.length,p(arguments)).map((function(n,r){return t[r]+n}))},subtract:function(){var t=this;return i(this.length,p(arguments)).map((function(n,r){return t[r]-n}))},rotateZ90:function(){return[-this[1],this[0]]},rotateZ180:function(){return[-this[0],-this[1]]},rotateZ270:function(){return[this[1],-this[0]]},flip:function(){return this.map((function(t){return-t}))},lerp:function(t,n){var r=this,e=1-n;return i(this.length,p(t)).map((function(t,o){return r[o]*e+t*n}))},midpoint:function(){var t=u(this,p(arguments));return t[0].map((function(n,r){return(t[0][r]+t[1][r])/2}))}}},ot={};Object.keys(et.preserve).forEach((function(t){ot[t]=et.preserve[t]})),Object.keys(et.vector).forEach((function(n){ot[n]=function(){return t.vector.apply(t,r(et.vector[n].apply(this,arguments)))}}));var it={fromAngle:function(n){return t.vector(Math.cos(n),Math.sin(n))}},ut={vector:{P:Array.prototype,A:function(){var t=this;p(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:ot,S:it}},ct={circle:{poly:function(t,n){return t.origin,t.radius,[]},circle:function(t,n){return function(t,n,r,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-6,i=n<e?n:e,u=n<e?e:n,c=n<e?t:r,a=n<e?r:t,f=[c[0]-a[0],c[1]-a[1]],p=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(p<o&&Math.abs(u-i)<o||p<o)){var h=f.map((function(t,n){return t/p*u+a[n]}));if(Math.abs(u+i-p)<o||Math.abs(u-(i+p))<o)return[h];if(!(p+i<u||u+i<p)){var s=B((i*i-p*p-u*u)/(-2*p*u)),l=C(a,h,+s),v=C(a,h,-s);return[l,v]}}}(t.origin,t.radius,n.origin,n.radius)},line:function(t,n){return D(t.origin,t.radius,n.origin,n.vector)},ray:function(t,n){return U(t.origin,t.radius,n.origin,n.vector)},segment:function(t,n){return V(t.origin,t.radius,n[0],n[1])}},line:{poly:function(t,n){return F(n,t.origin,t.vector)},circle:function(t,n){return D(n.origin,n.radius,t.origin,t.vector)},line:function(t,n){return r=t.origin,e=t.vector,o=n.origin,i=n.vector,I(r,e,o,i,E,u);var r,e,o,i,u},ray:function(t,n){return L(t.origin,t.vector,n.origin,n.vector)},segment:function(t,n){return Z(t.origin,t.vector,n[0],n[1])}},ray:{poly:function(t,n){return H(n,t.origin,t.vector)},circle:function(t,n){return U(n.origin,n.radius,t.origin,t.vector)},line:function(t,n){return L(n.origin,n.vector,t.origin,t.vector)},ray:function(t,n){return r=t.origin,e=t.vector,o=n.origin,i=n.vector,I(r,e,o,i,N,u);var r,e,o,i,u},segment:function(t,n){return T(t.origin,t.vector,n[0],n[1])}},segment:{poly:function(t,n){return J(n,t.origin,t.vector)},circle:function(t,n){return V(n.origin,n.radius,t[0],t[1])},line:function(t,n){return Z(n.origin,n.vector,t[0],t[1])},ray:function(t,n){return T(n.origin,n.vector,t[0],t[1])},segment:function(t,n){return r=t[0],e=t[1],o=n[0],i=n[1],c=[e[0]-r[0],e[1]-r[1]],a=[i[0]-o[0],i[1]-o[1]],I(r,c,o,a,G,u);var r,e,o,i,u,c,a}}},at={circle:{A:function(){var n=Array.from(arguments),e=n.filter((function(t){return!isNaN(t)})),o=h(n);3===e.length?(this.origin=t.vector(e[0],e[1]),this.radius=e[2]):2===o.length&&(this.radius=A.apply(void 0,r(o)),this.origin=t.vector.apply(t,r(o[0])))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{},S:{fromPoints:function(){var n=h(innerArgs);return t.circle(n,A(n[0],n[1]))}}}},ft=function(){};ft.prototype.area=function(){return W(this.points)},ft.prototype.midpoint=function(){return b(this.points)},ft.prototype.centroid=function(){return X(this.points)},ft.prototype.enclosingRectangle=function(){return Y(this.points)},ft.prototype.contains=function(){return j(p(arguments),this.points)},ft.prototype.scale=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X(this.points),e=this.points.map((function(t){return[0,1].map((function(n,e){return t[e]-r[e]}))})).map((function(t){return t.map((function(e,o){return r[o]+t[o]*n}))}));return t.polygon(e)},ft.prototype.rotate=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X(this.points),e=this.points.map((function(t){var e=[t[0]-r[0],t[1]-r[1]],o=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),i=Math.atan2(e[1],e[0]);return[r[0]+Math.cos(i+n)*o,r[1]+Math.sin(i+n)*o]}));return t.polygon(e)},ft.prototype.translate=function(){var n=p(arguments),r=this.points.map((function(t){return t.map((function(t,r){return t+n[r]}))}));return t.polygon(r)},ft.prototype.transform=function(){var n=l(arguments),r=this.points.map((function(t){return nt(n,t)}));return t.polygon(r)},ft.prototype.sectors=function(){return this.points.map((function(n,r,e){var o=(r+e.length-1)%e.length,i=(r+1)%e.length,u=n,c=e[o].map((function(t,n){return t-u[n]})),a=e[i].map((function(t,n){return t-u[n]}));return t.sector(a,c,u)}))},ft.prototype.enclosingRectangle=function(){return t.rect(Y(this.points))},ft.prototype.clipSegment=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=v(n),o=J(this.points,e[0],e[1]);return void 0===o?void 0:Segment(o)},ft.prototype.clipLine=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n),o=F(this.points,e.origin,e.vector);return void 0===o?void 0:Segment(o)},ft.prototype.clipRay=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n),o=H(this.points,e.origin,e.vector);return void 0===o?void 0:Segment(o)},ft.prototype.split=function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var o=g(r);return tt(this.points,o.origin,o.vector).map((function(n){return t.polygon(n)}))};var pt=function(t,n,r,e){return[[t,n],[t+r,n],[t+r,n+e],[t,n+e]]},ht=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},st={rect:{P:ft.prototype,A:function(){var t=ht(4,f(arguments));this.origin=[t[0],t[1]],this.width=t[2],this.height=t[3],this.points=pt.apply(void 0,r(t))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{area:function(){return this.width*this.height},scale:function(n,r){var e=null!=r?r:[this.origin[0]+this.width,this.origin[1]+this.height],o=this.origin[0]+(e[0]-this.origin[0])*(1-n),i=this.origin[1]+(e[1]-this.origin[1])*(1-n);return t.rect(o,i,this.width*n,this.height*n)}},S:{fromPoints:function(){return t.rect(Y(h(arguments)))}}}},lt={polygon:{P:ft.prototype,A:function(){this.points=a(arguments)},G:{},M:{},S:{}}},vt=function(t,n,r,e){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EPSILON,i=Math.pow(n[0],2)+Math.pow(n[1],2),u=[0,1].map((function(n,e){return r[e]-t[e]})),c=[0,1].map((function(t,r){return n[r]*u[r]})).reduce((function(t,n){return t+n}),0),a=c/i,f=e(a,o);return[0,1].map((function(r,e){return t[e]+n[e]*f}))},gt=function(){};gt.prototype.compare_to_line=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return this.compare_function(t,r)&&!0},gt.prototype.compare_to_ray=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return this.compare_function(t,r)&&n>=-r},gt.prototype.compare_to_segment=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return this.compare_function(t,r)&&n>=-r&&n<=1+r},gt.prototype.isParallel=function(){var t=u(this.vector,g.apply(void 0,arguments).vector);return console.log(arguments,this.vector,g.apply(void 0,arguments).vector,t),S.apply(void 0,r(t))},gt.prototype.isDegenerate=function(){return t=this.vector,Math.abs(t.reduce((function(t,n){return t+n}),0))<1e-6;var t},gt.prototype.reflection=function(){return Matrix2.makeReflection(this.vector,this.origin)},gt.prototype.nearestPoint=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=p(n);return Vector(vt(this.origin,this.vector,e,this.clip_function))},gt.prototype.intersect=function(t){return r=t,e=o(n=this),i=o(r),(0,ct[e][i])(n,r);var n,r,e,i},gt.prototype.intersectLine=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n);return I(this.origin,this.vector,e.origin,e.vector,compare_to_line.bind(this))},gt.prototype.intersectRay=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=y(n);return I(this.origin,this.vector,e.origin,e.vector,compare_to_ray.bind(this))},gt.prototype.intersectSegment=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=v(n),o=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return I(this.origin,this.vector,e[0],o,compare_to_segment.bind(this))},gt.prototype.bisectLine=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n);return Q(this.origin,this.vector,e.origin,e.vector)},gt.prototype.bisectRay=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=y(n);return Q(this.origin,this.vector,e.origin,e.vector)},gt.prototype.bisectSegment=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=v(n),o=[e[1][0]-e[0][0],e[1][1]-e[0][1]];return Q(this.origin,this.vector,e[0],o)};var yt={line:{P:gt.prototype,A:function(){var n=g.apply(void 0,arguments);this.origin=t.vector(n.origin),this.vector=t.vector(n.vector)},G:{length:function(){return 1/0}},M:{area:function(){return this.width*this.height},transform:function(){var t=l(arguments),n=rt(t,this.origin,this.vector);return Line(n[0],n[1])},compare_function:function(){return!0},clip_function:function(t){return t}},S:{fromPoints:function(){var n=h(arguments);return t.line({origin:n[0],vector:[n[1][0]-n[0][0],n[1][1]-n[0][1]]})},perpendicularBisector:function(){var n=h(arguments),r=d([n[1][0]-n[0][0],n[1][1]-n[0][1]]);return t.line({origin:b(n[0],n[1]),vector:[r[1],-r[0]]})}}}},mt=function(t,n){var r=Object.create(dt[t].proto);return dt[t].A.apply(r,n),Object.freeze(r)},dt=Object.assign({},ut,at,st,lt,yt);return Object.assign(t,{vector:function(){return mt("vector",arguments)},circle:function(){return mt("circle",arguments)},rect:function(){return mt("rect",arguments)},polygon:function(){return mt("polygon",arguments)},line:function(){return mt("line",arguments)}}),Object.keys(dt).forEach((function(n){var r={};r.prototype=null!=dt[n].P?Object.create(dt[n].P):Object.create(Object.prototype),r.prototype.constructor=r,Object.keys(dt[n].G).forEach((function(t){return Object.defineProperty(r.prototype,t,{get:dt[n].G[t],enumerable:!0})})),Object.keys(dt[n].M).forEach((function(t){return Object.defineProperty(r.prototype,t,{value:dt[n].M[t]})})),dt[n].proto=r.prototype,Object.keys(dt[n].S).forEach((function(r){return Object.defineProperty(t[n],r,{value:dt[n].S[r]})})),t[n].prototype=dt[n].proto,t[n].prototype.constructor=t[n],Object.freeze(dt[n].proto)})),console.log(dt),t}));
