!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).math=n()}(this,(function(){"use strict";var t={};function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return i(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=t[r];return i}var e=function(t){if("object"===n(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rectangle";if(null!=t.x)return"vector";if(null!=t.rotate180)return"ray";if(null!=t[0]&&t[0].length&&null!=t[0].x)return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},o=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},u=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return o(r,t)}))},c=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},a=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return c(n)?r(t(n)):n}))}},f=function(){var t=a(arguments);return t.length>1?t.reduce((function(t,n){return t.concat(n)}),[]):t},s=function(){if(arguments[0]instanceof t.vector)return arguments[0];var r=f(arguments);return r.length>0&&"object"===n(r[0])&&null!==r[0]&&!isNaN(r[0].x)&&(r=["x","y","z"].map((function(t){return r[0][t]})).filter((function(t){return void 0!==t}))),r.filter((function(t){return"number"==typeof t}))},p=function(){return a(arguments).map((function(t){return s(t)}))},h=[1,0,0,1,0,0],l=[1,0,0,0,1,0,0,0,1,0,0,0],v=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(t){return delete v[2][t]}));var g=function(t){return v[t<8?0:t<13?1:2]},m=function(){var t=f(arguments),n=[].concat(l);return g(t.length).filter((function(n,r){return null!=t[r]})).forEach((function(r,i){n[r]=t[i]})),n},y=function(){var t=s(arguments);if(void 0!==t)return 6===t.length?t:t.length>6?[t[0],t[1],t[2],t[3],t[4],t[5]]:t.length<6?h.map((function(n,r){return t[r]||n})):void 0};function d(){return arguments[0]instanceof t.segment?arguments[0]:4===arguments.length?[[arguments[0],arguments[1]],[arguments[2],arguments[3]]]:p(arguments)}function M(){if(arguments[0]instanceof t.line)return arguments[0];if(4===arguments.length)return{origin:[arguments[0],arguments[1]],vector:[arguments[2],arguments[3]]};var n=Array.from(arguments),i=n.filter((function(t){return!isNaN(t)})),e=n.filter((function(t){return t.constructor===Array}));if(0===n.length)return{vector:[],origin:[]};if(!isNaN(n[0])&&i.length>=4)return{origin:[n[0],n[1]],vector:[n[2],n[3]]};if(e.length>0){if(1===e.length)return M.apply(void 0,r(e[0]));if(2===e.length)return{origin:[e[0][0],e[0][1]],vector:[e[1][0],e[1][1]]};if(4===e.length)return{origin:[e[0],e[1]],vector:[e[2],e[3]]}}if(n[0].constructor===Object){var o=[],u=[];return null!=n[0].vector?o=s(n[0].vector):null!=n[0].direction&&(o=s(n[0].direction)),null!=n[0].origin?u=s(n[0].origin):null!=n[0].point&&(u=s(n[0].point)),{origin:u,vector:o}}return{origin:[],vector:[]}}var b=1e-6,w=function(t,n){var r=u(t,n);return r[0].map((function(t,n){return Math.abs(r[0][n]-r[1][n])<b})).reduce((function(t,n){return t&&n}),!0)},A=function(t){return Math.sqrt(t.map((function(t){return t*t})).reduce((function(t,n){return t+n}),0))},j=function(t){var n=A(t);return 0===n?t:t.map((function(t){return t/n}))},O=function(t,n){return t.map((function(t){return t*n}))},S=function(t,n){return t.map((function(t,r){return t+n[r]}))},P=function(t,n){return t.map((function(t,r){return t-n[r]}))},x=function(t,n){return t.map((function(r,i){return t[i]*n[i]})).reduce((function(t,n){return t+n}),0)},E=function(t,n){return t.map((function(t,r){return(t+n[r])/2}))},_=function(){var t=arguments,n=arguments.length>0?arguments[0].length:0,r=Array(n).fill(0);return Array.from(arguments).forEach((function(t){return r.forEach((function(n,i){r[i]+=t[i]||0}))})),r.map((function(n){return n/t.length}))},q=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[0]*n[2]-t[2]*n[0],t[0]*n[1]-t[1]*n[0]]},G=function(t,n){var r=t[0]-n[0],i=t[1]-n[1];return Math.sqrt(r*r+i*i)},N=function(t,n){return Math.sqrt(Array.from(Array(t.length)).map((function(r,i){return Math.pow(t[i]-n[i],2)})).reduce((function(t,n){return t+n}),0))},k=function(t,n){return 1-Math.abs(x(j(t),j(n)))<b},z=function(t,n){for(var r=!1,i=0,e=n.length-1;i<n.length;e=i++)n[i][1]>t[1]!=n[e][1]>t[1]&&t[0]<(n[e][0]-n[i][0])*(t[1]-n[i][1])/(n[e][1]-n[i][1])+n[i][0]&&(r=!r);return r},C=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;return null!=n&&n.length>0&&n.map((function(n,i,e){var o=e[(i+1)%e.length],u=[o[0]-n[0],o[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>-r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},I=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;return null!=n&&n.length>0&&n.map((function(n,i,e){var o=e[(i+1)%e.length],u=[o[0]-n[0],o[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},R=function(){return!0},Z=function(t,n){return n>=-b},T=function(t,n){return n>=-b&&n<=1+b},B=function(t,n){return t>=-b&&n>=-b},D=function(t,n){return t>=-b&&n>=-b&&n<=1+b},L=function(t,n){return t>=-b&&t<=1+b&&n>=-b&&n<=1+b},U=function(t,n){return n>b},V=function(t,n){return n>b&&n<1-b},$=function(t,n){return t>b&&n>b},F=function(t,n){return t>b&&n>b&&n<1-b},H=function(t,n){return t>b&&t<1-b&&n>b&&n<1-b},J=function(t,n){return t[0]*n[1]-n[0]*t[1]},K=function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,e=J(t.vector,n.vector);if(!(Math.abs(e)<i)){var o=-e,u=J([n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],n.vector),c=J([t.origin[0]-n.origin[0],t.origin[1]-n.origin[1]],t.vector),a=u/e,f=c/o;return r(a,f,i)?[t.origin[0]+t.vector[0]*a,t.origin[1]+t.vector[1]*a]:void 0}},Q=function(t,n){var r=j(t),i=j(n);return x(r,i)<-1+b?[-r[1],r[0]]:j(S(r,i))},W=function(t){return.5*t.map((function(t,n,r){var i=r[(n+1)%r.length];return t[0]*i[1]-i[0]*t[1]})).reduce((function(t,n){return t+n}),0)},X=function(t){var n=1/(6*W(t));return t.map((function(t,n,r){var i=r[(n+1)%r.length],e=t[0]*i[1]-i[0]*t[1];return[(t[0]+i[0])*e,(t[1]+i[1])*e]})).reduce((function(t,n){return[t[0]+n[0],t[1]+n[1]]}),[0,0]).map((function(t){return t*n}))},Y=function(t){var n=Array(t[0].length).fill(1/0),r=Array(t[0].length).fill(-1/0);t.forEach((function(t){return t.forEach((function(t,i){t<n[i]&&(n[i]=t),t>r[i]&&(r[i]=t)}))}));var i=r.map((function(t,r){return t-n[r]}));return[n,i]},tt=function(t,n,r){var i=t.map((function(t,i){return{type:"v",point:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b,e=[r[0]-t[0],r[1]-t[1]],o=e[0]*n[1]-e[1]*n[0];return Math.abs(o)<i}(n,r,t)?t:null,at_index:i}})).filter((function(t){return null!=t.point})),e=t.map((function(t,i,e){return{type:"e",point:function(t,n,r,i){var e=r,o=[i[0]-r[0],i[1]-r[1]];return K(t,n,e,o,V)}(n,r,t,e[(i+1)%e.length]),at_index:i}})).filter((function(t){return null!=t.point})),o=i.concat(e).sort((function(t,n){return Math.abs(t.point[0]-n.point[0])<b?t.point[1]-n.point[1]:t.point[0]-n.point[0]}));return console.log(o),t},nt=function(t,n){return[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]]},rt=function(t,n,r){return{origin:[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]],vector:[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1]]}},it=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2]+t[9],t[1]*n[0]+t[4]*n[1]+t[7]*n[2]+t[10],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]+t[11]]},et={preserve:{magnitude:function(){return A(this)},isEquivalent:function(){return w(this,s(arguments))},isParallel:function(){return k.apply(void 0,r(u(this,s(arguments))))},dot:function(){return x.apply(void 0,r(u(this,s(arguments))))},distanceTo:function(){return N.apply(void 0,r(u(this,s(arguments))))}},vector:{copy:function(){return r(this)},normalize:function(){return j(this)},scale:function(){return O(this,arguments[0])},cross:function(){return q(o(3,this),o(3,s(arguments)))},transform:function(){return it(m(arguments),o(3,this))},add:function(){return S(this,o(this.length,s(arguments)))},subtract:function(){return P(this,o(this.length,s(arguments)))},rotateZ:function(t,n){return it(m(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(t),i=Math.sin(t);return[r,i,-i,r,n[0],n[1]]}(t,n)),this)},rotateZ90:function(){return[-this[1],this[0]]},rotateZ180:function(){return[-this[0],-this[1]]},rotateZ270:function(){return[this[1],-this[0]]},flip:function(){return this.map((function(t){return-t}))},lerp:function(t,n){return r=this,i=o(this.length,s(t)),u=1-(e=n),r.map((function(t,n){return t*u+i[n]*e}));var r,i,e,u},midpoint:function(){return E.apply(void 0,r(u(this,s(arguments))))},bisect:function(){return Q(this,s(arguments))}}},ot={};Object.keys(et.preserve).forEach((function(t){ot[t]=et.preserve[t]})),Object.keys(et.vector).forEach((function(n){ot[n]=function(){return t.vector.apply(t,r(et.vector[n].apply(this,arguments)))}}));var ut={fromAngle:function(n){return t.vector(Math.cos(n),Math.sin(n))}},ct={vector:{P:Array.prototype,A:function(){var t=this;s(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:ot,S:ut}},at=function(t){return t>=1?0:t<=-1?Math.PI:Math.acos(t)},ft=function(t,n,r){var i=n[0]-t[0],e=n[1]-t[1],o=i*Math.cos(r)+e*Math.sin(r),u=e*Math.cos(r)-i*Math.sin(r);return[t[0]+o,t[1]+u]},st=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,i=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),e=Math.sqrt(i),o=0===e?n.vector:n.vector.map((function(t){return t/e})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),s=function(n,r){return t.origin[r]-u[r]*a+o[r]*n};return Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)}))}},pt=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,i=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),e=Math.sqrt(i),o=0===e?n.vector:n.vector.map((function(t){return t/e})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),s=function(n,r){return t.origin[r]-u[r]*a+o[r]*n},p=Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)})),h=p.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/i}));return p.filter((function(t,n){return h[n]>-r}))}},ht=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,i=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),e=Math.sqrt(i),o=0===e?n.vector:n.vector.map((function(t){return t/e})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),s=function(n,r){return t.origin[r]-u[r]*a+o[r]*n},p=Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)})),h=p.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/i}));return p.filter((function(t,n){return h[n]>-r&&h[n]<1+r}))}},lt=function(t,n){return Math.abs(t[0]-n[0])<b&&Math.abs(t[1]-n[1])<b},vt=function(t,n,r){var i=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return function(t,n,r,i){var e={origin:t,vector:n},o={origin:r,vector:[[i[0]-r[0]],[i[1]-r[1]]]};return K(e,o,T)}(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(i.length){case 0:return;case 1:return[i[0],i[0]];case 2:return i;default:for(var e=1;e<i.length;e+=1)if(!lt(i[0],i[e]))return[i[0],i[e]];return}},gt=function(t,n,r){var i=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return ray_segment(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(i.length){case 0:return;case 1:return[n,i[0]];case 2:return i;default:for(var e=1;e<i.length;e+=1)if(!lt(i[0],i[e]))return[i[0],i[e]];return}},mt=function(t,n,i){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return segment_segment_exclusive(n,i,t[0],t[1])})).filter((function(t){return null!=t})),o=I(n,t),u=I(i,t),c=C(n,t),a=C(i,t);if(0===e.length&&(o||u))return[n,i];if(0===e.length&&c&&a)return[n,i];switch(e.length){case 0:return o?[r(n),r(i)]:void 0;case 1:return c?[r(n),e[0]]:[r(i),e[0]];case 2:return e;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},yt={circle:{circle:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,i=t.radius<n.radius?t.radius:n.radius,e=t.radius<n.radius?n.radius:t.radius,o=t.radius<n.radius?t.origin:n.origin,u=t.radius<n.radius?n.origin:t.origin,c=[o[0]-u[0],o[1]-u[1]],a=Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2));if(!(a<r&&Math.abs(e-i)<r||a<r)){var f=c.map((function(t,n){return t/a*e+u[n]}));if(Math.abs(e+i-a)<r||Math.abs(e-(i+a))<r)return[f];if(!(a+i<e||e+i<a)){var s=at((i*i-a*a-e*e)/(-2*a*e)),p=ft(u,f,+s),h=ft(u,f,-s);return[p,h]}}},line:st,ray:pt,segment:ht},line:{poly:function(t,n){return vt(n,t)},circle:function(t,n){return st(n,t)},line:function(t,n){return K(t,n,R)},ray:function(t,n,r){return K(t,n,!1===r?U:Z)},segment:function(t,n,r){return K(t,n,!1===r?V:T)}},ray:{poly:function(t,n){return gt(n,t)},circle:function(t,n){return pt(n,t)},line:function(t,n,r){return K(n,t,!1===r?U:Z)},ray:function(t,n,r){return K(t,n,!1===r?$:B)},segment:function(t,n,r){return K(t,n,!1===r?F:D)}},segment:{poly:function(t,n){return mt(n,t)},circle:function(t,n){return ht(n,t)},line:function(t,n,r){return K(n,t,!1===r?V:T)},ray:function(t,n,r){return K(n,t,!1===r?F:D)},segment:function(t,n,r){return K(t,n,!1===r?H:L)}}},dt=function(t,n){var r=e(t),i=e(n);return(0,yt[r][i])(t,n)},Mt={circle:{A:function(){var n=Array.from(arguments),i=n.filter((function(t){return!isNaN(t)})),e=p(n);3===i.length?(this.origin=t.vector(i[0],i[1]),this.radius=i[2]):2===e.length&&(this.radius=G.apply(void 0,r(e)),this.origin=t.vector.apply(t,r(e[0])))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{intersect:function(t){return dt(this,t)}},S:{fromPoints:function(){var n=p(innerArgs);return t.circle(n,G(n[0],n[1]))}}}},bt=function(){this.points=[]};bt.prototype.area=function(){return W(this.points)},bt.prototype.midpoint=function(){return _(this.points)},bt.prototype.centroid=function(){return X(this.points)},bt.prototype.enclosingRectangle=function(){return Y(this.points)},bt.prototype.contains=function(){return z(s(arguments),this.points)},bt.prototype.scale=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X(this.points),i=this.points.map((function(t){return[0,1].map((function(n,i){return t[i]-r[i]}))})).map((function(t){return t.map((function(i,e){return r[e]+t[e]*n}))}));return t.polygon(i)},bt.prototype.rotate=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X(this.points),i=this.points.map((function(t){var i=[t[0]-r[0],t[1]-r[1]],e=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)),o=Math.atan2(i[1],i[0]);return[r[0]+Math.cos(o+n)*e,r[1]+Math.sin(o+n)*e]}));return t.polygon(i)},bt.prototype.translate=function(){var n=s(arguments),r=this.points.map((function(t){return t.map((function(t,r){return t+n[r]}))}));return t.polygon(r)},bt.prototype.transform=function(){var n=y(arguments),r=this.points.map((function(t){return nt(n,t)}));return t.polygon(r)},bt.prototype.sectors=function(){return this.points.map((function(n,r,i){var e=(r+i.length-1)%i.length,o=(r+1)%i.length,u=n,c=i[e].map((function(t,n){return t-u[n]})),a=i[o].map((function(t,n){return t-u[n]}));return t.sector(a,c,u)}))},bt.prototype.enclosingRectangle=function(){return t.rect(Y(this.points))},bt.prototype.clipSegment=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var e=d(r),o=mt(this.points,e[0],e[1]);return void 0===o?void 0:t.segment(o)},bt.prototype.clipLine=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var e=M(r),o=vt(this.points,e.origin,e.vector);return void 0===o?void 0:t.segment(o)},bt.prototype.clipRay=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var e=M(r),o=gt(this.points,e.origin,e.vector);return void 0===o?void 0:t.segment(o)},bt.prototype.split=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var e=M(r);return tt(this.points,e.origin,e.vector).map((function(n){return t.polygon(n)}))};var wt=function(t,n,r,i){return[[t,n],[t+r,n],[t+r,n+i],[t,n+i]]},At=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},jt={rect:{P:bt.prototype,A:function(){var t=At(4,f(arguments));this.origin=[t[0],t[1]],this.width=t[2],this.height=t[3],this.points=wt.apply(void 0,r(t))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{area:function(){return this.width*this.height},scale:function(n,r){var i=null!=r?r:[this.origin[0]+this.width,this.origin[1]+this.height],e=this.origin[0]+(i[0]-this.origin[0])*(1-n),o=this.origin[1]+(i[1]-this.origin[1])*(1-n);return t.rect(e,o,this.width*n,this.height*n)}},S:{fromPoints:function(){return t.rect(Y(p(arguments)))}}}},Ot={polygon:{P:bt.prototype,A:function(){this.points=a(arguments).map((function(n){return t.vector(n)}))},G:{},M:{},S:{}}},St=function(t,n,r,i){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:b,o=Math.pow(n[0],2)+Math.pow(n[1],2),u=[0,1].map((function(n,i){return r[i]-t[i]})),c=[0,1].map((function(t,r){return n[r]*u[r]})).reduce((function(t,n){return t+n}),0),a=c/o,f=i(a,e);return[0,1].map((function(r,i){return t[i]+n[i]*f}))},Pt=function(){};Pt.prototype.isParallel=function(){var t=u(this.vector,M.apply(void 0,arguments).vector);return console.log(arguments,this.vector,M.apply(void 0,arguments).vector,t),k.apply(void 0,r(t))},Pt.prototype.isDegenerate=function(){return t=this.vector,Math.abs(t.reduce((function(t,n){return t+n}),0))<b;var t},Pt.prototype.reflection=function(){return Matrix2.makeReflection(this.vector,this.origin)},Pt.prototype.nearestPoint=function(){var t=s(arguments);return Vector(St(this.origin,this.vector,t,this.clip_function))},Pt.prototype.intersect=function(t){return dt(this,t)};var xt={line:{P:Pt.prototype,A:function(){var n=M.apply(void 0,arguments);this.origin=t.vector(n.origin),this.vector=t.vector(n.vector)},G:{length:function(){return 1/0}},M:{transform:function(){var n=y(arguments),r=rt(n,this.origin,this.vector);return t.line(r[0],r[1])},clip_function:function(t){return t}},S:{fromPoints:function(){var n=p(arguments);return t.line({origin:n[0],vector:[n[1][0]-n[0][0],n[1][1]-n[0][1]]})},perpendicularBisector:function(){var n=p(arguments),r=[n[1][0]-n[0][0],n[1][1]-n[0][1]];return t.line({origin:_(n[0],n[1]),vector:[r[1],-r[0]]})}}}},Et={ray:{P:Pt.prototype,A:function(){var n=M.apply(void 0,arguments);this.origin=t.vector(n.origin),this.vector=t.vector(n.vector)},G:{length:function(){return 1/0}},M:{transform:function(){for(var n=this,r=arguments.length,i=new Array(r),e=0;e<r;e++)i[e]=arguments[e];var o=y(i),u=this.vector.map((function(t,r){return t+n.origin[r]})),c=multiply_matrix2_vector2(o,this.origin),a=multiply_matrix2_vector2(o,u).map((function(t,n){return t-c[n]}));return t.ray(c,a)},rotate180:function(){return t.ray(this.origin[0],this.origin[1],-this.vector[0],-this.vector[1])},clip_function:function(t){return t<-b?0:t}},S:{fromPoints:function(){var n=p(arguments);return t.ray({origin:n[0],vector:[n[1][0]-n[0][0],n[1][1]-n[0][1]]})}}}},_t={segment:{P:Pt.prototype,A:function(){this.points=d.apply(void 0,arguments).map((function(n){return t.vector(n)})),this.origin=this.points[0],this.vector=this.points[1].subtract(this.points[0])},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:function(t){return t<-b?0:t>1+b?1:t},transform:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=y(n),e=this.points.map((function(t){return nt(i,t)}));return Constructor.segment(e)},scale:function(t){var n=_(this.points[0],this.points[1]),r=this.points.map((function(r){return r.lerp(n,t)}));return Constructor.segment(r)},midpoint:function(){return Constructor.vector(_(this.points[0],this.points[1]))}},S:{fromPoints:t.segment}}},qt=function(t,n){var r=Object.create(Gt[t].proto);return Gt[t].A.apply(r,n),Object.freeze(r)};Object.assign(t,{vector:function(){return qt("vector",arguments)},circle:function(){return qt("circle",arguments)},rect:function(){return qt("rect",arguments)},polygon:function(){return qt("polygon",arguments)},line:function(){return qt("line",arguments)},ray:function(){return qt("ray",arguments)},segment:function(){return qt("segment",arguments)}});var Gt=Object.assign({},ct,Mt,jt,Ot,xt,Et,_t);return Object.keys(Gt).forEach((function(n){var r={};r.prototype=null!=Gt[n].P?Object.create(Gt[n].P):Object.create(Object.prototype),r.prototype.constructor=r,Object.keys(Gt[n].G).forEach((function(t){return Object.defineProperty(r.prototype,t,{get:Gt[n].G[t],enumerable:!0})})),Object.keys(Gt[n].M).forEach((function(t){return Object.defineProperty(r.prototype,t,{value:Gt[n].M[t]})})),Object.keys(Gt[n].S).forEach((function(r){return Object.defineProperty(t[n],r,{value:Gt[n].S[r]})})),t[n].prototype=r.prototype,t[n].prototype.constructor=t[n],Object.freeze(r.prototype),Gt[n].proto=r.prototype})),t}));
