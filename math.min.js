!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).math=n()}(this,(function(){"use strict";var t=function(t){return Math.sqrt(t.map((function(t){return t*t})).reduce((function(t,n){return t+n}),0))},n=function(n){var r=t(n);return 0===r?n:n.map((function(t){return t/r}))},r=function(t,n){return t.map((function(t){return t*n}))},e=function(t,n){return t.map((function(t,r){return t+n[r]}))},i=function(t,n){return t.map((function(t,r){return t-n[r]}))},o=function(t,n){return t.map((function(r,e){return t[e]*n[e]})).reduce((function(t,n){return t+n}),0)},u=function(t,n){return t.map((function(t,r){return(t+n[r])/2}))},a=function(){var t=arguments,n=arguments.length>0?arguments[0].length:0,r=Array(n).fill(0);return Array.from(arguments).forEach((function(t){return r.forEach((function(n,e){r[e]+=t[e]||0}))})),r.map((function(n){return n/t.length}))},c=function(t,n,r){var e=1-r;return t.map((function(t,i){return t*e+n[i]*r}))},f=function(t,n){return t[0]*n[1]-t[1]*n[0]},s=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[0]*n[2]-t[2]*n[0],t[0]*n[1]-t[1]*n[0]]},l=function(t,n){var r=t[0]-n[0],e=t[1]-n[1];return Math.sqrt(r*r+e*e)},h=function(t,n){return Math.sqrt(Array.from(Array(t.length)).map((function(r,e){return Math.pow(t[e]-n[e],2)})).reduce((function(t,n){return t+n}),0))},p=function(t){return[-t[1],t[0]]},v=function(t){return t.map((function(t){return-t}))},g=function(t){return[-t[1],t[0]]},m=Object.freeze({__proto__:null,magnitude:t,normalize:n,scale:r,add:e,subtract:i,dot:o,midpoint:u,average:a,lerp:c,cross2:f,cross3:s,distance2:l,distance3:function(t,n){var r=t[0]-n[0],e=t[1]-n[1],i=t[2]-n[2];return Math.sqrt(r*r+e*e+i*i)},distance:h,rotate90:p,flip:v,rotate270:g});function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],e=!0,i=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(e=(u=a.next()).done)&&(r.push(u.value),!n||r.length!==n);e=!0);}catch(t){i=!0,o=t}finally{try{e||null==a.return||a.return()}finally{if(i)throw o}}return r}(t,n)||M(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||M(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,n){if(t){if("string"==typeof t)return b(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,n):void 0}}function b(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var x={},w=function(t){if("object"===d(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rectangle";if(null!=t.x)return"vector";if(null!=t.rotate180)return"ray";if(null!=t[0]&&t[0].length&&null!=t[0].x)return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},A=function(t,n){return{vector:t||[],origin:n||[]}},j=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},P=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return j(r,t)}))},O=function(t){var n="".concat(t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return n?Math.max(0,(n[1]?n[1].length:0)-(n[2]?+n[2]:0)):0},S=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof t)return t;var r=parseFloat(t.toFixed(n));return O(r)===Math.min(n,O(t))?t:r},k=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},E=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return k(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,y(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return k(n)?y(t(n)):n}))}},I=function(){var t=E(arguments);return t.length>1?t.reduce((function(t,n){return t.concat(n)}),[]):t},N=function(){if(arguments[0]instanceof x.vector)return arguments[0];var t=I(arguments);return t.length>0&&"object"===d(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(n){return t[0][n]})).filter((function(t){return void 0!==t}))),t.filter((function(t){return"number"==typeof t}))},q=function(){return E(arguments).map((function(t){return N(t)}))},z=function(){return arguments[0]instanceof x.segment?arguments[0]:4===arguments.length?[[arguments[0],arguments[1]],[arguments[2],arguments[3]]]:q(arguments)},G=function(){var t=E(arguments);return 0===t.length?A([],[]):t[0]instanceof x.line||t[0]instanceof x.ray||t[0]instanceof x.segment?t[0]:t[0].constructor===Object?A(t[0].vector||[],t[0].origin||[]):"number"==typeof t[0]?A(N(t)):A.apply(void 0,y(t.map((function(t){return N(t)}))))},F=[1,0,0,1,0,0],Z=[1,0,0,0,1,0,0,0,1,0,0,0],T=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(t){return delete T[2][t]}));var J=function(t){return T[t<8?0:t<13?1:2]},L=function(){var t=I(arguments),n=[].concat(Z);return J(t.length).filter((function(n,r){return null!=t[r]})).forEach((function(r,e){n[r]=t[e]})),n},D=function(){var t=N(arguments);if(void 0!==t)return 6===t.length?t:t.length>6?[t[0],t[1],t[2],t[3],t[4],t[5]]:t.length<6?F.map((function(n,r){return t[r]||n})):void 0};var R=Object.freeze({__proto__:null,Typeof:w,lengthSort:function(t,n){return[t,n].sort((function(t,n){return t.length-n.length}))},resize:j,resizeUp:P,resizeDown:function(t,n){var r=t.length>n.length?n.length:t.length;return[t,n].map((function(t){return j(r,t)}))},clean_number:S,is_number:function(t){return null!=t&&!isNaN(t)},is_vector:function(t){return null!=t&&null!=t[0]&&!isNaN(t[0])},is_iterable:k,semi_flatten_arrays:E,flatten_arrays:I,get_vector:N,get_vector_of_vectors:q,get_segment:z,get_line:G,get_matrix_3x4:L,get_matrix2:D,get_matrix3:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=N(n);if(void 0!==e){switch(e.length){case 4:return[e[0],e[1],0,0,e[2],e[3],0,0,0,0,1,0,0,0,0,1];case 6:return[e[0],e[1],0,e[2],e[3],0,0,0,1,e[4],e[5],0];case 9:return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],0,0,0];case 12:return e;case 16:return[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]}return e.length>12?[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10],e[12],e[13],e[14]]:e.length<12?Z.map((function(t,n){return e[n]||t})):void 0}},get_two_vec2:function t(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];if(0!==r.length){if(1===r.length&&void 0!==r[0])return t.apply(void 0,y(r[0]));var i=Array.from(r),o=i.filter((function(t){return!isNaN(t)})),u=i.filter((function(t){return"object"===d(t)})).filter((function(t){return t.constructor===Array}));return o.length>=4?[[o[0],o[1]],[o[2],o[3]]]:u.length>=2&&!isNaN(u[0][0])?u:1!==u.length||isNaN(u[0][0][0])?void 0:u[0]}},get_array_of_vec:function t(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];if(0!==r.length)return 1===r.length&&void 0!==r[0]?t.apply(void 0,y(r[0])):Array.from(r)},get_array_of_vec2:function(){var t=Array.from(arguments),n=t.filter((function(t){return t.constructor===Array}));return n.length>=2&&!isNaN(n[0][0])?n:1===n.length&&n[0].length>=1?n[0]:t}}),U=1e-6,X=function(t,n){return t===n},Y=function(t,n){return Math.abs(t-n)<U},$=function(t,n){return Array.from(Array(t.length-1)).map((function(r,e){return n(t[0],t[e+1])})).reduce((function(t,n){return t&&n}),!0)},B=function(t,n){var r=P(t,n);return r[0].map((function(t,n){return Math.abs(r[0][n]-r[1][n])<U})).reduce((function(t,n){return t&&n}),!0)},C=Object.freeze({__proto__:null,EPSILON:U,equivalent_arrays_of_numbers:function(){},equivalent_numbers:function t(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?t.apply(void 0,y(arguments[0])):$(arguments,Y))},equivalent_vectors:B,equivalent_vectors_old:function(){var t=q.apply(void 0,arguments);if(0===t.length)return!1;if(1===t.length&&void 0!==t[0])return B.apply(void 0,y(t[0]));for(var n=t[0].length,r=Array.from(Array(n)),e=1;e<t.length;e+=1)if(d(t[e-1])!==d(t[e]))return!1;return Array.from(Array(t.length-1)).map((function(n,e){return r.map((function(n,r){return Math.abs(t[e][r]-t[e+1][r])<U})).reduce((function(t,n){return t&&n}),!0)})).reduce((function(t,n){return t&&n}),!0)&&Array.from(Array(t.length-1)).map((function(n,r){return t[0].length===t[r+1].length})).reduce((function(t,n){return t&&n}),!0)},equivalent:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=E(n);if(e.length<1)return!1;var i=d(e[0]);if("undefined"===i)return!1;switch(i){case"number":return $(e,Y);case"boolean":case"string":return $(e,X);case"object":return e[0].constructor===Array?B.apply(void 0,y(e)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),$(e,(function(t,n){return JSON.stringify(t)===JSON.stringify(n)})));default:console.warn("incapable of determining comparison method")}return!1}}),V=function(t,n,r,e,i){var o=function(t,n){return t[0]*n[1]-n[0]*t[1]},u=o(n,e),a=-u,c=o([r[0]-t[0],r[1]-t[1]],e),f=o([t[0]-r[0],t[1]-r[1]],n);return!(Math.abs(u)<U)&&i(c/u,f/a)},H=function(t,n){return t>=-U&&t<=1+U&&n>=-U&&n<=1+U},K=function(t,n,r,e){var i=[n[0]-t[0],n[1]-t[1]],o=[e[0]-r[0],e[1]-r[1]];return V(t,i,r,o,H)},Q=function(t){return Math.abs(t.reduce((function(t,n){return t+n}),0))<U},W=function(t,r){return 1-Math.abs(o(n(t),n(r)))<U},tt=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U,i=[r[0]-t[0],r[1]-t[1]],o=i[0]*n[1]-i[1]*n[0];return Math.abs(o)<e},nt=function(t,n){for(var r=!1,e=0,i=n.length-1;e<n.length;i=e++)n[e][1]>t[1]!=n[i][1]>t[1]&&t[0]<(n[i][0]-n[e][0])*(t[1]-n[e][1])/(n[i][1]-n[e][1])+n[e][0]&&(r=!r);return r},rt=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;return null!=n&&n.length>0&&n.map((function(n,e,i){var o=i[(e+1)%i.length],u=[o[0]-n[0],o[1]-n[1]],a=[t[0]-n[0],t[1]-n[1]];return u[0]*a[1]-u[1]*a[0]>-r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},et=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U;return null!=n&&n.length>0&&n.map((function(n,e,i){var o=i[(e+1)%i.length],u=[o[0]-n[0],o[1]-n[1]],a=[t[0]-n[0],t[1]-n[1]];return u[0]*a[1]-u[1]*a[0]>r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},it=function(t,n,r){for(;r<n;)r+=2*Math.PI;for(;t<n;)t+=2*Math.PI;return t<r},ot=Object.freeze({__proto__:null,overlap_function:V,segment_segment_overlap:K,degenerate:Q,parallel:W,point_on_line:tt,point_on_segment:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U,i=[t[0]-n[0],t[1]-n[1]],o=[t[0]-r[0],t[1]-r[1]],u=[n[0]-r[0],n[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),c=Math.sqrt(o[0]*o[0]+o[1]*o[1]),f=Math.sqrt(u[0]*u[0]+u[1]*u[1]);return Math.abs(a-c-f)<e},point_in_poly:nt,point_in_convex_poly:rt,point_in_convex_poly_exclusive:et,convex_polygons_overlap:function(t,n){for(var r=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})),e=n.map((function(t,n,r){return[t,r[(n+1)%r.length]]})),i=0;i<r.length;i+=1)for(var o=0;o<e.length;o+=1)if(K(r[i][0],r[i][1],e[o][0],e[o][1]))return!0;return!!nt(n[0],t)||!!nt(t[0],n)},convex_polygon_is_enclosed:function(t,n){if(n.map((function(n){return rt(n,t)})).reduce((function(t,n){return t||n}),!1))return!1},convex_polygons_enclose:function(t,n){var r=n.map((function(n){return rt(n,t)})).reduce((function(t,n){return t||n}),!1),e=t.map((function(n){return rt(n,t)})).reduce((function(t,n){return t&&n}),!0);return!r&&e},is_counter_clockwise_between:it}),ut=function(){return!0},at=function(t,n){return n>=-U},ct=function(t,n){return n>=-U&&n<=1+U},ft=function(t,n){return t>=-U&&n>=-U},st=function(t,n){return t>=-U&&n>=-U&&n<=1+U},lt=function(t,n){return t>=-U&&t<=1+U&&n>=-U&&n<=1+U},ht=function(t,n){return n>U},pt=function(t,n){return n>U&&n<1-U},vt=function(t,n){return t>U&&n>U},gt=function(t,n){return t>U&&n>U&&n<1-U},mt=function(t,n){return t>U&&t<1-U&&n>U&&n<1-U},dt=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:U,i=f(t.vector,n.vector);if(!(Math.abs(i)<e)){var o=-i,u=f([n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],n.vector),a=f([t.origin[0]-n.origin[0],t.origin[1]-n.origin[1]],t.vector),c=u/i,s=a/o;return r(c,s,e)?[t.origin[0]+t.vector[0]*c,t.origin[1]+t.vector[1]*c]:void 0}},_t=Object.freeze({__proto__:null,comp_l_l:ut,comp_l_r:at,comp_l_s:ct,comp_r_r:ft,comp_r_s:st,comp_s_s:lt,exclude_l_r:ht,exclude_l_s:pt,exclude_r_r:vt,exclude_r_s:gt,exclude_s_s:mt,intersect:dt}),yt=function(t,n){for(;t<0;)t+=2*Math.PI;for(;n<0;)n+=2*Math.PI;var r=n-t;return r>=0?r:2*Math.PI-(t-n)},Mt=function(t,n){var r=t[0]*n[0]+t[1]*n[1],e=t[0]*n[1]-t[1]*n[0],i=Math.atan2(e,r);return i<0&&(i+=2*Math.PI),i},bt=function(t,r){var i=n(t),u=n(r);return o(i,u)<-1+U?[-i[1],i[0]]:n(e(i,u))},xt=function(t,n,r,e){var i=t[0]*r[1]-r[0]*t[1];if(Math.abs(i)<U){var o=[[t[0],t[1]],u(n,e)],a=[o,o];return delete a[t[0]*r[0]+t[1]*r[1]>0?1:0],a}var c=((e[0]-n[0])*r[1]-r[0]*(e[1]-n[1]))/i,f=[n[0]+t[0]*c,n[1]+t[1]*c],s=[bt(t,r)];return s[1]=p(s[0]),s.map((function(t){return{vector:t,origin:f}}))},wt=function(t,n,r){var e=Mt(n,r)/t;return Array.from(Array(t-1)).map((function(t,r){return n+e*r}))},At=function(t){return.5*t.map((function(t,n,r){var e=r[(n+1)%r.length];return t[0]*e[1]-e[0]*t[1]})).reduce((function(t,n){return t+n}),0)},jt=function(t){var n=1/(6*At(t));return t.map((function(t,n,r){var e=r[(n+1)%r.length],i=t[0]*e[1]-e[0]*t[1];return[(t[0]+e[0])*i,(t[1]+e[1])*i]})).reduce((function(t,n){return[t[0]+n[0],t[1]+n[1]]}),[0,0]).map((function(t){return t*n}))},Pt=function(t){var n=Array(t[0].length).fill(1/0),r=Array(t[0].length).fill(-1/0);t.forEach((function(t){return t.forEach((function(t,e){t<n[e]&&(n[e]=t),t>r[e]&&(r[e]=t)}))}));var e=r.map((function(t,r){return t-n[r]}));return[n,e]},Ot=function(t,n,r,e){var i=r,o=[e[0]-r[0],e[1]-r[1]];return dt(n,t,i,o,pt)},St=function(t,n,r){var e=t.map((function(t,e){return{type:"v",point:tt(r,n,t)?t:null,at_index:e}})).filter((function(t){return null!=t.point})),i=t.map((function(t,e,i){return{type:"e",point:Ot(n,r,t,i[(e+1)%i.length]),at_index:e}})).filter((function(t){return null!=t.point})),o=e.concat(i).sort((function(t,n){return Math.abs(t.point[0]-n.point[0])<U?t.point[1]-n.point[1]:t.point[0]-n.point[0]}));return console.log(o),t},kt=Object.freeze({__proto__:null,clockwise_angle2_radians:function(t,n){for(;t<0;)t+=2*Math.PI;for(;n<0;)n+=2*Math.PI;var r=t-n;return r>=0?r:2*Math.PI-(n-t)},counter_clockwise_angle2_radians:yt,clockwise_angle2:function(t,n){var r=n[0]*t[0]+n[1]*t[1],e=n[0]*t[1]-n[1]*t[0],i=Math.atan2(e,r);return i<0&&(i+=2*Math.PI),i},counter_clockwise_angle2:Mt,counter_clockwise_vector_order:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=n.map((function(t){return Math.atan2(t[1],t[0])})),i=Array.from(Array(e.length)).map((function(t,n){return n})).sort((function(t,n){return e[t]-e[n]}));return i.slice(i.indexOf(0),i.length).concat(i.slice(0,i.indexOf(0)))},interior_angles2:function(t,n){var r=Mt(t,n);return[r,2*Math.PI-r]},interior_angles:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t,n,r){return Mt(t,r[(n+1)%r.length])}))},bisect_vectors:bt,bisect_lines2:xt,subsect_radians:wt,subsect:function(t,n,r){var e=Math.atan2(n[1],n[0]),i=Math.atan2(r[1],r[0]);return wt(t,e,i).map((function(t){return[Math.cos(t),Math.sin(t)]}))},signed_area:At,centroid:jt,enclosing_rectangle:Pt,make_regular_polygon:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=2*Math.PI/t/2,o=e/Math.cos(i);return Array.from(Array(Math.floor(t))).map((function(e,u){var a=-2*Math.PI*u/t+i;return[S(n+o*Math.sin(a),14),S(r+o*Math.cos(a),14)]}))},split_polygon:St,split_convex_polygon:function(t,n,r){var e=t.map((function(t,e){return{point:tt(r,n,t)?t:null,at_index:e}})).filter((function(t){return null!=t.point})),i=t.map((function(t,e,i){return{point:Ot(n,r,t,i[(e+1)%i.length]),at_index:e}})).filter((function(t){return null!=t.point}));if(2==i.length){var o=i.slice().sort((function(t,n){return t.at_index-n.at_index})),u=t.slice(o[1].at_index+1).concat(t.slice(0,o[0].at_index+1));u.push(o[0].point),u.push(o[1].point);var a=t.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[u,a]}if(1==i.length&&1==e.length){e[0].type="v",i[0].type="e";var c=e.concat(i).sort((function(t,n){return t.at_index-n.at_index})),f=t.slice(c[1].at_index+1).concat(t.slice(0,c[0].at_index+1));"e"===c[0].type&&f.push(c[0].point),f.push(c[1].point);var s=t.slice(c[0].at_index+1,c[1].at_index+1);return"e"===c[1].type&&s.push(c[1].point),s.push(c[0].point),[f,s]}if(2==e.length){var l=e.slice().sort((function(t,n){return t.at_index-n.at_index}));return[t.slice(l[1].at_index).concat(t.slice(0,l[0].at_index+1)),t.slice(l[0].at_index,l[1].at_index+1)]}return[t.slice()]},convex_hull:function(t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,r=1e4,e=t.slice().sort((function(t,r){return Math.abs(t[1]-r[1])<n?t[0]-r[0]:t[1]-r[1]})),i=[];i.push(e[0]);var o=0,u=0,a=function(){u+=1;var t=i.length-1,r=e.filter((function(r){return!(Math.abs(r[0]-i[t][0])<n&&Math.abs(r[1]-i[t][1])<n)})).map((function(n){for(var r=Math.atan2(i[t][1]-n[1],i[t][0]-n[0]);r<o;)r+=2*Math.PI;return{node:n,angle:r,distance:void 0}})).sort((function(t,n){return t.angle<n.angle?-1:t.angle>n.angle?1:0}));if(0===r.length)return{v:void 0};var a=r[0];if(r=r.filter((function(t){return Math.abs(a.angle-t.angle)<n})).map((function(n){var r=Math.sqrt(Math.pow(i[t][0]-n.node[0],2)+Math.pow(i[t][1]-n.node[1],2));return n.distance=r,n})).sort((function(t,n){return t.distance<n.distance?1:t.distance>n.distance?-1:0})),i.filter((function(t){return t===r[0].node})).length>0)return{v:i};i.push(r[0].node),o=Math.atan2(i[t][1]-r[0].node[1],i[t][0]-r[0].node[0])};do{var c=a();if("object"===d(c))return c.v}while(u<r)}}),Et=Object.freeze({__proto__:null,lerp:function(t,n,r){return t*(1-r)+n*r},cosine:function(t,n,r){var e=(1-Math.cos(r*Math.PI))/2;return t*(1-e)+n*e},cubic:function(t,n,r,e,i){var o=i*i,u=e-r-t+n;return u*i*o+(t-n-u)*o+(r-t)*i+n},catmull_rom:function(t,n,r,e,i){var o=i*i;return(-.5*t+1.5*n-1.5*r+.5*e)*i*o+(t-2.5*n+2*r-.5*e)*o+(-.5*t+.5*r)*i+n},hermite:function(t,n,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=i*i,c=a*i,f=(n-t)*(1+u)*(1-o)/2,s=(r-n)*(1+u)*(1-o)/2,l=2*c-3*a+1,h=c-2*a+i,p=c-a,v=-2*c+3*a;return l*n+h*(f+=(r-n)*(1-u)*(1-o)/2)+p*(s+=(e-r)*(1-u)*(1-o)/2)+v*r}}),It=function(t,n){return[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]]},Nt=function(t,n,r){return{vector:[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1]],origin:[t[0]*r[0]+t[2]*r[1]+t[4],t[1]*r[0]+t[3]*r[1]+t[5]]}},qt=function(t){return t[0]*t[3]-t[1]*t[2]},zt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(t),e=Math.sin(t);return[r,e,-e,r,n[0],n[1]]},Gt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(t[1],t[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,s=i*-u+-e*o,l=n[0]+a*-n[0]+-n[1]*f,h=n[1]+c*-n[0]+-n[1]*s;return[a,c,f,s,l,h]},Ft=Object.freeze({__proto__:null,multiply_matrix2_vector2:It,multiply_matrix2_line2:Nt,multiply_matrices2:function(t,n){return[t[0]*n[0]+t[2]*n[1],t[1]*n[0]+t[3]*n[1],t[0]*n[2]+t[2]*n[3],t[1]*n[2]+t[3]*n[3],t[0]*n[4]+t[2]*n[5]+t[4],t[1]*n[4]+t[3]*n[5]+t[5]]},determinant2:qt,invert_matrix2:function(t){var n=qt(t);if(!(Math.abs(n)<1e-6||isNaN(n))&&isFinite(t[4])&&isFinite(t[5]))return[t[3]/n,-t[1]/n,-t[2]/n,t[0]/n,(t[2]*t[5]-t[3]*t[4])/n,(t[1]*t[4]-t[0]*t[5])/n]},make_matrix2_translate:function(t,n){return[1,0,0,1,t,n]},make_matrix2_scale:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[t,0,0,n,t*-r[0]+r[0],n*-r[1]+r[1]]},make_matrix2_rotate:zt,make_matrix2_reflection:Gt}),Zt=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2]+t[9],t[1]*n[0]+t[4]*n[1]+t[7]*n[2]+t[10],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]+t[11]]},Tt=function(t,n,r){return{vector:[t[0]*n[0]+t[3]*n[1]+t[6]*n[2],t[1]*n[0]+t[4]*n[1]+t[7]*n[2],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]],origin:[t[0]*r[0]+t[3]*r[1]+t[6]*r[2]+t[9],t[1]*r[0]+t[4]*r[1]+t[7]*r[2]+t[10],t[2]*r[0]+t[5]*r[1]+t[8]*r[2]+t[11]]}},Jt=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2],t[1]*n[0]+t[4]*n[1]+t[7]*n[2],t[2]*n[0]+t[5]*n[1]+t[8]*n[2],t[0]*n[3]+t[3]*n[4]+t[6]*n[5],t[1]*n[3]+t[4]*n[4]+t[7]*n[5],t[2]*n[3]+t[5]*n[4]+t[8]*n[5],t[0]*n[6]+t[3]*n[7]+t[6]*n[8],t[1]*n[6]+t[4]*n[7]+t[7]*n[8],t[2]*n[6]+t[5]*n[7]+t[8]*n[8],t[0]*n[9]+t[3]*n[10]+t[6]*n[11]+t[9],t[1]*n[9]+t[4]*n[10]+t[7]*n[11]+t[10],t[2]*n[9]+t[5]*n[10]+t[8]*n[11]+t[11]]},Lt=function(t){return t[0]*t[4]*t[8]-t[0]*t[7]*t[5]-t[3]*t[1]*t[8]+t[3]*t[7]*t[2]+t[6]*t[1]*t[5]-t[6]*t[4]*t[2]},Dt=function(t){var n=Lt(t);if(!(Math.abs(n)<1e-6||isNaN(n))&&isFinite(t[9])&&isFinite(t[10])&&isFinite(t[11])){var r=[t[4]*t[8]-t[7]*t[5],-t[1]*t[8]+t[7]*t[2],t[1]*t[5]-t[4]*t[2],-t[3]*t[8]+t[6]*t[5],t[0]*t[8]-t[6]*t[2],-t[0]*t[5]+t[3]*t[2],t[3]*t[7]-t[6]*t[4],-t[0]*t[7]+t[6]*t[1],t[0]*t[4]-t[3]*t[1],-t[3]*t[7]*t[11]+t[3]*t[8]*t[10]+t[6]*t[4]*t[11]-t[6]*t[5]*t[10]-t[9]*t[4]*t[8]+t[9]*t[5]*t[7],t[0]*t[7]*t[11]-t[0]*t[8]*t[10]-t[6]*t[1]*t[11]+t[6]*t[2]*t[10]+t[9]*t[1]*t[8]-t[9]*t[2]*t[7],-t[0]*t[4]*t[11]+t[0]*t[5]*t[10]+t[3]*t[1]*t[11]-t[3]*t[2]*t[10]-t[9]*t[1]*t[5]+t[9]*t[2]*t[4]],e=1/n;return r.map((function(t){return t*e}))}},Rt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[1,0,0,0,1,0,0,0,1,t,n,r]},Ut=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(t),e=Math.sin(t);return[1,0,0,0,r,e,0,-e,r,n[0]||0,n[1]||0,n[2]||0]},Xt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(t),e=Math.sin(t);return[r,0,-e,0,1,0,e,0,r,n[0]||0,n[1]||0,n[2]||0]},Yt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=Math.cos(t),e=Math.sin(t);return[r,e,0,-e,r,0,0,0,1,n[0]||0,n[1]||0,n[2]||0]},$t=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=n(r),o=Array.from(Array(3)).map((function(t,n){return e[n]||0})),u=_(i,3),a=u[0],c=u[1],f=u[2],s=Math.cos(t),l=Math.sin(t),h=Math.sqrt(i[1]*i[1]+i[2]*i[2]),p=Math.abs(h)<1e-6?0:c/h,v=Math.abs(h)<1e-6?1:f/h,g=[1,0,0,0,1,0,0,0,1,o[0],o[1],o[2]],m=[1,0,0,0,1,0,0,0,1,-o[0],-o[1],-o[2]],d=[1,0,0,0,v,p,0,-p,v,0,0,0],y=[1,0,0,0,v,-p,0,p,v,0,0,0],M=[h,0,a,0,1,0,-a,0,h,0,0,0],b=[h,0,-a,0,1,0,a,0,h,0,0,0],x=[s,l,0,-l,s,0,0,0,1,0,0,0];return Jt(m,Jt(y,Jt(b,Jt(x,Jt(M,Jt(d,g))))))},Bt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[t,0,0,0,t,0,0,0,t,t*-n[0]+n[0],t*-n[1]+n[1],t*-n[2]+n[2]]},Ct=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.atan2(t[1],t[0]),e=Math.cos(r),i=Math.sin(r),o=Math.cos(-r),u=Math.sin(-r),a=e*o+i*u,c=e*-u+i*o,f=i*o+-e*u,s=i*-u+-e*o,l=n[0]+a*-n[0]+-n[1]*f,h=n[1]+c*-n[0]+-n[1]*s;return[a,c,0,f,s,0,0,0,0,l,h,0]},Vt=Object.freeze({__proto__:null,multiply_matrix3_vector3:Zt,multiply_matrix3_line3:Tt,multiply_matrices3:Jt,determinant3:Lt,invert_matrix3:Dt,make_matrix3_translate:Rt,make_matrix3_rotateX:Ut,make_matrix3_rotateY:Xt,make_matrix3_rotateZ:Yt,make_matrix3_rotate:$t,make_matrix3_scale:Bt,make_matrix3_reflectionZ:Ct,make_matrix3_reflection:function(t){return[]}}),Ht=function(t,n,r){for(var e,i=n.map((function(n,e){return{o:n,i:e,d:r(t,n)}})),o=1/0,u=0;u<i.length;u+=1)i[u].d<o&&(e=u,o=i[u].d);return e},Kt=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:U,o=Math.pow(t[0],2)+Math.pow(t[1],2),u=[0,1].map((function(t,e){return r[e]-n[e]})),a=[0,1].map((function(n,r){return t[r]*u[r]})).reduce((function(t,n){return t+n}),0),c=a/o,f=e(c,i);return[0,1].map((function(r,e){return n[e]+t[e]*f}))},Qt=function(t){return t<-U?0:t>1+U?1:t},Wt=function(t,o,u){return e(t,r(n(i(u,t)),o))},tn=function(){return!1},nn=Object.freeze({__proto__:null,nearest_point2:function(t,n){var r=Ht(t,n,l);return void 0===r?void 0:n[r]},nearest_point:function(t,n){var r=Ht(t,n,h);return void 0===r?void 0:n[r]},nearest_point_on_line:Kt,nearest_point_on_polygon:function(t,n){var r=t.map((function(t,n,r){return i(r[(n+1)%r.length],t)}));return t.map((function(t,e){return Kt(r[e],t,n,Qt)})).map((function(t,r){return{point:t,i:r,distance:h(t,n)}})).sort((function(t,n){return t.distance-n.distance})).shift()},nearest_point_on_circle:Wt,nearest_point_on_ellipse:tn}),rn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return[0,1].map((function(t){return n.filter((function(n,r){return r%2===t})).reduce((function(t,n){return t+n}),0)}))},en=function(){return rn.apply(void 0,arguments).map((function(t){return t<0?t+2*Math.PI:t})).map((function(t){return Math.PI-t}))},on=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map((function(t,n,r){return yt(t,r[(n+1)%r.length])})).map((function(t,n,r){return r.slice(n+1,r.length).concat(r.slice(0,n))})).map((function(t){return en.apply(void 0,y(t))})).map((function(t,r){return n[r]+t[0]})).map((function(t,r){return it(t,n[r],n[(r+1)%n.length])?t:void 0}))},un=Object.freeze({__proto__:null,alternating_sum:rn,kawasaki_sector_score:en,kawasaki_solutions_radians:on,kawasaki_solutions:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=n.map((function(t){return Math.atan2(t[1],t[0])}));return on.apply(void 0,y(e)).map((function(t){return void 0===t?void 0:[S(Math.cos(t),14),S(Math.sin(t),14)]}))}}),an=function(t){return t>=1?0:t<=-1?Math.PI:Math.acos(t)},cn=function(t,n,r){var e=n[0]-t[0],i=n[1]-t[1],o=e*Math.cos(r)+i*Math.sin(r),u=i*Math.cos(r)-e*Math.sin(r);return[t[0]+o,t[1]+u]},fn=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,e=t.radius<n.radius?t.radius:n.radius,i=t.radius<n.radius?n.radius:t.radius,o=t.radius<n.radius?t.origin:n.origin,u=t.radius<n.radius?n.origin:t.origin,a=[o[0]-u[0],o[1]-u[1]],c=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));if(!(c<r&&Math.abs(i-e)<r||c<r)){var f=a.map((function(t,n){return t/c*i+u[n]}));if(Math.abs(i+e-c)<r||Math.abs(i-(e+c))<r)return[f];if(!(c+e<i||i+e<c)){var s=an((e*e-c*c-i*i)/(-2*c*i)),l=cn(u,f,+s),h=cn(u,f,-s);return[l,h]}}},sn=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],a=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],c=a[0]*o[1]-o[0]*a[1];if(!(Math.abs(c)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(c,2)),s=function(n,r){return t.origin[r]-u[r]*c+o[r]*n};return Math.abs(t.radius-Math.abs(c))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)}))}},ln=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],a=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],c=a[0]*o[1]-o[0]*a[1];if(!(Math.abs(c)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(c,2)),s=function(n,r){return t.origin[r]-u[r]*c+o[r]*n},l=Math.abs(t.radius-Math.abs(c))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)})),h=l.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/e}));return l.filter((function(t,n){return h[n]>-r}))}},hn=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],a=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],c=a[0]*o[1]-o[0]*a[1];if(!(Math.abs(c)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(c,2)),s=function(n,r){return t.origin[r]-u[r]*c+o[r]*n},l=Math.abs(t.radius-Math.abs(c))<r?[f].map((function(t){return[t,t].map(s)})):[-f,f].map((function(t){return[t,t].map(s)})),h=l.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/e}));return l.filter((function(t,n){return h[n]>-r&&h[n]<1+r}))}},pn=Object.freeze({__proto__:null,circle_circle:fn,circle_line:sn,circle_ray:ln,circle_segment:hn}),vn=function(t,n){return Math.abs(t[0]-n[0])<U&&Math.abs(t[1]-n[1])<U},gn=function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return function(t,n,r,e){var i={origin:t,vector:n},o={origin:r,vector:[[e[0]-r[0]],[e[1]-r[1]]]};return dt(i,o,ct)}(r,n,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!vn(e[0],e[i]))return[e[0],e[i]];return}},mn=function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return ray_segment(r,n,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[r,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!vn(e[0],e[i]))return[e[0],e[i]];return}},dn=function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return segment_segment_exclusive(n,r,t[0],t[1])})).filter((function(t){return null!=t})),i=et(n,t),o=et(r,t),u=rt(n,t),a=rt(r,t);if(0===e.length&&(i||o))return[n,r];if(0===e.length&&u&&a)return[n,r];switch(e.length){case 0:return i?[y(n),y(r)]:void 0;case 1:return u?[y(n),e[0]]:[y(r),e[0]];case 2:return e;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},_n=Object.freeze({__proto__:null,determ2:function(t,n){return t[0]*n[1]-n[0]*t[1]},convex_poly_circle:function(t,n,r){return[]},convex_poly_line:gn,convex_poly_ray:mn,convex_poly_segment:dn,convex_poly_ray_exclusive:function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return ray_segment_exclusive(r,n,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[r,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!vn(e[0],e[i]))return[e[0],e[i]];return}}}),yn={circle:{circle:fn,line:sn,ray:ln,segment:hn},line:{poly:function(t,n){return gn(n,t)},circle:function(t,n){return sn(n,t)},line:function(t,n){return dt(t,n,ut)},ray:function(t,n,r){return dt(t,n,!1===r?ht:at)},segment:function(t,n,r){return dt(t,n,!1===r?pt:ct)}},ray:{poly:function(t,n){return mn(n,t)},circle:function(t,n){return ln(n,t)},line:function(t,n,r){return dt(n,t,!1===r?ht:at)},ray:function(t,n,r){return dt(t,n,!1===r?vt:ft)},segment:function(t,n,r){return dt(t,n,!1===r?gt:st)}},segment:{poly:function(t,n){return dn(n,t)},circle:function(t,n){return hn(n,t)},line:function(t,n,r){return dt(n,t,!1===r?pt:ct)},ray:function(t,n,r){return dt(n,t,!1===r?gt:st)},segment:function(t,n,r){return dt(t,n,!1===r?mt:lt)}}},Mn=function(t,n){var r=w(t),e=w(n);return(0,yn[r][e])(t,n)},bn={preserve:{magnitude:function(){return t(this)},isEquivalent:function(){return B(this,N(arguments))},isParallel:function(){return W.apply(void 0,y(P(this,N(arguments))))},dot:function(){return o.apply(void 0,y(P(this,N(arguments))))},distanceTo:function(){return h.apply(void 0,y(P(this,N(arguments))))}},vector:{copy:function(){return y(this)},normalize:function(){return n(this)},scale:function(){return r(this,arguments[0])},flip:function(){return v(this)},rotate90:function(){return p(this)},rotate270:function(){return g(this)},cross:function(){return s(j(3,this),j(3,N(arguments)))},transform:function(){return Zt(L(arguments),j(3,this))},add:function(){return e(this,j(this.length,N(arguments)))},subtract:function(){return i(this,j(this.length,N(arguments)))},rotateZ:function(t,n){return Zt(L(zt(t,n)),this)},lerp:function(t,n){return c(this,j(this.length,N(t)),n)},midpoint:function(){return u.apply(void 0,y(P(this,N(arguments))))},bisect:function(){return bt(this,N(arguments))}}},xn={};Object.keys(bn.preserve).forEach((function(t){xn[t]=bn.preserve[t]})),Object.keys(bn.vector).forEach((function(t){xn[t]=function(){return x.vector.apply(x,y(bn.vector[t].apply(this,arguments)))}}));var wn={fromAngle:function(t){return x.vector(Math.cos(t),Math.sin(t))}},An={vector:{P:Array.prototype,A:function(){var t=this;N(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:xn,S:wn}},jn={circle:{A:function(){var t=Array.from(arguments),n=t.filter((function(t){return!isNaN(t)})),r=q(t);3===n.length?(this.origin=x.vector(n[0],n[1]),this.radius=n[2]):2===r.length&&(this.radius=l.apply(void 0,y(r)),this.origin=x.vector.apply(x,y(r[0])))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{nearestPoint:function(){return x.vector(Wt(this.origin,this.radius,N(arguments)))},intersect:function(t){return Mn(this,t)}},S:{fromPoints:function(){var t=q(arguments);return x.circle(t,l(t[0],t[1]))}}}},Pn=function(t){return Number.isInteger(t)?t:t.toFixed(4)},On={ellipse:{A:function(){var t=Array.from(arguments);this.arcStart=0,this.arcEnd=2*Math.PI,this.rx=t[0],this.ry=t[1],this.spin=t[2],this.origin=t[3],"number"==typeof t[4]&&(this.arcStart=t[4]),"number"==typeof t[5]&&(this.arcEnd=t[5])},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]},path:function(){var t=this.pathInfo();return"M".concat(Pn(t.x1)," ").concat(Pn(t.y1),"A").concat(Pn(this.rx)," ").concat(Pn(this.ry)," ").concat(Pn(this.spin)," ").concat(Pn(t.fa)," ").concat(Pn(t.fs)," ").concat(Pn(t.x2+.001)," ").concat(Pn(t.y2+.001))}},M:{nearestPoint:function(){return x.vector((this.origin,this.radius,N(arguments),!1))},intersect:function(t){return Mn(this,t)},pathInfo:function(){var t=Math.cos(this.spin),n=Math.sin(this.spin),r=[t,n,-n,t];return{x1:r[0]*this.rx*Math.cos(this.arcStart)+r[2]*this.ry*Math.sin(this.arcStart)+this.origin[0],y1:r[1]*this.rx*Math.cos(this.arcStart)+r[3]*this.ry*Math.sin(this.arcStart)+this.origin[1],x2:r[0]*this.rx*Math.cos(this.arcEnd)+r[2]*this.ry*Math.sin(this.arcEnd)+this.origin[0],y2:r[1]*this.rx*Math.cos(this.arcEnd)+r[3]*this.ry*Math.sin(this.arcEnd)+this.origin[1],fa:this.arcEnd-this.arcStart>Math.PI?1:0,fs:this.arcEnd-this.arcStart>0?1:0}}},S:{fromPoints:function(){var t=q(arguments);return x.circle(t,l(t[0],t[1]))}}}},Sn=function(){this.points=[]};Sn.prototype.area=function(){return At(this.points)},Sn.prototype.centroid=function(){return x.vector(jt(this.points))},Sn.prototype.enclosingRectangle=function(){return x.rect(Pt(this.points))},Sn.prototype.contains=function(){return nt(N(arguments),this.points)},Sn.prototype.scale=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this.points),r=this.points.map((function(t){return[0,1].map((function(r,e){return t[e]-n[e]}))})).map((function(r){return r.map((function(e,i){return n[i]+r[i]*t}))}));return x.polygon(r)},Sn.prototype.rotate=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this.points),r=this.points.map((function(r){var e=[r[0]-n[0],r[1]-n[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[n[0]+Math.cos(o+t)*i,n[1]+Math.sin(o+t)*i]}));return x.polygon(r)},Sn.prototype.translate=function(){var t=N(arguments),n=this.points.map((function(n){return n.map((function(n,r){return n+t[r]}))}));return x.polygon(n)},Sn.prototype.transform=function(){var t=D(arguments),n=this.points.map((function(n){return It(t,n)}));return x.polygon(n)},Sn.prototype.sectors=function(){return this.points.map((function(t,n,r){var e=(n+r.length-1)%r.length,i=(n+1)%r.length,o=t,u=r[e].map((function(t,n){return t-o[n]})),a=r[i].map((function(t,n){return t-o[n]}));return x.sector(a,u,o)}))},Sn.prototype.nearest=function(){var t,n=N(arguments),r=this.sides.map((function(t){return t.nearestPoint(n)})),e=1/0;return r.map((function(t){return l(n,t)})).forEach((function(n,r){n<e&&(e=n,t=r)})),{point:r[t],edge:this.sides[t]}},Sn.prototype.split=function(){var t=G(arguments);return St(this.points,t.vector,t.origin).map((function(t){return x.polygon(t)}))};var kn=function(t,n,r,e){return[[t,n],[t+r,n],[t+r,n+e],[t,n+e]]},En=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},In={rect:{P:Sn.prototype,A:function(){var t=En(4,I(arguments));this.origin=[t[0],t[1]],this.width=t[2],this.height=t[3],this.points=kn.apply(void 0,y(t))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{area:function(){return this.width*this.height},scale:function(t,n){var r=null!=n?n:[this.origin[0]+this.width,this.origin[1]+this.height],e=this.origin[0]+(r[0]-this.origin[0])*(1-t),i=this.origin[1]+(r[1]-this.origin[1])*(1-t);return x.rect(e,i,this.width*t,this.height*t)},clipSegment:function(){var t=z(arguments),n=Mn.convex_poly_segment(this.points,t[0],t[1]);return void 0===n?void 0:x.segment(n)},clipLine:function(){var t=G(arguments),n=Mn.convex_poly_line(this.points,t.vector,t.origin);return void 0===n?void 0:x.segment(n)},clipRay:function(){var t=G(arguments),n=Mn.convex_poly_ray(this.points,t.vector,t.origin);return void 0===n?void 0:x.segment(n)}},S:{fromPoints:function(){return x.rect(Pt(q(arguments)))}}}},Nn={polygon:{P:Sn.prototype,A:function(){this.points=E(arguments).map((function(t){return x.vector(t)}))},G:{},M:{},S:{}}},qn=function(){};qn.prototype.isParallel=function(){var t=P(this.vector,G.apply(void 0,arguments).vector);return console.log(arguments,this.vector,G.apply(void 0,arguments).vector,t),W.apply(void 0,y(t))},qn.prototype.isDegenerate=function(){return Q(this.vector)},qn.prototype.reflection=function(){return x.matrix(Gt(this.vector,this.origin))},qn.prototype.nearestPoint=function(){var t=N(arguments);return x.vector(Kt(this.vector,this.origin,t,this.clip_function))},qn.prototype.intersect=function(t){return Mn(this,t)},qn.prototype.bisect=function(){var t=G(arguments);return xt(this.vector,this.origin,t.vector,t.origin)};var zn={line:{P:qn.prototype,A:function(){var t=G.apply(void 0,arguments);this.vector=x.vector(t.vector),this.origin=x.vector(t.origin)},G:{length:function(){return 1/0}},M:{transform:function(){return x.line(Nt(D(arguments),this.vector,this.origin))},clip_function:function(t){return t}},S:{fromPoints:function(){var t=q(arguments);return x.line({vector:i(t[1],t[0]),origin:t[0]})},perpendicularBisector:function(){var t=q(arguments);return x.line({vector:p(i(t[1],t[0])),origin:a(t[0],t[1])})}}}},Gn={ray:{P:qn.prototype,A:function(){var t=G.apply(void 0,arguments);this.origin=x.vector(t.origin),this.vector=x.vector(t.vector)},G:{length:function(){return 1/0}},M:{transform:function(){for(var t=this,n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=D(r),o=this.vector.map((function(n,r){return n+t.origin[r]})),u=It(i,this.origin),a=It(i,o).map((function(t,n){return t-u[n]}));return x.ray(u,a)},rotate180:function(){return x.ray(this.origin[0],this.origin[1],-this.vector[0],-this.vector[1])},clip_function:function(t){return t<-U?0:t}},S:{fromPoints:function(){var t=q(arguments);return x.ray({origin:t[0],vector:[t[1][0]-t[0][0],t[1][1]-t[0][1]]})}}}},Fn={segment:{P:qn.prototype,A:function(){this.points=z.apply(void 0,arguments).map((function(t){return x.vector(t)})),this.origin=this.points[0],this.vector=this.points[1].subtract(this.points[0])},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:function(t){return t<-U?0:t>1+U?1:t},transform:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=D(n),i=this.points.map((function(t){return It(e,t)}));return x.segment(i)},scale:function(t){var n=a(this.points[0],this.points[1]),r=this.points.map((function(r){return r.lerp(n,t)}));return x.segment(r)},midpoint:function(){return x.vector(a(this.points[0],this.points[1]))}},S:{fromPoints:x.segment}}},Zn={matrix:{P:Array.prototype,A:function(){var t=this;L(arguments).forEach((function(n){return t.push(n)}))},G:{},M:{multiply:function(){return x.matrix(Jt(this,L(arguments)).map((function(t){return S(t,13)})))},determinant:function(){return S(Lt(this),13)},inverse:function(){return x.matrix(Dt(this).map((function(t){return S(t,13)})))},translate:function(t,n,r){return x.matrix(Jt(this,Rt(t,n,r)).map((function(t){return S(t,13)})))},rotateX:function(t){return x.matrix(Jt(this,Ut(t)).map((function(t){return S(t,13)})))},rotateY:function(t){return x.matrix(Jt(this,Xt(t)).map((function(t){return S(t,13)})))},rotateZ:function(t){return x.matrix(Jt(this,Yt(t)).map((function(t){return S(t,13)})))},rotate:function(t,n,r){var e=$t(t,n,r);return x.matrix(Jt(this,e).map((function(t){return S(t,13)})))},scale:function(t){return x.matrix(Jt(this,Bt(t)).map((function(t){return S(t,13)})))},reflectZ:function(t,n){var r=Ct(t,n);return x.matrix(Jt(this,r).map((function(t){return S(t,13)})))},transform:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x.vector(Zt(N(n),this).map((function(t){return S(t,13)})))},transformVector:function(t){return x.matrix(Zt(this,t).map((function(t){return S(t,13)})))},transformLine:function(t,n){return x.matrix(Tt(this,t,n).map((function(t){return S(t,13)})))}},S:{}}},Tn=function(t,n){var r=Object.create(Jn[t].proto);return Jn[t].A.apply(r,n),Object.freeze(r)};Object.assign(x,{vector:function(){return Tn("vector",arguments)},circle:function(){return Tn("circle",arguments)},ellipse:function(){return Tn("ellipse",arguments)},rect:function(){return Tn("rect",arguments)},polygon:function(){return Tn("polygon",arguments)},line:function(){return Tn("line",arguments)},ray:function(){return Tn("ray",arguments)},segment:function(){return Tn("segment",arguments)},matrix:function(){return Tn("matrix",arguments)}});var Jn=Object.assign({},An,jn,On,In,Nn,zn,Gn,Fn,Zn);Object.keys(Jn).forEach((function(t){var n={};n.prototype=null!=Jn[t].P?Object.create(Jn[t].P):Object.create(Object.prototype),n.prototype.constructor=n,Object.keys(Jn[t].G).forEach((function(r){return Object.defineProperty(n.prototype,r,{get:Jn[t].G[r],enumerable:!0})})),Object.keys(Jn[t].M).forEach((function(r){return Object.defineProperty(n.prototype,r,{value:Jn[t].M[r]})})),Object.keys(Jn[t].S).forEach((function(n){return Object.defineProperty(x[t],n,{value:Jn[t].S[n]})})),x[t].prototype=n.prototype,x[t].prototype.constructor=x[t],Object.freeze(n.prototype),Jn[t].proto=n.prototype}));var Ln=x;return Ln.core=Object.assign({},m,C,kt,Et,Ft,Vt,nn,un,ot,R),Ln.intersection=Mn,Ln.intersection.circle=pn,Ln.intersection.lines=_t,Ln.intersection.polygon=_n,Ln}));
