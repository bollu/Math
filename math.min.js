!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).math=n()}(this,(function(){"use strict";var t={};function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var i=function(t){if("object"===n(t)){if(null!=t.radius)return"circle";if(null!=t.width)return"rectangle";if(null!=t.x)return"vector";if(null!=t.rotate180)return"ray";if(null!=t[0]&&t[0].length&&null!=t[0].x)return"segment";if(null!=t.vector&&null!=t.origin)return"line"}},o=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},u=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return o(r,t)}))},c=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},a=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return c(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return c(n)?r(t(n)):n}))}},f=function(){var t=a(arguments);return t.length>1?t.reduce((function(t,n){return t.concat(n)}),[]):t},p=function(){var t=f(arguments);return t.length>0&&"object"===n(t[0])&&null!==t[0]&&!isNaN(t[0].x)&&(t=["x","y","z"].map((function(n){return t[0][n]})).filter((function(t){return void 0!==t}))),t.filter((function(t){return"number"==typeof t}))},s=function(){return a(arguments).map((function(t){return p(t)}))},h=[1,0,0,1,0,0],l=function(){var t=p(arguments);if(void 0!==t)return 6===t.length?t:t.length>6?[t[0],t[1],t[2],t[3],t[4],t[5]]:t.length<6?h.map((function(n,r){return t[r]||n})):void 0};function v(){return 4===arguments.length?[[arguments[0],arguments[1]],[arguments[2],arguments[3]]]:s(arguments)}function g(){if(4===arguments.length)return{origin:[arguments[0],arguments[1]],vector:[arguments[2],arguments[3]]};var t=Array.from(arguments),n=t.filter((function(t){return!isNaN(t)})),e=t.filter((function(t){return t.constructor===Array}));if(0===t.length)return{vector:[],origin:[]};if(!isNaN(t[0])&&n.length>=4)return{origin:[t[0],t[1]],vector:[t[2],t[3]]};if(e.length>0){if(1===e.length)return g.apply(void 0,r(e[0]));if(2===e.length)return{origin:[e[0][0],e[0][1]],vector:[e[1][0],e[1][1]]};if(4===e.length)return{origin:[e[0],e[1]],vector:[e[2],e[3]]}}if(t[0].constructor===Object){var i=[],o=[];return null!=t[0].vector?i=p(t[0].vector):null!=t[0].direction&&(i=p(t[0].direction)),null!=t[0].origin?o=p(t[0].origin):null!=t[0].point&&(o=p(t[0].point)),{origin:o,vector:i}}return{origin:[],vector:[]}}var m=function(t){return Math.sqrt(t.map((function(t){return t*t})).reduce((function(t,n){return t+n}),0))},y=function(t){var n=m(t);return 0===n?t:t.map((function(t){return t/n}))},d=function(t,n){return t.map((function(r,e){return t[e]*n[e]})).reduce((function(t,n){return t+n}),0)},M=function(){var t=arguments,n=arguments.length>0?arguments[0].length:0,r=Array(n).fill(0);return Array.from(arguments).forEach((function(t){return r.forEach((function(n,e){r[e]+=t[e]||0}))})),r.map((function(n){return n/t.length}))},b=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[0]*n[2]-t[2]*n[0],t[0]*n[1]-t[1]*n[0]]},w=function(t,n){var r=t[0]-n[0],e=t[1]-n[1];return Math.sqrt(r*r+e*e)},A=function(t,n){return 1-Math.abs(d(y(t),y(n)))<1e-6},S=function(t,n){for(var r=!1,e=0,i=n.length-1;e<n.length;i=e++)n[e][1]>t[1]!=n[i][1]>t[1]&&t[0]<(n[i][0]-n[e][0])*(t[1]-n[e][1])/(n[i][1]-n[e][1])+n[e][0]&&(r=!r);return r},j=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return null!=n&&n.length>0&&n.map((function(n,e,i){var o=i[(e+1)%i.length],u=[o[0]-n[0],o[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>-r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},O=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6;return null!=n&&n.length>0&&n.map((function(n,e,i){var o=i[(e+1)%i.length],u=[o[0]-n[0],o[1]-n[1]],c=[t[0]-n[0],t[1]-n[1]];return u[0]*c[1]-u[1]*c[0]>r})).map((function(t,n,r){return t===r[0]})).reduce((function(t,n){return t&&n}),!0)},P=function(){return!0},_=function(t,n){return n>=-1e-6},x=function(t,n){return n>=-1e-6&&n<=1.000001},E=function(t,n){return t>=-1e-6&&n>=-1e-6},q=function(t,n){return t>=-1e-6&&n>=-1e-6&&n<=1.000001},N=function(t,n){return t>=-1e-6&&t<=1.000001&&n>=-1e-6&&n<=1.000001},G=function(t,n){return n>1e-6},I=function(t,n){return n>1e-6&&n<.999999},k=function(t,n){return t>1e-6&&n>1e-6},z=function(t,n){return t>1e-6&&n>1e-6&&n<.999999},L=function(t,n){return t>1e-6&&t<.999999&&n>1e-6&&n<.999999},C=function(t,n){return t[0]*n[1]-n[0]*t[1]},R=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,i=C(t.vector,n.vector);if(!(Math.abs(i)<e)){var o=-i,u=C([n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],n.vector),c=C([t.origin[0]-n.origin[0],t.origin[1]-n.origin[1]],t.vector),a=u/i,f=c/o;return r(a,f,e)?[t.origin[0]+t.vector[0]*a,t.origin[1]+t.vector[1]*a]:void 0}},Z=function(t,n){var r=y(t),e=y(n),i=r.map((function(t,n){return r[n]+e[n]})),o=y(i),u=r.map((function(t,n){return-r[n]-e[n]}));return[o,y(u)]},T=function(t){return.5*t.map((function(t,n,r){var e=r[(n+1)%r.length];return t[0]*e[1]-e[0]*t[1]})).reduce((function(t,n){return t+n}),0)},B=function(t){var n=1/(6*T(t));return t.map((function(t,n,r){var e=r[(n+1)%r.length],i=t[0]*e[1]-e[0]*t[1];return[(t[0]+e[0])*i,(t[1]+e[1])*i]})).reduce((function(t,n){return[t[0]+n[0],t[1]+n[1]]}),[0,0]).map((function(t){return t*n}))},D=function(t){var n=Array(t[0].length).fill(1/0),r=Array(t[0].length).fill(-1/0);t.forEach((function(t){return t.forEach((function(t,e){t<n[e]&&(n[e]=t),t>r[e]&&(r[e]=t)}))}));var e=r.map((function(t,r){return t-n[r]}));return[n,e]},U=function(t,n,r){var e=t.map((function(t,e){return{type:"v",point:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6,i=[r[0]-t[0],r[1]-t[1]],o=i[0]*n[1]-i[1]*n[0];return Math.abs(o)<e}(n,r,t)?t:null,at_index:e}})).filter((function(t){return null!=t.point})),i=t.map((function(t,e,i){return{type:"e",point:function(t,n,r,e){var i=r,o=[e[0]-r[0],e[1]-r[1]];return R(t,n,i,o,I)}(n,r,t,i[(e+1)%i.length]),at_index:e}})).filter((function(t){return null!=t.point})),o=e.concat(i).sort((function(t,n){return Math.abs(t.point[0]-n.point[0])<1e-6?t.point[1]-n.point[1]:t.point[0]-n.point[0]}));return console.log(o),t},V=function(t,n){return[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]]},$=function(t,n,r){return{origin:[t[0]*n[0]+t[2]*n[1]+t[4],t[1]*n[0]+t[3]*n[1]+t[5]],vector:[t[0]*r[0]+t[2]*r[1],t[1]*r[0]+t[3]*r[1]]}},F={preserve:{magnitude:function(){return m(this)},isEquivalent:function(){var t=u(this,p(arguments));return t[0].map((function(n,r){return Math.abs(t[0][r]-t[1][r])<1e-6})).reduce((function(t,n){return t&&n}),!0)},isParallel:function(){return A.apply(void 0,r(u(this,p(arguments))))},dot:function(){return d.apply(void 0,r(u(this,p(arguments))))},distanceTo:function(){var t=u(this,p(arguments));return Math.sqrt(t.map((function(n,r){return Math.pow(t[0][r]-t[1][r],2)})).reduce((function(t,n){return t+n}),0))},bisect:function(){return Z(this,p(arguments)).map((function(n){return t.vector(n)}))}},vector:{copy:function(){return r(this)},normalize:function(){return y(this)},scale:function(t){return this.map((function(n){return n*t}))},cross:function(){return b(o(3,this),o(3,p(arguments)))},add:function(){var t=this;return o(this.length,p(arguments)).map((function(n,r){return t[r]+n}))},subtract:function(){var t=this;return o(this.length,p(arguments)).map((function(n,r){return t[r]-n}))},rotateZ90:function(){return[-this[1],this[0]]},rotateZ180:function(){return[-this[0],-this[1]]},rotateZ270:function(){return[this[1],-this[0]]},flip:function(){return this.map((function(t){return-t}))},lerp:function(t,n){var r=this,e=1-n;return o(this.length,p(t)).map((function(t,i){return r[i]*e+t*n}))},midpoint:function(){var t=u(this,p(arguments));return t[0].map((function(n,r){return(t[0][r]+t[1][r])/2}))}}},H={};Object.keys(F.preserve).forEach((function(t){H[t]=F.preserve[t]})),Object.keys(F.vector).forEach((function(n){H[n]=function(){return t.vector.apply(t,r(F.vector[n].apply(this,arguments)))}}));var J={fromAngle:function(n){return t.vector(Math.cos(n),Math.sin(n))}},K={vector:{P:Array.prototype,A:function(){var t=this;p(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:H,S:J}},Q=function(t){return t>=1?0:t<=-1?Math.PI:Math.acos(t)},W=function(t,n,r){var e=n[0]-t[0],i=n[1]-t[1],o=e*Math.cos(r)+i*Math.sin(r),u=i*Math.cos(r)-e*Math.sin(r);return[t[0]+o,t[1]+u]},X=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),p=function(n,r){return t.origin[r]-u[r]*a+o[r]*n};return Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(p)})):[-f,f].map((function(t){return[t,t].map(p)}))}},Y=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),p=function(n,r){return t.origin[r]-u[r]*a+o[r]*n},s=Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(p)})):[-f,f].map((function(t){return[t,t].map(p)})),h=s.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/e}));return s.filter((function(t,n){return h[n]>-r}))}},tt=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-6,e=Math.pow(n.vector[0],2)+Math.pow(n.vector[1],2),i=Math.sqrt(e),o=0===i?n.vector:n.vector.map((function(t){return t/i})),u=[-o[1],o[0]],c=[n.origin[0]-t.origin[0],n.origin[1]-t.origin[1]],a=c[0]*o[1]-o[0]*c[1];if(!(Math.abs(a)>t.radius+r)){var f=Math.sqrt(Math.pow(t.radius,2)-Math.pow(a,2)),p=function(n,r){return t.origin[r]-u[r]*a+o[r]*n},s=Math.abs(t.radius-Math.abs(a))<r?[f].map((function(t){return[t,t].map(p)})):[-f,f].map((function(t){return[t,t].map(p)})),h=s.map((function(t){return t.map((function(t,r){return t-n.origin[r]}))})).map((function(t){return t[0]*n.vector[0]+n.vector[1]*t[1]})).map((function(t){return t/e}));return s.filter((function(t,n){return h[n]>-r&&h[n]<1+r}))}},nt=function(t,n){return Math.abs(t[0]-n[0])<1e-6&&Math.abs(t[1]-n[1])<1e-6},rt={circle:{circle:function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-6,o=n<e?n:e,u=n<e?e:n,c=n<e?t:r,a=n<e?r:t,f=[c[0]-a[0],c[1]-a[1]],p=Math.sqrt(Math.pow(f[0],2)+Math.pow(f[1],2));if(!(p<i&&Math.abs(u-o)<i||p<i)){var s=f.map((function(t,n){return t/p*u+a[n]}));if(Math.abs(u+o-p)<i||Math.abs(u-(o+p))<i)return[s];if(!(p+o<u||u+o<p)){var h=Q((o*o-p*p-u*u)/(-2*p*u)),l=W(a,s,+h),v=W(a,s,-h);return[l,v]}}},line:X,ray:Y,segment:tt},line:{poly:function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return line_segment(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[e[0],e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!nt(e[0],e[i]))return[e[0],e[i]];return}},circle:X,line:function(t,n){return R(t,n,P)},ray:function(t,n,r){return R(t,n,!1===r?G:_)},segment:function(t,n,r){return R(t,n,!1===r?I:x)}},ray:{poly:function(t,n,r){var e=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return ray_segment(n,r,t[0],t[1])})).filter((function(t){return null!=t}));switch(e.length){case 0:return;case 1:return[n,e[0]];case 2:return e;default:for(var i=1;i<e.length;i+=1)if(!nt(e[0],e[i]))return[e[0],e[i]];return}},circle:Y,line:function(t,n,r){return R(n,t,!1===r?G:_)},ray:function(t,n,r){return R(t,n,!1===r?k:E)},segment:function(t,n,r){return R(t,n,!1===r?z:q)}},segment:{poly:function(t,n,e){var i=t.map((function(t,n,r){return[t,r[(n+1)%r.length]]})).map((function(t){return segment_segment_exclusive(n,e,t[0],t[1])})).filter((function(t){return null!=t})),o=O(n,t),u=O(e,t),c=j(n,t),a=j(e,t);if(0===i.length&&(o||u))return[n,e];if(0===i.length&&c&&a)return[n,e];switch(i.length){case 0:return o?[r(n),r(e)]:void 0;case 1:return c?[r(n),i[0]]:[r(e),i[0]];case 2:return i;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points")}},circle:tt,line:function(t,n,r){return R(n,t,!1===r?I:x)},ray:function(t,n,r){return R(n,t,!1===r?z:q)},segment:function(t,n,r){return R(t,n,!1===r?L:N)}}},et=function(t,n){var r=i(t),e=i(n);return(0,rt[r][e])(t,n)},it={circle:{A:function(){var n=Array.from(arguments),e=n.filter((function(t){return!isNaN(t)})),i=s(n);3===e.length?(this.origin=t.vector(e[0],e[1]),this.radius=e[2]):2===i.length&&(this.radius=w.apply(void 0,r(i)),this.origin=t.vector.apply(t,r(i[0])))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{intersect:function(t){return et(this,t)}},S:{fromPoints:function(){var n=s(innerArgs);return t.circle(n,w(n[0],n[1]))}}}},ot=function(){};ot.prototype.area=function(){return T(this.points)},ot.prototype.midpoint=function(){return M(this.points)},ot.prototype.centroid=function(){return B(this.points)},ot.prototype.enclosingRectangle=function(){return D(this.points)},ot.prototype.contains=function(){return S(p(arguments),this.points)},
ot.prototype.scale=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B(this.points),e=this.points.map((function(t){return[0,1].map((function(n,e){return t[e]-r[e]}))})).map((function(t){return t.map((function(e,i){return r[i]+t[i]*n}))}));return t.polygon(e)},ot.prototype.rotate=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B(this.points),e=this.points.map((function(t){var e=[t[0]-r[0],t[1]-r[1]],i=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),o=Math.atan2(e[1],e[0]);return[r[0]+Math.cos(o+n)*i,r[1]+Math.sin(o+n)*i]}));return t.polygon(e)},ot.prototype.translate=function(){var n=p(arguments),r=this.points.map((function(t){return t.map((function(t,r){return t+n[r]}))}));return t.polygon(r)},ot.prototype.transform=function(){var n=l(arguments),r=this.points.map((function(t){return V(n,t)}));return t.polygon(r)},ot.prototype.sectors=function(){return this.points.map((function(n,r,e){var i=(r+e.length-1)%e.length,o=(r+1)%e.length,u=n,c=e[i].map((function(t,n){return t-u[n]})),a=e[o].map((function(t,n){return t-u[n]}));return t.sector(a,c,u)}))},ot.prototype.enclosingRectangle=function(){return t.rect(D(this.points))},ot.prototype.clipSegment=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=v(n),i=convex_poly_segment(this.points,e[0],e[1]);return void 0===i?void 0:Segment(i)},ot.prototype.clipLine=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n),i=convex_poly_line(this.points,e.origin,e.vector);return void 0===i?void 0:Segment(i)},ot.prototype.clipRay=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=g(n),i=convex_poly_ray(this.points,e.origin,e.vector);return void 0===i?void 0:Segment(i)},ot.prototype.split=function(){for(var n=arguments.length,r=new Array(n),e=0;e<n;e++)r[e]=arguments[e];var i=g(r);return U(this.points,i.origin,i.vector).map((function(n){return t.polygon(n)}))};var ut=function(t,n,r,e){return[[t,n],[t+r,n],[t+r,n+e],[t,n+e]]},ct=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},at={rect:{P:ot.prototype,A:function(){var t=ct(4,f(arguments));this.origin=[t[0],t[1]],this.width=t[2],this.height=t[3],this.points=ut.apply(void 0,r(t))},G:{x:function(){return this.origin[0]},y:function(){return this.origin[1]}},M:{area:function(){return this.width*this.height},scale:function(n,r){var e=null!=r?r:[this.origin[0]+this.width,this.origin[1]+this.height],i=this.origin[0]+(e[0]-this.origin[0])*(1-n),o=this.origin[1]+(e[1]-this.origin[1])*(1-n);return t.rect(i,o,this.width*n,this.height*n)}},S:{fromPoints:function(){return t.rect(D(s(arguments)))}}}},ft={polygon:{P:ot.prototype,A:function(){this.points=a(arguments)},G:{},M:{},S:{}}},pt=function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:EPSILON,o=Math.pow(n[0],2)+Math.pow(n[1],2),u=[0,1].map((function(n,e){return r[e]-t[e]})),c=[0,1].map((function(t,r){return n[r]*u[r]})).reduce((function(t,n){return t+n}),0),a=c/o,f=e(a,i);return[0,1].map((function(r,e){return t[e]+n[e]*f}))},st=function(){};st.prototype.isParallel=function(){var t=u(this.vector,g.apply(void 0,arguments).vector);return console.log(arguments,this.vector,g.apply(void 0,arguments).vector,t),A.apply(void 0,r(t))},st.prototype.isDegenerate=function(){return t=this.vector,Math.abs(t.reduce((function(t,n){return t+n}),0))<1e-6;var t},st.prototype.reflection=function(){return Matrix2.makeReflection(this.vector,this.origin)},st.prototype.nearestPoint=function(){var t=p(arguments);return Vector(pt(this.origin,this.vector,t,this.clip_function))},st.prototype.intersect=function(t){return et(this,t)};var ht={line:{P:st.prototype,A:function(){var n=g.apply(void 0,arguments);this.origin=t.vector(n.origin),this.vector=t.vector(n.vector)},G:{length:function(){return 1/0}},M:{transform:function(){var n=l(arguments),r=$(n,this.origin,this.vector);return t.line(r[0],r[1])},clip_function:function(t){return t}},S:{fromPoints:function(){var n=s(arguments);return t.line({origin:n[0],vector:[n[1][0]-n[0][0],n[1][1]-n[0][1]]})},perpendicularBisector:function(){var n=s(arguments),r=y([n[1][0]-n[0][0],n[1][1]-n[0][1]]);return t.line({origin:M(n[0],n[1]),vector:[r[1],-r[0]]})}}}},lt={ray:{P:st.prototype,A:function(){var n=g.apply(void 0,arguments);this.origin=t.vector(n.origin),this.vector=t.vector(n.vector)},G:{length:function(){return 1/0}},M:{transform:function(){for(var n=this,r=arguments.length,e=new Array(r),i=0;i<r;i++)e[i]=arguments[i];var o=l(e),u=this.vector.map((function(t,r){return t+n.origin[r]})),c=multiply_matrix2_vector2(o,this.origin),a=multiply_matrix2_vector2(o,u).map((function(t,n){return t-c[n]}));return t.ray(c,a)},rotate180:function(){return t.ray(this.origin[0],this.origin[1],-this.vector[0],-this.vector[1])},clip_function:function(t){return t<-EPSILON?0:t}},S:{fromPoints:function(){var n=s(arguments);return t.ray({origin:n[0],vector:[n[1][0]-n[0][0],n[1][1]-n[0][1]]})}}}},vt={segment:{P:st.prototype,A:function(){this.points=v.apply(void 0,arguments).map((function(n){return t.vector(n)})),this.origin=this.points[0],this.vector=this.points[1].subtract(this.points[0])},G:{0:function(){return this.points[0]},1:function(){return this.points[1]},length:function(){return this.vector.magnitude()}},M:{clip_function:function(t){return t<-EPSILON?0:t>1+EPSILON?1:t},transform:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=l(n),i=this.points.map((function(t){return V(e,t)}));return Constructor.segment(i)},scale:function(t){var n=M(this.points[0],this.points[1]),r=this.points.map((function(r){return r.lerp(n,t)}));return Constructor.segment(r)},midpoint:function(){return Constructor.vector(M(this.points[0],this.points[1]))}},S:{fromPoints:t.segment}}},gt=function(t,n){var r=Object.create(mt[t].proto);return mt[t].A.apply(r,n),Object.freeze(r)},mt=Object.assign({},K,it,at,ft,ht,lt,vt);return Object.assign(t,{vector:function(){return gt("vector",arguments)},circle:function(){return gt("circle",arguments)},rect:function(){return gt("rect",arguments)},polygon:function(){return gt("polygon",arguments)},line:function(){return gt("line",arguments)},ray:function(){return gt("ray",arguments)},segment:function(){return gt("segment",arguments)}}),Object.keys(mt).forEach((function(n){var r={};r.prototype=null!=mt[n].P?Object.create(mt[n].P):Object.create(Object.prototype),r.prototype.constructor=r,Object.keys(mt[n].G).forEach((function(t){return Object.defineProperty(r.prototype,t,{get:mt[n].G[t],enumerable:!0})})),Object.keys(mt[n].M).forEach((function(t){return Object.defineProperty(r.prototype,t,{value:mt[n].M[t]})})),Object.keys(mt[n].S).forEach((function(r){return Object.defineProperty(t[n],r,{value:mt[n].S[r]})})),t[n].prototype=r.prototype,t[n].prototype.constructor=t[n],Object.freeze(r.prototype),mt[n].proto=r.prototype})),t}));
