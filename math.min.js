/* Math (c) Robby Kraft, MIT License */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.math=t())})(this,function(){'use strict';var s=Math.PI,u=Math.abs,v=Math.sin,k=Math.cos,P=Math.atan2,x=Math.sqrt,w=Math.pow;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function n(e,t){return o(e)||a(e,t)||g()}function i(e){return r(e)||l(e)||p()}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function o(e){if(Array.isArray(e))return e}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var l,a=e[Symbol.iterator]();!(i=(l=a.next()).done)&&(n.push(l.value),!(t&&n.length===t));i=!0);}catch(e){r=!0,o=e}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function p(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ge(t)}function y(){var e=Array.from(arguments),t=e.filter(function(e){return!isNaN(e)}),n=e.filter(function(e){return e.constructor===Array});if(0===e.length)return{vector:[],origin:[]};if(!isNaN(e[0])&&4<=t.length)return{origin:[e[0],e[1]],vector:[e[2],e[3]]};if(0<n.length){if(1===n.length)return y.apply(void 0,i(n[0]));if(2===n.length)return{origin:[n[0][0],n[0][1]],vector:[n[1][0],n[1][1]]};if(4===n.length)return{origin:[n[0],n[1]],vector:[n[2],n[3]]}}if(e[0].constructor===Object){var r=[],o=[];return null==e[0].vector?null!=e[0].direction&&(r=pe(e[0].direction)):r=pe(e[0].vector),null==e[0].origin?null!=e[0].point&&(o=pe(e[0].point)):o=pe(e[0].origin),{origin:o,vector:r}}return{origin:[],vector:[]}}function c(){return y.apply(void 0,arguments)}function m(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(0!==n.length){if(1===n.length&&void 0!==n[0])return m.apply(void 0,i(n[0]));var o=Array.from(n),l=o.filter(function(e){return!isNaN(e)}),a=o.filter(function(t){return"object"===e(t)}).filter(function(e){return e.constructor===Array});return 4<=l.length?[[l[0],l[1]],[l[2],l[3]]]:2<=a.length&&!isNaN(a[0][0])?a:1!==a.length||isNaN(a[0][0][0])?void 0:a[0]}}function d(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?void 0:1===t.length&&void 0!==t[0]?d.apply(void 0,i(t[0])):Array.from(t)}function f(e,t){var n=null==t?{}:t,i=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:fe;return this.compare_function(e,t)&&!0},r=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:fe;return this.compare_function(e,n)&&t>=-n},o=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:fe;return this.compare_function(e,n)&&t>=-n&&t<=1+n};return Object.defineProperty(n,"isParallel",{value:function(e){if(null==e.vector)throw new Error("isParallel() argument is missing a vector");var t=this.vector.length<e.vector.length,n=t?this.vector:e.vector,i=t?e.vector:this.vector;return we(n,i)}}),Object.defineProperty(n,"isDegenerate",{value:function(){return be(this.vector)}}),Object.defineProperty(n,"nearestPoint",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=pe(t);return xt(ht(this.origin,this.vector,i,this.clip_function))}}),Object.defineProperty(n,"reflection",{value:function(){return bt.makeReflection(this.vector,this.origin)}}),Object.defineProperty(n,"intersect",{value:function(e){var t=this;return Je(this.origin,this.vector,e.origin,e.vector,function(n,i){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:fe;return t.compare_function(n,r)&&e.compare_function(i,r)})}}),Object.defineProperty(n,"intersectLine",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y(t);return Je(this.origin,this.vector,r.origin,r.vector,i.bind(this))}}),Object.defineProperty(n,"intersectRay",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=c(t);return Je(this.origin,this.vector,i.origin,i.vector,r.bind(this))}}),Object.defineProperty(n,"intersectSegment",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=_(t),r=[i[1][0]-i[0][0],i[1][1]-i[0][1]];return Je(this.origin,this.vector,i[0],r,o.bind(this))}}),Object.defineProperty(n,"bisectLine",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=y(t);return pt(this.origin,this.vector,i.origin,i.vector)}}),Object.defineProperty(n,"bisectRay",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=c(t);return pt(this.origin,this.vector,i.origin,i.vector)}}),Object.defineProperty(n,"bisectSegment",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=_(t),r=[i[1][0]-i[0][0],i[1][1]-i[0][1]];return pt(this.origin,this.vector,i[0],r)}}),Object.freeze(n)}function h(e){var t={},n=e,i=function(){return yt(this.points)},r=function(){return this.points.map(function(e,t,n){var i=(t+n.length-1)%n.length,r=(t+1)%n.length,o=e,l=n[i].map(function(e,t){return e-o[t]}),a=n[r].map(function(e,t){return e-o[t]});return Et(a,l,o)})};return Object.defineProperty(t,"area",{value:i}),Object.defineProperty(t,"centroid",{value:function(){return ct(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return E(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return mt(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return je(pe(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=pe(t),l=this.sides.map(function(e){return e.nearestPoint(o)}),a=1/0;return l.map(function(e){return Z(o,e)}).forEach(function(e,t){e<a&&(a=e,r=t)}),{point:l[r],edge:this.sides[r]}}}),Object.defineProperty(t,"clipSegment",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=_(n),o=it(this.points,r[0],r[1]);return void 0===o?void 0:Rt(o)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=y(n),o=tt(this.points,r.origin,r.vector);return void 0===o?void 0:Rt(o)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=y(n),o=nt(this.points,r.origin,r.vector);return void 0===o?void 0:Rt(o)}}),Object.defineProperty(t,"split",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=y(t);return st(this.points,r.origin,r.vector).map(function(e){return n(e)})}}),Object.defineProperty(t,"scale",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ct(this.points),i=this.points.map(function(e){return[0,1].map(function(n,r){return e[r]-t[r]})}).map(function(n){return n.map(function(r,o){return t[o]+n[o]*e})});return n(i)}}),Object.defineProperty(t,"rotate",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ct(this.points),i=this.points.map(function(n){var i=[n[0]-t[0],n[1]-t[1]],r=x(w(i[0],2)+w(i[1],2)),o=P(i[1],i[0]);return[t[0]+k(o+e)*r,t[1]+v(o+e)*r]});return n(i)}}),Object.defineProperty(t,"translate",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=pe(t),o=this.points.map(function(e){return e.map(function(e,t){return e+r[t]})});return n(o)}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=ce(t),o=this.points.map(function(e){return xt(A(r,e))});return n(o)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return r.call(this)}}),Object.defineProperty(t,"signedArea",{value:i}),Object.freeze(t)}var z=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return x(t)},j=function(e){var t=z(e);return 0===t?e:e.map(function(e){return e/t})},R=function(e,t){return e.map(function(n,r){return e[r]*t[r]}).reduce(function(e,t){return e+t},0)},E=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=0<t.length?t[0].length:0,r=Array(i).fill(0);return t.forEach(function(e){return r.forEach(function(t,n){r[n]+=e[n]||0})}),r.map(function(e){return e/t.length})},S=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[0]*t[2]-e[2]*t[0],e[0]*t[1]-e[1]*t[0]]},Z=function(e,t){var n=e[0]-t[0],i=e[1]-t[1];return x(n*n+i*i)},I=function(e,t){for(var n=e.length,r=0,o=0;o<n;o+=1)r+=w(e[o]-t[o],2);return x(r)},L=function(e,t){return e.map(function(n,r){return(e[r]+t[r])/2})},q=/*#__PURE__*/Object.freeze({__proto__:null,magnitude:z,normalize:j,dot:R,average:E,cross2:function(e,t){return[e[0]*t[1],e[1]*t[0]]},cross3:S,distance2:Z,distance3:function(t,n){var i=t[0]-n[0],r=t[1]-n[1],o=t[2]-n[2];return x(i*i+r*r+o*o)},distance:I,midpoint2:L}),A=function(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},V=function(e,t,n){return{origin:[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]],vector:[e[0]*n[0]+e[2]*n[1],e[1]*n[0]+e[3]*n[1]]}},O=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},T=function(e){return e[0]*e[3]-e[1]*e[2]},X=function(e){var t=T(e);return 1e-6>u(t)||isNaN(t)||!isFinite(e[4])||!isFinite(e[5])?void 0:[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},Y=function(e,t){return[1,0,0,1,e,t]},H=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},N=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=k(e),i=v(e);return[n,i,-i,n,t[0],t[1]]},B=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=P(e[1],e[0]),i=k(n),r=v(n),o=k(-n),l=v(-n),p=i*o+r*l,a=i*-l+r*o,g=r*o+-i*l,_=r*-l+-i*o,y=t[0]+p*-t[0]+-t[1]*g,c=t[1]+a*-t[0]+-t[1]*_;return[p,a,g,_,y,c]},D=/*#__PURE__*/Object.freeze({__proto__:null,multiply_matrix2_vector2:A,multiply_matrix2_line2:V,multiply_matrices2:O,matrix2_determinant:T,invert_matrix2:X,make_matrix2_translate:Y,make_matrix2_scale:H,make_matrix2_rotate:N,make_matrix2_reflection:B}),F=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},J=function(e,t,n){return{origin:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]],vector:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2],e[1]*n[0]+e[4]*n[1]+e[7]*n[2],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]]}},C=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},G=function(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},K=function(e){var t=G(e);if(!(1e-6>u(t))&&!isNaN(t)&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]];return n.map(function(e){return e*(1/t)})}},M=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return[1,0,0,0,1,0,0,0,1,e,t,n]},Q=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=k(e),i=v(e);return[1,0,0,0,n,i,0,-i,n,t[0]||0,t[1]||0,t[2]||0]},U=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=k(e),i=v(e);return[n,0,-i,0,1,0,i,0,n,t[0]||0,t[1]||0,t[2]||0]},W=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=k(e),i=v(e);return[n,i,0,-i,n,0,0,0,1,t[0]||0,t[1]||0,t[2]||0]},$=function(e){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,1],r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0,0],o=j(i),l=Array.from([,,,]).map(function(e,t){return r[t]||0}),p=n(o,3),g=p[0],a=p[1],_=p[2],y=k(e),c=v(e),m=x(o[1]*o[1]+o[2]*o[2]),d=1e-6>u(m)?0:a/m,f=1e-6>u(m)?1:_/m,h=[1,0,0,0,1,0,0,0,1,l[0],l[1],l[2]],t=[1,0,0,0,1,0,0,0,1,-l[0],-l[1],-l[2]];return C(t,C([1,0,0,0,f,-d,0,d,f,0,0,0],C([m,0,-g,0,1,0,g,0,m,0,0,0],C([y,c,0,-c,y,0,0,0,1,0,0,0],C([m,0,g,0,1,0,-g,0,m,0,0,0],C([1,0,0,0,f,d,0,-d,f,0,0,0],h))))))},ee=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},te=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:[0,0],n=P(e[1],e[0]),i=k(n),r=v(n),o=k(-n),l=v(-n),p=i*o+r*l,a=i*-l+r*o,g=r*o+-i*l,_=r*-l+-i*o,y=t[0]+p*-t[0]+-t[1]*g,c=t[1]+a*-t[0]+-t[1]*_;return[p,a,0,g,_,0,0,0,0,y,c,0]},ne=/*#__PURE__*/Object.freeze({__proto__:null,multiply_matrix3_vector3:F,multiply_matrix3_line3:J,multiply_matrices3:C,matrix3_determinant:G,invert_matrix3:K,make_matrix3_translate:M,make_matrix3_rotateX:Q,make_matrix3_rotateY:U,make_matrix3_rotateZ:W,make_matrix3_rotate:$,make_matrix3_scale:ee,make_matrix3_reflectionZ:te}),ie=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},re=function(e){var t=Math.min,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var i=parseFloat(e.toFixed(n));return ie(i)===t(n,ie(e))?e:i},oe=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},le=function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];switch(n.length){case void 0:case 0:return n;case 1:return oe(n[0])&&"string"!=typeof n[0]?e.apply(void 0,i(n[0])):[n[0]];default:return Array.from(n).map(function(t){return oe(t)?i(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},ae=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=t;1===r.length&&r[0].length;){var o=r,l=n(o,1);r=l[0]}return r},pe=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=le(t).filter(function(e){return void 0!==e});if(void 0!==i)return 0===i.length?void 0:(isNaN(i[0].x)||(i=["x","y","z"].map(function(e){return i[0][e]}).filter(function(e){return void 0!==e})),i.filter(function(e){return"number"==typeof e}))},ge=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return ae(t).map(function(e){return pe(e)})},_e=[1,0,0,1,0,0],ye=[1,0,0,0,1,0,0,0,1,0,0,0],ce=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=pe(t);return void 0===r?void 0:6===r.length?r:6<r.length?[r[0],r[1],r[2],r[3],r[4],r[5]]:6>r.length?_e.map(function(e,t){return r[t]||e}):void 0},me=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=pe(t);if(void 0!==r){switch(r.length){case 4:return[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,0,0,0,1];case 6:return[r[0],r[1],0,r[2],r[3],0,0,0,1,r[4],r[5],0];case 9:return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],0,0,0];case 12:return r;case 16:return[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10],r[12],r[13],r[14]];}return 12<r.length?[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10],r[12],r[13],r[14]]:12>r.length?ye.map(function(e,t){return r[t]||e}):void 0}},de=/*#__PURE__*/Object.freeze({__proto__:null,clean_number:re,is_number:function(e){return null!=e&&!isNaN(e)},is_vector:function(e){return null!=e&&null!=e[0]&&!isNaN(e[0])},is_iterable:oe,flatten_input:le,semi_flatten_input:ae,get_vector:pe,get_vector_of_vectors:ge,get_matrix2:ce,get_matrix3:me,get_segment:_,get_line:y,get_ray:c,get_two_vec2:m,get_array_of_vec:d,get_array_of_vec2:function(){var e=Array.from(arguments),t=e.filter(function(e){return e.constructor===Array});return 2<=t.length&&!isNaN(t[0][0])?t:1===t.length&&1<=t[0].length?t[0]:e}}),fe=1e-6,he=function(e,t){return Array.from(Array(e.length-1)).map(function(n,r){return t(e[0],e[r+1])}).reduce(function(e,t){return e&&t},!0)},se=function e(){var t=ge.apply(void 0,arguments);if(0===t.length)return!1;if(1===t.length&&void 0!==t[0])return e.apply(void 0,i(t[0]));var n=t[0].length,r=Array.from(Array(n));return Array.from(Array(t.length-1)).map(function(e,n){return r.map(function(e,i){return u(t[n][i]-t[n+1][i])<fe}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)&&Array.from(Array(t.length-1)).map(function(e,n){return t[0].length===t[n+1].length}).reduce(function(e,t){return e&&t},!0)},ue=function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=ae(n);if(1>o.length)return!1;var l=e(o[0]);if("undefined"===l)return!1;switch(o[0].constructor===Array&&(o=o.map(function(e){return ae(e)})),l){case"number":return he(o,function(e,t){return u(e-t)<fe});case"boolean":return he(o,function(e,t){return e===t});case"string":return he(o,function(e,t){return e===t});case"object":return o[0].constructor===Array?se.apply(void 0,i(o)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),he(o,function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:console.warn("incapable of determining comparison method");}return!1},ve=/*#__PURE__*/Object.freeze({__proto__:null,EPSILON:fe,equivalent_numbers:function e(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return 0!==n.length&&(1===n.length&&void 0!==n[0]?e.apply(void 0,i(n[0])):he(n,function(e,t){return u(e-t)<fe}))},equivalent_vectors:se,equivalent:ue}),ke=function(e,t,n,i,r){var o=function(e,t){return e[0]*t[1]-t[0]*e[1]},l=o(t,i),a=o([n[0]-e[0],n[1]-e[1]],i),p=o([e[0]-n[0],e[1]-n[1]],t);if(u(l)<fe)return!1;return r(a/l,p/-l)},Pe=function(e,t){return e>=-fe&&e<=1+fe&&t>=-fe&&t<=1+fe},xe=function(e,t,n,i){var r=[t[0]-e[0],t[1]-e[1]],o=[i[0]-n[0],i[1]-n[1]];return ke(e,r,n,o,Pe)},be=function(e){return u(e.reduce(function(e,t){return e+t},0))<fe},we=function(e,t){return 1-u(R(j(e),j(t)))<fe},ze=function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:fe,r=[n[0]-e[0],n[1]-e[1]],o=r[0]*t[1]-r[1]*t[0];return u(o)<i},je=function(e,t){for(var n=!1,r=0,o=t.length-1;r<t.length;o=r++)t[r][1]>e[1]!=t[o][1]>e[1]&&e[0]<(t[o][0]-t[r][0])*(e[1]-t[r][1])/(t[o][1]-t[r][1])+t[r][0]&&(n=!n);return n},Re=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:fe;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var o=i[(r+1)%i.length],l=[o[0]-t[0],o[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return l[0]*a[1]-l[1]*a[0]>-n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},Ee=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:fe;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var o=i[(r+1)%i.length],l=[o[0]-t[0],o[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return l[0]*a[1]-l[1]*a[0]>n}).map(function(e,t,n){return e===n[0]}).reduce(function(e,t){return e&&t},!0)},Se=function(e,t){for(var n=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),r=t.map(function(e,t,n){return[e,n[(t+1)%n.length]]}),o=0;o<n.length;o+=1)for(var l=0;l<r.length;l+=1)if(xe(n[o][0],n[o][1],r[l][0],r[l][1]))return!0;return!!je(t[0],e)||!!je(e[0],t)},Ze=/*#__PURE__*/Object.freeze({__proto__:null,overlap_function:ke,segment_segment_overlap:xe,degenerate:be,parallel:we,point_on_line:ze,point_on_segment:function(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:fe,r=[e[0]-t[0],e[1]-t[1]],o=[e[0]-n[0],e[1]-n[1]],l=[t[0]-n[0],t[1]-n[1]],a=x(r[0]*r[0]+r[1]*r[1]),p=x(o[0]*o[0]+o[1]*o[1]),g=x(l[0]*l[0]+l[1]*l[1]);return u(a-p-g)<i},point_in_poly:je,point_in_convex_poly:Re,point_in_convex_poly_exclusive:Ee,convex_polygons_overlap:Se,convex_polygon_is_enclosed:function(e,t){var n=t.map(function(t){return Re(t,e)}).reduce(function(e,t){return e||t},!1);return!n&&void 0},convex_polygons_enclose:function(e,t){var n=t.map(function(t){return Re(t,e)}).reduce(function(e,t){return e||t},!1),i=e.map(function(t){return Re(t,e)}).reduce(function(e,t){return e&&t},!0);return!n&&i},is_counter_clockwise_between:function(e,t,n){for(;n<t;)n+=2*s;for(;e<t;)e+=2*s;return e<n}}),Ie=function(){return!0},Le=function(e,t){return t>=-fe},qe=function(e,t){return t>=-fe&&t<=1+fe},Ae=function(e,t){return e>=-fe&&t>=-fe},Ve=function(e,t){return e>=-fe&&t>=-fe&&t<=1+fe},Oe=function(e,t){return e>=-fe&&e<=1+fe&&t>=-fe&&t<=1+fe},Te=function(e,t){return t>fe},Xe=function(e,t){return t>fe&&t<1-fe},Ye=function(e,t){return e>fe&&t>fe},He=function(e,t){return e>fe&&t>fe&&t<1-fe},Ne=function(e,t){return e>fe&&e<1-fe&&t>fe&&t<1-fe},Be=function(e){return e},De=function(e){return e<-fe?0:e},Fe=function(e){return e<-fe?0:e>1+fe?1:e},Je=function(e,t,n,i,r){function o(e,t){return e[0]*t[1]-t[0]*e[1]}var l=5<arguments.length&&arguments[5]!==void 0?arguments[5]:fe,a=o(t,i);if(!(u(a)<l)){var p=o([n[0]-e[0],n[1]-e[1]],i),g=o([e[0]-n[0],e[1]-n[1]],t),_=p/a;return r(_,g/-a,l)?[e[0]+t[0]*_,e[1]+t[1]*_]:void 0}},Ce=function(e,t,n,i,r){var o=[i[0]-n[0],i[1]-n[1]];return Je(e,t,n,o,qe,r)},Ge=function(e,t,n,i,r){var o=[i[0]-n[0],i[1]-n[1]];return Je(e,t,n,o,Ve,r)},Ke=function(e,t,n,i,r){var o=[i[0]-n[0],i[1]-n[1]];return Je(e,t,n,o,Xe,r)},Me=function(e,t,n,i,r){var o=[i[0]-n[0],i[1]-n[1]];return Je(e,t,n,o,He,r)},Qe=function(e,t,n,i,r){var o=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]];return Je(e,o,n,l,Ne,r)},Ue=function(e,t,n,i){function r(e){return e<-o?-1:1}var o=4<arguments.length&&arguments[4]!==void 0?arguments[4]:fe,l=n[0]-e[0],a=n[1]-e[1],p=i[0]-e[0],g=i[1]-e[1],_=p-l,y=g-a,c=l*g-p*a,m=c*c,d=t*t,f=u(_*_+y*y),h=d*f-m;if(!(h<-o)){var s=x(d*f-m),v=[e[0]+(c*y+r(y)*_*s)/f,e[1]+(-c*_+u(y)*s)/f];if(h>o){var k=[e[0]+(c*y-r(y)*_*s)/f,e[1]+(-c*_-u(y)*s)/f];return[v,k]}return[v]}},We=function(){throw"circle_ray has not been written yet"},$e=function(e,t,n,i){function r(e){return 0>e?-1:1}var o=w(t,2),l=n[0]-e[0],a=n[1]-e[1],p=i[0]-e[0],g=i[1]-e[1],_=p-l,y=g-a,c=_*_+y*y,m=l*g-p*a,d=(m*y+r(y)*_*x(o*c-m*m))/c,f=(m*y-r(y)*_*x(o*c-m*m))/c,h=(-m*_+u(y)*x(o*c-m*m))/c,s=(-m*_-u(y)*x(o*c-m*m))/c,v=isNaN(d),k=isNaN(f);return v||k?v&&k?void 0:v?k?void 0:[[f+e[0],s+e[1]]]:[[d+e[0],h+e[1]]]:[[d+e[0],h+e[1]],[f+e[0],s+e[1]]]},et=function(e,t){return u(e[0]-t[0])<fe&&u(e[1]-t[1])<fe},tt=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Ce(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[r[0],r[0]];case 2:return r;default:for(var o=1;o<r.length;o+=1)if(!et(r[0],r[o]))return[r[0],r[o]];}},nt=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Ge(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var o=1;o<r.length;o+=1)if(!et(r[0],r[o]))return[r[0],r[o]];}},it=function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Qe(t,n,e[0],e[1])}).filter(function(e){return null!=e}),o=Ee(t,e),l=Ee(n,e),a=Re(t,e),p=Re(n,e);if(0===r.length&&(o||l))return[t,n];if(0===r.length&&a&&p)return[t,n];switch(r.length){case 0:return o?[i(t),i(n)]:void 0;case 1:return a?[i(t),r[0]]:[i(n),r[0]];case 2:return r;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points");}},rt=/*#__PURE__*/Object.freeze({__proto__:null,limit_line:Be,limit_ray:De,limit_segment:Fe,intersection_function:Je,line_line:function(e,t,n,i,r){return Je(e,t,n,i,Ie,r)},line_ray:function(e,t,n,i,r){return Je(e,t,n,i,Le,r)},line_segment:Ce,ray_ray:function(e,t,n,i,r){return Je(e,t,n,i,Ae,r)},ray_segment:Ge,segment_segment:function(e,t,n,i,r){var o=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]];return Je(e,o,n,l,Oe,r)},line_ray_exclusive:function(e,t,n,i,r){return Je(e,t,n,i,Te,r)},line_segment_exclusive:Ke,ray_ray_exclusive:function(e,t,n,i,r){return Je(e,t,n,i,Ye,r)},ray_segment_exclusive:Me,segment_segment_exclusive:Qe,circle_line_new:function(e,t,n,i){var r=4<arguments.length&&arguments[4]!==void 0?arguments[4]:fe,o=j(i),l=[-o[1],o[0]],a=[n[0]-e[0],n[1]-e[1]],p=a[0]*o[1]-o[0]*a[1];if(!(u(p)>t+r)){var g=x(w(t,2)+w(p,2)),_=function(t,n){return e[n]+l[n]*p+o[n]*t};return u(p)-t<r?[g].map(function(e){return[e,e].map(_)}):[-g,g].map(function(e){return[e,e].map(_)})}},circle_line:Ue,circle_ray:We,circle_segment:$e,convex_poly_line:tt,convex_poly_ray:nt,convex_poly_segment:it,convex_poly_ray_exclusive:function(e,t,n){var r=e.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Me(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var o=1;o<r.length;o+=1)if(!et(r[0],r[o]))return[r[0],r[o]];}}}),ot=function(e,t){var n=e[0]*t[0]+e[1]*t[1],i=e[0]*t[1]-e[1]*t[0],r=P(i,n);return 0>r&&(r+=2*s),r},lt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.map(function(e){return P(e[1],e[0])}),r=Array.from(Array(i.length)).map(function(e,t){return t}).sort(function(e,t){return i[e]-i[t]});return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},at=function(e,t){var n=j(e),r=j(t),i=n.map(function(e,t){return n[t]+r[t]}),o=j(i),l=n.map(function(e,t){return-n[t]+-r[t]});return[o,j(l)]},pt=function(e,n,i,r){var o=n[0]*r[1]-r[0]*n[1];if(u(o)<fe){var l=[L(e,i),[n[0],n[1]]],a=[l,l],p=n[0]*r[0]+n[1]*r[1];return delete a[0<p?1:0],a}var g=(i[0]-e[0])*r[1]-r[0]*(i[1]-e[1]),_=g/o,t=e[0]+n[0]*_,c=e[1]+n[1]*_,y=at(n,r);return y[1]=[y[1][1],-y[1][0]],y.map(function(e){return[[t,c],e]})},gt=function(e,t,n){var r=ot(t,n)/e;return Array.from(Array(e-1)).map(function(e,n){return t+r*n})},_t=function(e,t,n){var i=P(t[1],t[0]),r=P(n[1],n[0]);return gt(e,i,r).map(function(e){return[k(e),v(e)]})},yt=function(e){return .5*e.map(function(e,t,n){var i=n[(t+1)%n.length];return e[0]*i[1]-i[0]*e[1]}).reduce(function(e,t){return e+t},0)},ct=function(e){var t=1/(6*yt(e));return e.map(function(e,t,n){var i=n[(t+1)%n.length],r=e[0]*i[1]-i[0]*e[1];return[(e[0]+i[0])*r,(e[1]+i[1])*r]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(e){return e*t})},mt=function(e){var t=e[0].length,n=Array.from(Array(t)).map(function(){return 1/0}),r=Array.from(Array(t)).map(function(){return-Infinity});e.forEach(function(e){return e.forEach(function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)})});var o=r.map(function(e,t){return e-n[t]});return[n,o]},dt=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,o=.5*(2*s/e),l=i/k(o);return Array.from(Array(Math.floor(e))).map(function(r,p){var i=-2*s*p/e+o,a=re(t+l*v(i),14),g=re(n+l*k(i),14);return[a,g]})},ft=function(e,t,n){for(var r,o=t.map(function(t,r){return{o:t,i:r,d:n(e,t)}}),l=1/0,a=0;a<o.length;a+=1)o[a].d<l&&(r=a,l=o[a].d);return r},ht=function(e,t,n,i){var r=4<arguments.length&&arguments[4]!==void 0?arguments[4]:fe,o=w(t[0],2)+w(t[1],2),l=[0,1].map(function(t,r){return n[r]-e[r]}),a=[0,1].map(function(e,n){return t[n]*l[n]}).reduce(function(e,t){return e+t},0),p=i(a/o,r);return[0,1].map(function(n,r){return e[r]+t[r]*p})},st=function(e,t,n){var i=e.map(function(e,r){var i=ze(t,n,e);return{type:"v",point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var o=Ke(t,n,e,i[(r+1)%i.length]);return{type:"e",point:o,at_index:r}}).filter(function(e){return null!=e.point}),o=i.concat(r).sort(function(e,t){return u(e.point[0]-t.point[0])<fe?e.point[1]-t.point[1]:e.point[0]-t.point[0]});return console.log(o),e},ut=function(e,t,n){var i=e.map(function(e,r){var i=ze(t,n,e);return{point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),r=e.map(function(e,r,i){var o=Ke(t,n,e,i[(r+1)%i.length]);return{point:o,at_index:r}}).filter(function(e){return null!=e.point});if(2==r.length){var o=r.slice().sort(function(e,t){return e.at_index-t.at_index}),l=e.slice(o[1].at_index+1).concat(e.slice(0,o[0].at_index+1));l.push(o[0].point),l.push(o[1].point);var a=e.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[l,a]}if(1==r.length&&1==i.length){i[0].type="v",r[0].type="e";var p=i.concat(r).sort(function(e,t){return e.at_index-t.at_index}),g=e.slice(p[1].at_index+1).concat(e.slice(0,p[0].at_index+1));"e"===p[0].type&&g.push(p[0].point),g.push(p[1].point);var _=e.slice(p[0].at_index+1,p[1].at_index+1);return"e"===p[1].type&&_.push(p[1].point),_.push(p[0].point),[g,_]}if(2==i.length){var y=i.slice().sort(function(e,t){return e.at_index-t.at_index}),c=e.slice(y[1].at_index).concat(e.slice(0,y[0].at_index+1)),m=e.slice(y[0].at_index,y[1].at_index+1);return[c,m]}return[e.slice()]},vt=function(t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:fe,i=t.slice().sort(function(e,t){return u(e[1]-t[1])<n?e[0]-t[0]:e[1]-t[1]}),r=[];r.push(i[0]);var o=0,l=0,a=function(){l+=1;var e=r.length-1,t=i.filter(function(t){return!(u(t[0]-r[e][0])<n&&u(t[1]-r[e][1])<n)}).map(function(t){for(var n=P(r[e][1]-t[1],r[e][0]-t[0]);n<o;)n+=2*s;return{node:t,angle:n,distance:void 0}}).sort(function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0});if(0===t.length)return{v:void 0};var a=t[0];return t=t.filter(function(e){return u(a.angle-e.angle)<n}).map(function(t){var n=x(w(r[e][0]-t.node[0],2)+w(r[e][1]-t.node[1],2));return t.distance=n,t}).sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0}),0<r.filter(function(e){return e===t[0].node}).length?{v:r}:void(r.push(t[0].node),o=P(r[e][1]-t[0].node[1],r[e][0]-t[0].node[0]))};do{var p=a();if("object"===e(p))return p.v}while(l<1e4)},kt=/*#__PURE__*/Object.freeze({__proto__:null,clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*s;for(;0>t;)t+=2*s;var n=e-t;return 0<=n?n:2*s-(t-e)},counter_clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*s;for(;0>t;)t+=2*s;var n=t-e;return 0<=n?n:2*s-(e-t)},clockwise_angle2:function(e,t){var n=t[0]*e[0]+t[1]*e[1],i=t[0]*e[1]-t[1]*e[0],r=P(i,n);return 0>r&&(r+=2*s),r},counter_clockwise_angle2:ot,counter_clockwise_vector_order:lt,interior_angles2:function(e,t){var n=ot(e,t);return[n,2*s-n]},interior_angles:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e,t,n){return ot(e,n[(t+1)%n.length])})},bisect_vectors:at,bisect_lines2:pt,subsect_radians:gt,subsect:_t,signed_area:yt,centroid:ct,enclosing_rectangle:mt,make_regular_polygon:dt,nearest_point2:function(e,t){var n=ft(e,t,Z);return n===void 0?void 0:t[n]},nearest_point:function(e,t){var n=ft(e,t,I);return n===void 0?void 0:t[n]},nearest_point_on_line:ht,split_polygon:st,split_convex_polygon:ut,convex_hull:vt}),Pt=function(e){var t,n=[],r=e,o=function(){return r(j(t))},l=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n);return this.length>r.length?R(r,t):R(t,r)},a=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=pe(n),l=t.slice();return null==l[2]&&(l[2]=0),null==o[2]&&(o[2]=0),r(S(l,o))},p=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n),o=t.length<r.length?t.length:r.length,l=Array.from(Array(o)).map(function(e,n){return w(t[n]-r[n],2)}).reduce(function(e,t){return e+t},0);return x(l)},g=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=ce(n);return r(A(o,t))},_=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=pe(n);return r(t.map(function(e,t){return e+o[t]}))},c=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=pe(n);return r(t.map(function(e,t){return e-o[t]}))},m=function(e,n){var i=N(e,n);return r(A(i,t))},d=function(){return r(-t[1],t[0])},f=function(){return r(-t[0],-t[1])},h=function(){return r(t[1],-t[0])},s=function(){return r.apply(void 0,i(t.map(function(e){return-e})))},u=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=y(n),l=B(o.vector,o.origin);return r(A(l,t))},v=function(e,n){var o=pe(e),l=t.length<o.length?t.length:o.length,a=Array.from(Array(l)).map(function(e,r){return t[r]*n+o[r]*(1-n)});return r(a)},k=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n),o=t.length<r.length?t:r,l=t.length<r.length?r:t;return ue(o,l)},P=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n),o=t.length<r.length?t:r,l=t.length<r.length?r:t;return we(o,l)},b=function(e){return r(t.map(function(t){return t*e}))},E=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];for(var l=pe(n),a=t.length<l.length?t.slice():l,p=t.length<l.length?l:t.slice(),g=a.length;g<p.length;g+=1)a[g]=0;return r(p.map(function(e,t){return .5*(a[t]+p[t])}))},Z=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var o=pe(n);return at(t,o).map(function(e){return r(e)})};return Object.defineProperty(n,"normalize",{value:o}),Object.defineProperty(n,"dot",{value:l}),Object.defineProperty(n,"cross",{value:a}),Object.defineProperty(n,"distanceTo",{value:p}),Object.defineProperty(n,"transform",{value:g}),Object.defineProperty(n,"add",{value:_}),Object.defineProperty(n,"subtract",{value:c}),Object.defineProperty(n,"rotateZ",{value:m}),Object.defineProperty(n,"rotateZ90",{value:d}),Object.defineProperty(n,"rotateZ180",{value:f}),Object.defineProperty(n,"rotateZ270",{value:h}),Object.defineProperty(n,"flip",{value:s}),Object.defineProperty(n,"reflect",{value:u}),Object.defineProperty(n,"lerp",{value:v}),Object.defineProperty(n,"isEquivalent",{value:k}),Object.defineProperty(n,"isParallel",{value:P}),Object.defineProperty(n,"scale",{value:b}),Object.defineProperty(n,"midpoint",{value:E}),Object.defineProperty(n,"bisect",{value:Z}),Object.defineProperty(n,"copy",{value:function(){return r.apply(void 0,i(t))}}),Object.defineProperty(n,"magnitude",{get:function(){return z(t)}}),Object.defineProperty(n,"bind",{value:function(e){t=e}}),n},xt=function e(){var t=Pt(e),n=Object.create(t);t.bind(n);for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];return pe(r).forEach(function(e){return n.push(e)}),Object.defineProperty(n,"x",{get:function(){return n[0]}}),Object.defineProperty(n,"y",{get:function(){return n[1]}}),Object.defineProperty(n,"z",{get:function(){return n[2]}}),n};xt.withAngle=function(e){return xt(k(e),v(e))};var bt=function e(){for(var t=[1,0,0,1,0,0],n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=ce(i);void 0!==o&&o.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"multiply",{value:function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return e(O(t,ce(i)).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"determinant",{value:function(){return re(T(t))}}),Object.defineProperty(t,"inverse",{value:function(){return e(X(t).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"translate",{value:function(n,i){var r=Y(n,i);return e(O(t,r).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"scale",{value:function(){var n=H.apply(void 0,arguments);return e(O(t,n).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"rotate",{value:function(){var n=N.apply(void 0,arguments);return e(O(t,n).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"reflect",{value:function(){var n=B.apply(void 0,arguments);return e(O(t,n).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n);return xt(A(t,r).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transformVector",{value:function(n){return e(A(t,n).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transformLine",{value:function(n,i){return e(V(t,n,i).map(function(e){return re(e,13)}))}}),Object.freeze(t)};bt.makeIdentity=function(){return bt(1,0,0,1,0,0)},bt.makeTranslation=function(e,t){return bt(Y(e,t))},bt.makeRotation=function(e,t){return bt(N(e,t).map(function(e){return re(e,13)}))},bt.makeScale=function(e,t,n){return bt(H(e,t,n).map(function(e){return re(e,13)}))},bt.makeReflection=function(e,t){return bt(B(e,t).map(function(e){return re(e,13)}))};var wt=function e(){for(var t=[1,0,0,0,1,0,0,0,1,0,0,0],n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=me(i);void 0!==o&&o.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"multiply",{value:function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];return e(C(t,me(i)).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"determinant",{value:function(){return re(G(t),13)}}),Object.defineProperty(t,"inverse",{value:function(){return e(K(t).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"translate",{value:function(n,i,r){var o=M(n,i,r);return e(C(t,o).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"rotateX",{value:function(n){var i=Q(n);return e(C(t,i).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"rotateY",{value:function(n){var i=U(n);return e(C(t,i).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"rotateZ",{value:function(n){var i=W(n);return e(C(t,i).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"rotate",{value:function(n,i,r){var o=$(n,i,r);return e(C(t,o).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"scale",{value:function(n){var i=ee(n);return e(C(t,i).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"reflectZ",{value:function(n,i){var r=te(n,i);return e(C(t,r).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=pe(n);return xt(F(r,t).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transformVector",{value:function(n){return e(F(t,n).map(function(e){return re(e,13)}))}}),Object.defineProperty(t,"transformLine",{value:function(n,i){return e(J(t,n,i).map(function(e){return re(e,13)}))}}),Object.freeze(t)};wt.makeIdentity=function(){return wt(1,0,0,0,1,0,0,0,1,0,0,0)},wt.makeTranslation=function(e,t,n){return wt(M(e,t,n))},wt.makeRotationX=function(e){return wt(Q(e).map(function(e){return re(e,13)}))},wt.makeRotationY=function(e){return wt(U(e).map(function(e){return re(e,13)}))},wt.makeRotationZ=function(e){return wt(W(e).map(function(e){return re(e,13)}))},wt.makeRotation=function(e,t,n){return wt($(e,t,n).map(function(e){return re(e,13)}))},wt.makeScale=function(e,t){return wt(ee(e,t).map(function(e){return re(e,13)}))},wt.makeReflectionZ=function(e,t){return wt(te(e,t).map(function(e){return re(e,13)}))};var zt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=y(n),o=r.origin,l=r.vector,a=f.bind(this),p=Object.create(a(e));return Object.defineProperty(p,"compare_function",{value:function(){return!0}}),Object.defineProperty(p,"clip_function",{value:Be}),p.origin=xt(o),p.vector=xt(l),Object.defineProperty(p,"length",{get:function(){return 1/0}}),Object.defineProperty(p,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=ce(n),a=V(r,o,l);return e(a[0],a[1])}}),p};zt.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ge(t);return zt({origin:i[0],vector:j([i[1][0]-i[0][0],i[1][1]-i[0][1]])})},zt.perpendicularBisector=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ge(t),r=j([i[1][0]-i[0][0],i[1][1]-i[0][1]]);return zt({origin:E(i[0],i[1]),vector:[r[1],-r[0]]})};var jt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=y(n),o=r.origin,l=r.vector,a=f.bind(this),p=Object.create(a(e));return Object.defineProperty(p,"origin",{get:function(){return xt(o)}}),Object.defineProperty(p,"vector",{get:function(){return xt(l)}}),Object.defineProperty(p,"length",{get:function(){return 1/0}}),Object.defineProperty(p,"transform",{value:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=ce(n),a=l.map(function(e,t){return e+o[t]}),p=A(r,o),g=A(r,a).map(function(e,t){return e-p[t]});return e(p,g)}}),Object.defineProperty(p,"rotate180",{value:function(){return e(o[0],o[1],-l[0],-l[1])}}),Object.defineProperty(p,"compare_function",{value:function(e,t){return e>=-t}}),Object.defineProperty(p,"clip_function",{value:De}),p};jt.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ge(t);return jt({origin:i[0],vector:j([i[1][0]-i[0][0],i[1][1]-i[0][1]])})};var Rt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=ge(n),o=f.bind(this),l=0<r.length?r.map(function(e){return xt(e)}):void 0;if(void 0!==l){var a=Object.create(o(e,l)),p=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=ce(n),o=a.map(function(e){return A(r,e)});return e(o)},g=function(t){var n=E(a[0],a[1]),i=a.map(function(e){return e.lerp(n,t)});return e(i)},_=function(){return xt(a[1][0]-a[0][0],a[1][1]-a[0][1])},y=function(){return xt(E(a[0],a[1]))},c=function(){return x(w(a[1][0]-a[0][0],2)+w(a[1][1]-a[0][1],2))},m=function(e,t){return e>=-t&&e<=1+t};return Object.defineProperty(a,"origin",{get:function(){return a[0]}}),Object.defineProperty(a,"vector",{get:function(){return _()}}),Object.defineProperty(a,"midpoint",{value:y}),Object.defineProperty(a,"magnitude",{get:function(){return c()}}),Object.defineProperty(a,"transform",{value:p}),Object.defineProperty(a,"scale",{value:g}),Object.defineProperty(a,"compare_function",{value:m}),Object.defineProperty(a,"clip_function",{value:Fe}),a}},Et=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],o=[pe(e),pe(t)];return{contains:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=pe(t).map(function(e,t){return e+r[t]}),l=(i[1]-o[0][1])*-o[0][0]-(i[0]-o[0][0])*-o[0][1],a=i[1]*o[1][0]-i[0]*o[1][1];return 0>l&&0>a},bisect:function(){var e=ot(o[0],o[1]),t=o.map(function(e){return P(e[1],e[0])}),n=t[0]+.5*e;return xt(k(n),v(n))},subsect:function(e){return _t(e,o[0],o[1]).map(function(e){return xt(e[0],e[1])})},get center(){return r},get vectors(){return o},get angle(){return ot(o[0],o[1])}}};Et.fromVectors=function(e,t){return Et(e,t)},Et.fromPoints=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[0,0],i=[e,t].map(function(e){return e.map(function(t,r){return e[r]-n[r]})});return Et(i[0],i[1],n)};var St=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ge(t).map(function(e){return xt(e)});if(void 0!==i){var r=i.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Rt(e[0][0],e[0][1],e[1][0],e[1][1])}),o=h.bind(this),l=Object.create(o());return Object.defineProperty(l,"points",{get:function(){return i}}),Object.defineProperty(l,"sides",{get:function(){return r}}),l}};St.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=dt(e,t,n,i);return St(r)},St.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=vt(e,t);return St(n)};var Zt=function e(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=d(n).map(function(e){return xt(e)});if(void 0!==r){var o=r.map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Rt(e[0][0],e[0][1],e[1][0],e[1][1])}),l=h.bind(this),a=Object.create(l(e)),p=function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=y(n);return ut(r,o.origin,o.vector).map(function(t){return e(t)})},g=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=d(t);return Se(r,i)},_=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ct(a.points),i=a.points.map(function(e){return[0,1].map(function(t,r){return e[r]-n[r]})}).map(function(e){return e.map(function(r,o){return n[o]+e[o]*t})});return e(i)},c=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ct(a.points),i=a.points.map(function(e){var i=[e[0]-n[0],e[1]-n[1]],r=x(w(i[0],2)+w(i[1],2)),o=P(i[1],i[0]);return[n[0]+k(o+t)*r,n[1]+v(o+t)*r]});return e(i)};return Object.defineProperty(a,"points",{get:function(){return r}}),Object.defineProperty(a,"sides",{get:function(){return o}}),Object.defineProperty(a,"split",{value:p}),Object.defineProperty(a,"overlaps",{value:g}),Object.defineProperty(a,"scale",{value:_}),Object.defineProperty(a,"rotate",{value:c}),a}};Zt.regularPolygon=function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,r=dt(e,t,n,i);return Zt(r)},Zt.convexHull=function(e){var t=!!(1<arguments.length&&arguments[1]!==void 0)&&arguments[1],n=vt(e,t);return Zt(n)};var It=function e(){for(var t,i,r,o=arguments.length,l=Array(o),a=0;a<o;a++)l[a]=arguments[a];var p=Array.from(l),g=p.filter(function(e){return!isNaN(e)}),_=p.filter(function(e){return e.constructor===Array});if(4===g.length){t=xt(g.slice(0,2));var y=n(g,4);i=y[2],r=y[3]}1===_.length&&(_=_[0]),2===_.length&&"number"==typeof _[0][0]&&(t=xt(_[0].slice()),i=_[1][0],r=_[1][1]);var c=[[t[0],t[1]],[t[0]+i,t[1]],[t[0]+i,t[1]+r],[t[0],t[1]+r]],m=h.bind(this),d=Object.create(m(e)),f=function(n,o){var l=null==o?[t[0]+i,t[1]+r]:o,a=t[0]+(l[0]-t[0])*(1-n),p=t[1]+(l[1]-t[1])*(1-n);return e(a,p,i*n,r*n)};return Object.defineProperty(d,"points",{get:function(){return c}}),Object.defineProperty(d,"origin",{get:function(){return t}}),Object.defineProperty(d,"width",{get:function(){return i}}),Object.defineProperty(d,"height",{get:function(){return r}}),Object.defineProperty(d,"area",{get:function(){return i*r}}),Object.defineProperty(d,"scale",{value:f}),Object.defineProperty(d,"rotate",{value:function(){var e;return(e=Zt(c)).rotate.apply(e,arguments)}}),Object.defineProperty(d,"transform",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Zt(c).transform(t)}}),d};It.fromPoints=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=ge(t),r=mt(i);return It(r)};var Lt=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ge(t);if(void 0!==r){var o=lt.apply(void 0,i(r)),l=function(){return o.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return Et.fromVectors(e[0],e[1])})},a=function(){return o.map(function(e){return r[e]}).map(function(e,t,n){return[e,n[(t+1)%n.length]]}).map(function(e){return ot(e[0],e[1])})};return{sectors:l,angles:a,get vectors(){return r},get vectorOrder(){return i(o)}}}};Lt.fromVectors=function(){return Lt.apply(void 0,arguments)},Lt.fromPoints=function(e,t){var n=t.map(function(t){return t.map(function(n,r){return t[r]-e[r]})});return Lt.fromVectors(n)};var qt=Object.create(null);Object.assign(qt,q,D,ne,kt,Ze,ve),qt.clean_number=re,qt.flatten_input=le,qt.semi_flatten_input=ae,Object.keys(de).filter(function(e){return /^is_/g.test(e)}).forEach(function(e){qt[e]=de[e]}),Object.keys(de).filter(function(e){return /^get_/g.test(e)}).forEach(function(e){qt[e]=de[e]}),qt.intersection=rt,Object.freeze(qt);return{vector:xt,matrix2:bt,matrix:wt,line:zt,ray:jt,segment:Rt,circle:function(){for(var e,t,r=arguments.length,o=Array(r),l=0;l<r;l++)o[l]=arguments[l];var a=o.filter(function(e){return!isNaN(e)}),p=ge(o);if(3===a.length){e=xt(a[0],a[1]);var g=n(a,3);t=g[2]}else 2===p.length&&(t=Z.apply(void 0,i(p)),e=xt.apply(void 0,i(p[0])));var _=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=y(i),l=[o.origin[0]+o.vector[0],o.origin[1]+o.vector[1]],a=Ue(e,t,o.origin,l);return a===void 0?void 0:a.map(function(e){return xt(e)})},m=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=c(i),l=We(e,t,o[0],o[1]);return l===void 0?void 0:l.map(function(e){return xt(e)})},d=function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=ge(i),l=$e(e,t,o[0],o[1]);return l===void 0?void 0:l.map(function(e){return xt(e)})};return{intersectionLine:_,intersectionRay:m,intersectionSegment:d,get origin(){return e},get x(){return e[0]},get y(){return e[1]},get radius(){return t},set origin(t){e=xt(t)},set radius(e){t=e}}},polygon:St,convexPolygon:Zt,rectangle:It,junction:Lt,sector:Et,core:qt}});
