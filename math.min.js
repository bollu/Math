!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).math=n()}(this,(function(){"use strict";var t={};function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}var o=function(t,n){return Array(t).fill(0).map((function(t,r){return n[r]?n[r]:t}))},u=function(t,n){var r=t.length>n.length?t.length:n.length;return[t,n].map((function(t){return o(r,t)}))},i=function(t){return null!=t&&"function"==typeof t[Symbol.iterator]},c=function t(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return i(arguments[0])&&"string"!=typeof arguments[0]?t.apply(void 0,r(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(n){return i(n)?r(t(n)):n}))}},f=function(){var t=c(arguments);return t.length>1?t.reduce((function(t,n){return t.concat(n)}),[]):t},a=function(){if(arguments[0]instanceof t.vector)return arguments[0];var r=f(arguments);return r.length>0&&"object"===n(r[0])&&null!==r[0]&&!isNaN(r[0].x)&&(r=["x","y","z"].map((function(t){return r[0][t]})).filter((function(t){return void 0!==t}))),r.filter((function(t){return"number"==typeof t}))},p=[1,0,0,0,1,0,0,0,1,0,0,0],s=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(t){return delete s[2][t]}));var l=function(t){return s[t<8?0:t<13?1:2]},y=function(){var t=f(arguments),n=[].concat(p);return l(t.length).filter((function(n,r){return null!=t[r]})).forEach((function(r,e){n[r]=t[e]})),n},h=function(t,n){var r=u(t,n);return r[0].map((function(t,n){return Math.abs(r[0][n]-r[1][n])<1e-6})).reduce((function(t,n){return t&&n}),!0)},m=function(t){return Math.sqrt(t.map((function(t){return t*t})).reduce((function(t,n){return t+n}),0))},v=function(t){var n=m(t);return 0===n?t:t.map((function(t){return t/n}))},b=function(t,n){return t.map((function(t){return t*n}))},d=function(t,n){return t.map((function(t,r){return t+n[r]}))},g=function(t,n){return t.map((function(t,r){return t-n[r]}))},j=function(t,n){return t.map((function(r,e){return t[e]*n[e]})).reduce((function(t,n){return t+n}),0)},O=function(t,n){return t.map((function(t,r){return(t+n[r])/2}))},A=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[0]*n[2]-t[2]*n[0],t[0]*n[1]-t[1]*n[0]]},S=function(t,n){return Math.sqrt(Array.from(Array(t.length)).map((function(r,e){return Math.pow(t[e]-n[e],2)})).reduce((function(t,n){return t+n}),0))},M=function(t,n){return 1-Math.abs(j(v(t),v(n)))<1e-6},E=function(t,n){var r=v(t),e=v(n);return j(r,e)<-.999999?[-r[1],r[0]]:v(d(r,e))},x=function(t,n){return[t[0]*n[0]+t[3]*n[1]+t[6]*n[2]+t[9],t[1]*n[0]+t[4]*n[1]+t[7]*n[2]+t[10],t[2]*n[0]+t[5]*n[1]+t[8]*n[2]+t[11]]},P={preserve:{magnitude:function(){return m(this)},isEquivalent:function(){return h(this,a(arguments))},isParallel:function(){return M.apply(void 0,r(u(this,a(arguments))))},dot:function(){return j.apply(void 0,r(u(this,a(arguments))))},distanceTo:function(){return S.apply(void 0,r(u(this,a(arguments))))}},vector:{copy:function(){return r(this)},normalize:function(){return v(this)},scale:function(){return b(this,arguments[0])},flip:function(){return this.map((function(t){return-t}))},rotate90:function(){return[-(t=this)[1],t[0]];var t},rotate270:function(){return[-(t=this)[1],t[0]];var t},cross:function(){return A(o(3,this),o(3,a(arguments)))},transform:function(){return x(y(arguments),o(3,this))},add:function(){return d(this,o(this.length,a(arguments)))},subtract:function(){return g(this,o(this.length,a(arguments)))},rotateZ:function(t,n){return x(y(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],r=Math.cos(t),e=Math.sin(t);return[r,e,-e,r,n[0],n[1]]}(t,n)),this)},lerp:function(t,n){return r=this,e=o(this.length,a(t)),i=1-(u=n),r.map((function(t,n){return t*i+e[n]*u}));var r,e,u,i},midpoint:function(){return O.apply(void 0,r(u(this,a(arguments))))},bisect:function(){return E(this,a(arguments))}}},k={};Object.keys(P.preserve).forEach((function(t){k[t]=P.preserve[t]})),Object.keys(P.vector).forEach((function(n){k[n]=function(){return t.vector.apply(t,r(P.vector[n].apply(this,arguments)))}}));var w={fromAngle:function(n){return t.vector(Math.cos(n),Math.sin(n))}},z={vector:{P:Array.prototype,A:function(){var t=this;a(arguments).forEach((function(n){return t.push(n)}))},G:{x:function(){return this[0]},y:function(){return this[1]},z:function(){return this[2]}},M:k,S:w}},q=Object.assign({},z),G=function(t,n){var r=Object.create(q[t].proto);return q[t].A.apply(r,n),Object.freeze(r)};return Object.assign(t,{vector:function(){return G("vector",arguments)},circle:function(){return G("circle",arguments)},ellipse:function(){return G("ellipse",arguments)},rect:function(){return G("rect",arguments)},polygon:function(){return G("polygon",arguments)},line:function(){return G("line",arguments)},ray:function(){return G("ray",arguments)},segment:function(){return G("segment",arguments)},matrix:function(){return G("matrix",arguments)}}),Object.keys(q).forEach((function(n){var r={};r.prototype=null!=q[n].P?Object.create(q[n].P):Object.create(Object.prototype),r.prototype.constructor=r,Object.keys(q[n].G).forEach((function(t){return Object.defineProperty(r.prototype,t,{get:q[n].G[t],enumerable:!0})})),Object.keys(q[n].M).forEach((function(t){return Object.defineProperty(r.prototype,t,{value:q[n].M[t]})})),Object.keys(q[n].S).forEach((function(r){return Object.defineProperty(t[n],r,{value:q[n].S[r]})})),t[n].prototype=r.prototype,t[n].prototype.constructor=t[n],Object.freeze(r.prototype),q[n].proto=r.prototype})),t}));
